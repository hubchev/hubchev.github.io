<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>How to Use R for Data Science - 9&nbsp; Collection of exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./50_graph.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./80_exercises.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Collection of exercises</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./fig/cover_transparent.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">How to Use R for Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="./How-to-Use-R-for-Data-Science.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started with R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">LEARN TO CODE</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_recipe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Soft launch</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Kickstart</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_swirl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive introduction with swirl</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pitfalls</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Work with R scripts</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./40_manage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Manage data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./50_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualize data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./80_exercises.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Collection of exercises</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./95_filesys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Navigating the file system</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./952_operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./953_popfunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Popular functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./957_shortcuts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Helpful shortcuts</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-exeimportdata" id="toc-sec-exeimportdata" class="nav-link active" data-scroll-target="#sec-exeimportdata"><span class="header-section-number">9.1</span> Import data with <code>c()</code></a></li>
  <li><a href="#filter-and-select-observations" id="toc-filter-and-select-observations" class="nav-link" data-scroll-target="#filter-and-select-observations"><span class="header-section-number">9.2</span> Filter and select observations</a></li>
  <li><a href="#sec-baseinoperator" id="toc-sec-baseinoperator" class="nav-link" data-scroll-target="#sec-baseinoperator"><span class="header-section-number">9.3</span> Base R,<code>%in%</code> operator, and the pipe <code>|&gt;</code></a></li>
  <li><a href="#sec-exe_genanddrop" id="toc-sec-exe_genanddrop" class="nav-link" data-scroll-target="#sec-exe_genanddrop"><span class="header-section-number">9.4</span> Generate and drop variables</a></li>
  <li><a href="#sec-exe_subset" id="toc-sec-exe_subset" class="nav-link" data-scroll-target="#sec-exe_subset"><span class="header-section-number">9.5</span> Subsetting</a></li>
  <li><a href="#load-the-stata-dataset-auto-using-r" id="toc-load-the-stata-dataset-auto-using-r" class="nav-link" data-scroll-target="#load-the-stata-dataset-auto-using-r"><span class="header-section-number">9.6</span> Load the Stata dataset “auto” using R</a></li>
  <li><a href="#datasaurus" id="toc-datasaurus" class="nav-link" data-scroll-target="#datasaurus"><span class="header-section-number">9.7</span> DatasauRus</a></li>
  <li><a href="#convergence" id="toc-convergence" class="nav-link" data-scroll-target="#convergence"><span class="header-section-number">9.8</span> Convergence</a></li>
  <li><a href="#unemployment-and-gdp-in-germany-and-france" id="toc-unemployment-and-gdp-in-germany-and-france" class="nav-link" data-scroll-target="#unemployment-and-gdp-in-germany-and-france"><span class="header-section-number">9.9</span> Unemployment and GDP in Germany and France</a></li>
  <li><a href="#import-data-and-write-a-report" id="toc-import-data-and-write-a-report" class="nav-link" data-scroll-target="#import-data-and-write-a-report"><span class="header-section-number">9.10</span> Import data and write a report</a></li>
  <li><a href="#explain-the-weight-of-students" id="toc-explain-the-weight-of-students" class="nav-link" data-scroll-target="#explain-the-weight-of-students"><span class="header-section-number">9.11</span> Explain the weight of students</a></li>
  <li><a href="#calories-and-weight" id="toc-calories-and-weight" class="nav-link" data-scroll-target="#calories-and-weight"><span class="header-section-number">9.12</span> Calories and weight</a></li>
  <li><a href="#bundesliga" id="toc-bundesliga" class="nav-link" data-scroll-target="#bundesliga"><span class="header-section-number">9.13</span> Bundesliga</a></li>
  <li><a href="#okuns-law" id="toc-okuns-law" class="nav-link" data-scroll-target="#okuns-law"><span class="header-section-number">9.14</span> Okun’s Law</a></li>
  <li><a href="#sec-exe_duplicates" id="toc-sec-exe_duplicates" class="nav-link" data-scroll-target="#sec-exe_duplicates"><span class="header-section-number">9.15</span> Names and duplicates</a></li>
  <li><a href="#zipfs-law" id="toc-zipfs-law" class="nav-link" data-scroll-target="#zipfs-law"><span class="header-section-number">9.16</span> Zipf’s law</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Collection of exercises</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<!-- ::: {.callout-tip appearance="default" title="Links to the R scripts with the solutions"} -->
<!-- -   [exe_duplicates.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_duplicates.R) -->
<!-- -   [exe_import_covid.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_import_covid.R) -->
<!-- -   [exe_genanddrop.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_genanddrop.R) -->
<!-- -   [exe_base_pipe.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_base_pipe.R) -->
<!-- -   [exe_subset.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_subset.R) -->
<!-- -   [exe_data_transformation.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_data_transformation.R) -->
<!-- -   [exe_poser.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_poser.R) -->
<!-- -   [exe_datasauRus.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_datasauRus.R) -->
<!-- -   [exe_convergence.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_convergence.R) -->
<!-- -   [exe_un_gdp_ger_fra.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_un_gdp_ger_fra.R) -->
<!-- -   [exe_hortacsu_figure_3.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_hortacsu_figure_3.R) -->
<!-- -   [exe_regress_lecture.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_regress_lecture.R) -->
<!-- -   [exe_calories.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_calories.R) -->
<!-- -   [exe_bundesliga.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_bundesliga.R) -->
<!-- -   [exe_okun_solution.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_okun_solution.R) -->
<!-- -   [exe_zipf_solution.R](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_zipf_solution.R) -->
<!-- ::: -->
<!-- ::: {.callout-tip appearance="default" title="The output of all solutions"} -->
<!-- [Here you find the output of the R scripts that contain the solutions](https://hubchev.github.io/ds/solutions/exe_solutions.html) -->
<!-- ::: -->
<section id="sec-exeimportdata" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sec-exeimportdata"><span class="header-section-number">9.1</span> Import data with <code>c()</code></h2>
<p><a href="#tbl-covid" class="quarto-xref">Table&nbsp;<span>9.1</span></a> shows COVID for three states in Germany:</p>
<div id="tbl-covid" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-covid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: Covid cases and deaths till August 2022
</figcaption>
<div aria-describedby="tbl-covid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 34%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>state</th>
<th>Bavaria</th>
<th>North Rhine-Westphalia</th>
<th>Baden-Württemberg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>deaths (in mio)</td>
<td>4,92M</td>
<td>5,32M</td>
<td>3,69M</td>
</tr>
<tr class="even">
<td>cases</td>
<td>24.111</td>
<td>25.466</td>
<td>16.145</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Write down the code you would need to put into the R-console…</p>
<ul>
<li>…to store each of variables <em>state</em> and <em>deaths</em> in a vector.</li>
<li>…to store both vectors in a data frame with the name <code>df_covid</code>.</li>
<li>…to store both vectors in a tibble with the name <code>tbl_covid</code>.</li>
</ul>
<pre><code>Loading required package: pacman</code></pre>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>c</code>, <code>data.frame</code>, <code>tibble</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution to excercise "Import data":</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tibble)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BY"</span>, <span class="st">"NRW"</span>, <span class="st">"BW"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>deaths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.92</span>, <span class="fl">5.32</span>, <span class="fl">3.69</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24111</span>, <span class="dv">25466</span>, <span class="dv">16145</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>df_covid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(state, deaths)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>tbl_covid <span class="ot">&lt;-</span> <span class="fu">tibble</span>(state, deaths)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tibble))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution to excercise "Import data":</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tibble)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BY"</span>, <span class="st">"NRW"</span>, <span class="st">"BW"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>deaths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.92</span>, <span class="fl">5.32</span>, <span class="fl">3.69</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24111</span>, <span class="dv">25466</span>, <span class="dv">16145</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>df_covid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(state, deaths)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>tbl_covid <span class="ot">&lt;-</span> <span class="fu">tibble</span>(state, deaths)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tibble))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="filter-and-select-observations" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="filter-and-select-observations"><span class="header-section-number">9.2</span> Filter and select observations</h2>
<p>Set up R, RStudio, and R packages</p>
<p>Open <a href="https://lr4un3-stephan-huber.shinyapps.io/lr-filter/">this interactive tutorial</a> and work through it.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>The script uses among others the following functions: <code>filter</code>, <code>is.na</code>, <code>select</code>.</p>
</div>
</div>
</div>
</section>
<section id="sec-baseinoperator" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-baseinoperator"><span class="header-section-number">9.3</span> Base R,<code>%in%</code> operator, and the pipe <code>|&gt;</code></h2>
<ol type="a">
<li>Using the <code>mtcars</code> dataset, write code to create a new dataframe that includes only the rows where the number of cylinders is either 4 or 6, and the weight (<code>wt</code>) is less than 3.5.</li>
</ol>
<p>Do this in two different ways using:</p>
<ol type="1">
<li>The <code>%in%</code> operator and the pipe <code>|&gt;</code> .</li>
<li>Base R without the pipe <code>|&gt;</code>.</li>
</ol>
<p>Compare the resulting dataframes using the <code>identical()</code> function.</p>
<ol start="2" type="a">
<li>Using the <code>mtcars</code> dataset, generate a logical variable that indicates with <code>TRUE</code> all cars with either 4 or 6 cylinders that <code>wt</code> is less than 3.5 and add this variable to a new dataset.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>c</code>, <code>filter</code>, <code>identical</code>, <code>if_else</code>, <code>mutate</code>, <code>subset</code>, <code>transform</code>, <code>with</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R or pipe</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_base_pipe.R</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2023-05-08</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/test")</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasets, tidyverse)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the pipe |&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows where cyl is 4 or 6 and wt is less than 3.5</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>df1</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Without the pipe |&gt; </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows where cyl is 4 or 6 and wt is less than 3.5</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(mtcars, cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>df2</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the resulting dataframe is identical to the expected output</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df1, df2)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the pipe |&gt; and tidyverse (mutate)</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_4_or_6 =</span> </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>           <span class="fu">if_else</span>(cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>df3</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># without pipe and with base R (transform)</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> mtcars</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>cyl_4_or_6 <span class="ot">&lt;-</span> <span class="fu">with</span>(mtcars, cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively in one line:</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> <span class="fu">transform</span>(mtcars, <span class="at">cyl_4_or_6 =</span> cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the resulting dataframe is identical to the expected output</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df3, df4)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df3, df5)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasets, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R or pipe</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_base_pipe.R</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2023-05-08</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/test")</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasets, tidyverse)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the pipe |&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows where cyl is 4 or 6 and wt is less than 3.5</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Valiant        18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230       22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280       19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C      17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ferrari Dino   19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without the pipe |&gt; </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows where cyl is 4 or 6 and wt is less than 3.5</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(mtcars, cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Valiant        18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230       22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280       19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C      17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona  21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2  26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ferrari Dino   19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the resulting dataframe is identical to the expected output</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the pipe |&gt; and tidyverse (mutate)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_4_or_6 =</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">if_else</span>(cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
                    cyl_4_or_6
Mazda RX4                 TRUE
Mazda RX4 Wag             TRUE
Datsun 710                TRUE
Hornet 4 Drive            TRUE
Hornet Sportabout        FALSE
Valiant                   TRUE
Duster 360               FALSE
Merc 240D                 TRUE
Merc 230                  TRUE
Merc 280                  TRUE
Merc 280C                 TRUE
Merc 450SE               FALSE
Merc 450SL               FALSE
Merc 450SLC              FALSE
Cadillac Fleetwood       FALSE
Lincoln Continental      FALSE
Chrysler Imperial        FALSE
Fiat 128                  TRUE
Honda Civic               TRUE
Toyota Corolla            TRUE
Toyota Corona             TRUE
Dodge Challenger         FALSE
AMC Javelin              FALSE
Camaro Z28               FALSE
Pontiac Firebird         FALSE
Fiat X1-9                 TRUE
Porsche 914-2             TRUE
Lotus Europa              TRUE
Ford Pantera L           FALSE
Ferrari Dino              TRUE
Maserati Bora            FALSE
Volvo 142E                TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without pipe and with base R (transform)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> mtcars</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>cyl_4_or_6 <span class="ot">&lt;-</span> <span class="fu">with</span>(mtcars, cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively in one line:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> <span class="fu">transform</span>(mtcars, <span class="at">cyl_4_or_6 =</span> cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>) <span class="sc">&amp;</span> wt <span class="sc">&lt;</span> <span class="fl">3.5</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the resulting dataframe is identical to the expected output</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df3, df4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(df3, df5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasets, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-exe_genanddrop" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="sec-exe_genanddrop"><span class="header-section-number">9.4</span> Generate and drop variables</h2>
<p>Use the <em>mtcars</em> dataset. It is part of the package <em>datasets</em> and can be called with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>Create a new tibble called <code>mtcars_new</code> using the pipe operator <code>|&gt;</code>. Generate a new dummy variable called <code>d_cyl_6to8</code> that takes the value 1 if the number of cylinders (cyl) is greater than 6, and 0 otherwise. Do all of this in a single pipe.</p></li>
<li><p>Generate a new dummy variable called <code>posercar</code> that takes a value of 1 if a car has more than 6 cylinders (cyl) and can drive less than 18 miles per gallon (mpg), and 0 otherwise. Add this variable to the tibble <code>mtcars_new</code>.</p></li>
<li><p>Remove the variable <code>d_cyl_6to8</code> from the data frame.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>as_tibble</code>, <code>if_else</code>, <code>mutate</code>, <code>rownames_to_column</code>, <code>select</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and drop variables</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_genanddrop.R</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2023-05-09</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/test")</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasets, tidyverse)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"car"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_cyl_6to8 =</span> <span class="fu">if_else</span>(cyl <span class="sc">&gt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>mtcars_new</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars_new <span class="sc">|&gt;</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posercar =</span> <span class="fu">if_else</span>(cyl <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> mpg <span class="sc">&lt;</span> <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>mtcars_new</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># c)</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars_new <span class="sc">|&gt;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>d_cyl_6to8)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>mtcars_new</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasets, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and drop variables</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_genanddrop.R</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2023-05-09</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/test")</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasets, tidyverse)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># a)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"car"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_cyl_6to8 =</span> <span class="fu">if_else</span>(cyl <span class="sc">&gt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>mtcars_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 13
   car           mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 …  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows
# ℹ 1 more variable: d_cyl_6to8 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars_new <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posercar =</span> <span class="fu">if_else</span>(cyl <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> mpg <span class="sc">&lt;</span> <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mtcars_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 14
   car           mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 …  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows
# ℹ 2 more variables: d_cyl_6to8 &lt;dbl&gt;, posercar &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mtcars_new <span class="ot">&lt;-</span> mtcars_new <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>d_cyl_6to8)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>mtcars_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 13
   car           mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Mazda RX4    21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2 Mazda RX4 …  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3 Datsun 710   22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4 Hornet 4 D…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5 Hornet Spo…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6 Valiant      18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7 Duster 360   14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8 Merc 240D    24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9 Merc 230     22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10 Merc 280     19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows
# ℹ 1 more variable: posercar &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasets, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-exe_subset" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="sec-exe_subset"><span class="header-section-number">9.5</span> Subsetting</h2>
<ol type="1">
<li>Check to see if you have the mtcars dataset by entering the command mtcars.</li>
<li>Save the mtcars dataset in an object named cars.</li>
<li>What class is cars?</li>
<li>How many observations (rows) and variables (columns) are in the mtcars dataset?</li>
<li>Rename mpg in cars to MPG. Use rename().</li>
<li>Convert the column names of cars to all upper case. Use rename_all, and the toupper command.</li>
<li>Convert the rownames of cars to a column called car using rownames_to_column.</li>
<li>Subset the columns from cars that end in “p” and call it pvars using ends_with().</li>
<li>Create a subset cars that only contains the columns: wt, qsec, and hp and assign this object to carsSub. (Use select().)</li>
<li>What are the dimensions of carsSub? (Use dim().)</li>
<li>Convert the column names of carsSub to all upper case. Use rename_all(), and toupper() (or colnames()).</li>
<li>Subset the rows of cars that get more than 20 miles per gallon (mpg) of fuel efficiency. How many are there? (Use filter().)</li>
<li>Subset the rows that get less than 16 miles per gallon (mpg) of fuel efficiency and have more than 100 horsepower (hp). How many are there? (Use filter() and the pipe operator.)</li>
<li>Create a subset of the cars data that only contains the columns: wt, qsec, and hp for cars with 8 cylinders (cyl) and reassign this object to carsSub. What are the dimensions of this dataset? Do not use the pipe operator.</li>
<li>Create a subset of the cars data that only contains the columns: wt, qsec, and hp for cars with 8 cylinders (cyl) and reassign this object to carsSub2. Use the pipe operator.</li>
<li>Re-order the rows of carsSub by weight (wt) in increasing order. (Use arrange().)</li>
<li>Create a new variable in carsSub called wt2, which is equal to wt^2, using mutate() and piping <code>|&gt;</code>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>arrange</code>, <code>class</code>, <code>dim</code>, <code>ends_with</code>, <code>filter</code>, <code>mutate</code>, <code>ncol</code>, <code>nrow</code>, <code>rename</code>, <code>rename_all</code>, <code>rownames_to_column</code>, <code>select</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting with \R</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_subset.R</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2022-06-07</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/22-ss/dsda/work/")</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 0</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, dplyr, tibble)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>mtcars</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(cars)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cars)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(cars)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cars)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rename</span>(cars, <span class="at">MPG =</span> mpg)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rename_all</span>(cars, toupper)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co"># if you like lower cases:</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co"># cars &lt;- rename_all(cars, tolower)</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 7</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">"car"</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 8</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>pvars <span class="ot">&lt;-</span> <span class="fu">select</span>(cars, car, <span class="fu">ends_with</span>(<span class="st">"p"</span>))</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 9</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">select</span>(cars, car, wt, qsec, hp)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 10</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carsSub)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 11</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">rename_all</span>(carsSub, toupper)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 12</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>cars_mpg <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, mpg <span class="sc">&gt;</span> <span class="dv">20</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cars_mpg)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 13</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>cars_whattever <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, mpg <span class="sc">&lt;</span> <span class="dv">16</span> <span class="sc">&amp;</span> hp <span class="sc">&gt;</span> <span class="dv">100</span>)</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="co"># 14</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, cyl <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">select</span>(carsSub, wt, qsec, hp, car)</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carsSub)</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="co"># 15</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative with pipe operator:</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> cars <span class="sc">|&gt;</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wt, qsec, hp, car)</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="co"># 16</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">arrange</span>(carsSub, wt)</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="co"># 17</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> carsSub <span class="sc">|&gt;</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wt2 =</span> wt<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively you can put everything into one pipe:</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>carsSub2 <span class="ot">&lt;-</span> cars <span class="sc">|&gt;</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wt, qsec, hp, car) <span class="sc">|&gt;</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(carsSub, wt) <span class="sc">|&gt;</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wt2 =</span> wt<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, dplyr, tibble))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting with \R</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exe_subset.R</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber; 2022-06-07</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/22-ss/dsda/work/")</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 0</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, dplyr, tibble)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rename</span>(cars, <span class="at">MPG =</span> mpg)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rename_all</span>(cars, toupper)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># if you like lower cases:</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># cars &lt;- rename_all(cars, tolower)</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 7</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(mtcars, <span class="at">var =</span> <span class="st">"car"</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 8</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>pvars <span class="ot">&lt;-</span> <span class="fu">select</span>(cars, car, <span class="fu">ends_with</span>(<span class="st">"p"</span>))</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 9</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">select</span>(cars, car, wt, qsec, hp)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 10</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carsSub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">rename_all</span>(carsSub, toupper)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 12</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>cars_mpg <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, mpg <span class="sc">&gt;</span> <span class="dv">20</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cars_mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 13</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cars_whattever <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, mpg <span class="sc">&lt;</span> <span class="dv">16</span> <span class="sc">&amp;</span> hp <span class="sc">&gt;</span> <span class="dv">100</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 14</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">filter</span>(cars, cyl <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">select</span>(carsSub, wt, qsec, hp, car)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(carsSub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 15</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative with pipe operator:</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> cars <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wt, qsec, hp, car)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 16</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> <span class="fu">arrange</span>(carsSub, wt)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 17</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>carsSub <span class="ot">&lt;-</span> carsSub <span class="sc">|&gt;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wt2 =</span> wt<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively you can put everything into one pipe:</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>carsSub2 <span class="ot">&lt;-</span> cars <span class="sc">|&gt;</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wt, qsec, hp, car) <span class="sc">|&gt;</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(carsSub, wt) <span class="sc">|&gt;</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wt2 =</span> wt<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, dplyr, tibble))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ##  Data transformation -->
<!-- Please download and open the R-script you find [here](https://raw.githubusercontent.com/hubchev/courses/main/scr/exe_data_transformation.R) and try to answer the questions therein. -->
<!-- Solutions to the questions are linked in the script. -->
</section>
<section id="load-the-stata-dataset-auto-using-r" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="load-the-stata-dataset-auto-using-r"><span class="header-section-number">9.6</span> Load the Stata dataset “auto” using R</h2>
<ol type="1">
<li><p>Create a scatter plot illustrating the relationship between the price and weight of a car. Provide a meaningful title for the graph and try to make it clear which car each observation corresponds to.</p></li>
<li><p>Save this graph in the formats of .png and .pdf.</p></li>
<li><p>Create a variable “`lp100km’” that indicates the fuel consumption of an average car in liters per 100 kilometers. (Note: One gallon is approximately equal to 3.8 liters, and one mile is about 1.6 kilometers.)</p></li>
<li><p>Create a dummy variable “`larger6000’” that is equal to 1 if the price of a car is above $6000.</p></li>
<li><p>Now, search for the “most unreasonable poser car” that costs no more than $6000. A “poser” car is defined as one that is expensive, has a large turning radius, consumes a lot of fuel, and is often defective (rep78 is low). For this purpose, create a metric indicator for each corresponding variable that indicates a value of 1 for the car that is the most unreasonable in that variable and 0 for the most reasonable car. All other cars should fall between 0 and 1.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>arrange</code>, <code>desc</code>, <code>dir.create</code>, <code>dir.exists</code>, <code>filter</code>, <code>geom_point</code>, <code>geom_text_repel</code>, <code>ggplot</code>, <code>head</code>, <code>ifelse</code>, <code>max</code>, <code>min</code>, <code>min_max_norm</code>, <code>mutate</code>, <code>na.omit</code>, <code>read_dta</code>, <code>select</code>, <code>tail</code>, <code>theme_minimal</code>, <code>xlab</code>, <code>ylab</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, ggrepel)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/23-ws/R_begin")</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the Stata dataset</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"http://www.stata-press.com/data/r8/auto.dta"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot of price vs. weight</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(auto, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">y =</span> price, <span class="at">label =</span> make)) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Miles per Gallon"</span>) <span class="sc">+</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price in Dollar"</span>) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>scatter_plot</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create "fig" directory if it doesn't already exist</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"fig"</span>)) {</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"fig"</span>)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the scatter plot in different formats</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("fig/scatter_plot.png", plot = scatter_plot, device = "png")</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("fig/scatter_plot.pdf", plot = scatter_plot, device = "pdf")</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'lp100km' variable for fuel consumption</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> auto <span class="sc">|&gt;</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lp100km =</span> (<span class="dv">1</span> <span class="sc">/</span> (mpg <span class="sc">*</span> <span class="fl">1.6</span> <span class="sc">/</span> <span class="fl">3.8</span>)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'larger6000' dummy variable</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">larger6000 =</span> <span class="fu">ifelse</span>(price <span class="sc">&gt;</span> <span class="dv">6000</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize variables</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Do it slowly</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sprice =</span> (price <span class="sc">-</span> <span class="fu">min</span>(auto<span class="sc">$</span>price)) <span class="sc">/</span> (<span class="fu">max</span>(auto<span class="sc">$</span>price) <span class="sc">-</span> <span class="fu">min</span>(auto<span class="sc">$</span>price)))</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(larger6000 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Do it with a self-written function</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>min_max_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">smpg =</span> <span class="fu">min_max_norm</span>(mpg)) <span class="sc">|&gt;</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sturn =</span> <span class="fu">min_max_norm</span>(turn)) <span class="sc">|&gt;</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slp100km =</span> <span class="fu">min_max_norm</span>(lp100km)) <span class="sc">|&gt;</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sprice =</span> <span class="fu">min_max_norm</span>(price)) <span class="sc">|&gt;</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">srep78 =</span> <span class="fu">min_max_norm</span>(rep78))</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="do">## With a loop:</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co"># vars_to_normalize &lt;- c("mpg", "turn", "lp100km", "price", "rep78")</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through the selected variables and apply min_max_norm</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="co"># for (var in c("mpg", "turn", "lp100km", "price", "rep78")) {</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   auto &lt;- auto |&gt;</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(!!paste0("s", var) := min_max_norm(!!sym(var))) |&gt;</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(make, starts_with("s"))</span></span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a><span class="do">## mpg and rep78 need to be changed because a SMALL value is poser-like</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">smpg =</span> <span class="dv">1</span> <span class="sc">-</span> smpg) <span class="sc">|&gt;</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">srep78 =</span> <span class="dv">1</span> <span class="sc">-</span> srep78)</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="do">## create the poser (composite) indicator</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poser =</span> (sturn <span class="sc">+</span> smpg <span class="sc">+</span> sprice <span class="sc">+</span> srep78) <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="do">## filter results</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(poser)) <span class="sc">|&gt;</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(make, poser) <span class="sc">|&gt;</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>df_poser <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(larger6000 <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(poser)) <span class="sc">|&gt;</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(make, poser) <span class="sc">|&gt;</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Five top poser cars</span></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_poser, <span class="dv">15</span>)</span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Five top non-poser cars</span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df_poser, <span class="dv">5</span>)</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven, ggrepel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, ggrepel)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/23-ws/R_begin")</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the Stata dataset</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"http://www.stata-press.com/data/r8/auto.dta"</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot of price vs. weight</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(auto, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">y =</span> price, <span class="at">label =</span> make)) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Miles per Gallon"</span>) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price in Dollar"</span>) <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>scatter_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 43 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="80_exercises_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create "fig" directory if it doesn't already exist</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"fig"</span>)) {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"fig"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the scatter plot in different formats</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("fig/scatter_plot.png", plot = scatter_plot, device = "png")</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("fig/scatter_plot.pdf", plot = scatter_plot, device = "pdf")</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'lp100km' variable for fuel consumption</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> auto <span class="sc">|&gt;</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lp100km =</span> (<span class="dv">1</span> <span class="sc">/</span> (mpg <span class="sc">*</span> <span class="fl">1.6</span> <span class="sc">/</span> <span class="fl">3.8</span>)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 'larger6000' dummy variable</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">larger6000 =</span> <span class="fu">ifelse</span>(price <span class="sc">&gt;</span> <span class="dv">6000</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize variables</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Do it slowly</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sprice =</span> (price <span class="sc">-</span> <span class="fu">min</span>(auto<span class="sc">$</span>price)) <span class="sc">/</span> (<span class="fu">max</span>(auto<span class="sc">$</span>price) <span class="sc">-</span> <span class="fu">min</span>(auto<span class="sc">$</span>price)))</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(larger6000 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Do it with a self-written function</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>min_max_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> (<span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">smpg =</span> <span class="fu">min_max_norm</span>(mpg)) <span class="sc">|&gt;</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sturn =</span> <span class="fu">min_max_norm</span>(turn)) <span class="sc">|&gt;</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slp100km =</span> <span class="fu">min_max_norm</span>(lp100km)) <span class="sc">|&gt;</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sprice =</span> <span class="fu">min_max_norm</span>(price)) <span class="sc">|&gt;</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">srep78 =</span> <span class="fu">min_max_norm</span>(rep78))</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="do">## With a loop:</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="co"># vars_to_normalize &lt;- c("mpg", "turn", "lp100km", "price", "rep78")</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through the selected variables and apply min_max_norm</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a><span class="co"># for (var in c("mpg", "turn", "lp100km", "price", "rep78")) {</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   auto &lt;- auto |&gt;</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(!!paste0("s", var) := min_max_norm(!!sym(var))) |&gt;</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     select(make, starts_with("s"))</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a><span class="do">## mpg and rep78 need to be changed because a SMALL value is poser-like</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">smpg =</span> <span class="dv">1</span> <span class="sc">-</span> smpg) <span class="sc">|&gt;</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">srep78 =</span> <span class="dv">1</span> <span class="sc">-</span> srep78)</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="do">## create the poser (composite) indicator</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>n_auto <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">poser =</span> (sturn <span class="sc">+</span> smpg <span class="sc">+</span> sprice <span class="sc">+</span> srep78) <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a><span class="do">## filter results</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>n_auto <span class="sc">|&gt;</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(poser)) <span class="sc">|&gt;</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(make, poser) <span class="sc">|&gt;</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  make             poser
  &lt;chr&gt;            &lt;dbl&gt;
1 Dodge Magnum     0.888
2 Pont. Firebird   0.782
3 Merc. Cougar     0.763
4 Buick LeSabre    0.754
5 Pont. Grand Prix 0.720</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_poser <span class="ot">&lt;-</span> n_auto <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(larger6000 <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(poser)) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(make, poser) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Five top poser cars</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_poser, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   make              poser
   &lt;chr&gt;             &lt;dbl&gt;
 1 Dodge Magnum      0.888
 2 Pont. Firebird    0.782
 3 Merc. Cougar      0.763
 4 Buick LeSabre     0.754
 5 Pont. Grand Prix  0.720
 6 Chev. Impala      0.702
 7 Dodge Diplomat    0.690
 8 Chev. Monte Carlo 0.684
 9 Pont. Catalina    0.678
10 Olds Cutl Supr    0.671
11 Plym. Volare      0.665
12 Buick Regal       0.663
13 Olds Cutlass      0.629
14 Olds Starfire     0.626
15 AMC Pacer         0.619</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Five top non-poser cars</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df_poser, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  make           poser
  &lt;chr&gt;          &lt;dbl&gt;
1 VW Diesel      0.261
2 Dodge Colt     0.227
3 Toyota Corolla 0.195
4 Datsun 210     0.195
5 Subaru         0.178</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven, ggrepel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="datasaurus" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="datasaurus"><span class="header-section-number">9.7</span> DatasauRus</h2>
<div id="fig-label" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: The logo of the DatasauRus package
</figcaption>
<div aria-describedby="fig-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><a href="fig/datasaurus.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="fig/datasaurus.png" class="img-fluid figure-img" style="width:25.0%"></a></p>
<p>Source: <a href="https://github.com/jumpingrivers/datasauRus">https://github.com/jumpingrivers/datasauRus</a> _</p>
</div>
</figure>
</div>
<ol type="a">
<li><p>Load the packages <code>datasauRus</code> and <code>tidyverse</code>. If necessary, install these packages.</p></li>
<li><p>The package<code>datasauRus</code> comes with a dataset in two different formats: <code>datasaurus_dozen</code> and <code>datasaurus_dozen_wide</code>. Store them as <code>ds</code> and <code>ds_wide</code>.</p></li>
<li><p>Open and read the R vignette of the <code>datasauRus</code> package. Also open the R documentation of the dataset <code>datasaurus_dozen</code>.</p></li>
<li><p>Explore the dataset: What are the dimensions of this dataset? Look at the descriptive statistics.</p></li>
<li><p>How many unique values does the variable <code>dataset</code> of the tibble <code>ds</code> have? Hint: The function unique() return the unique values of a variable and the function length() returns the length of a vector, such as the unique elements.</p></li>
<li><p>Compute the mean values of the <code>x</code> and <code>y</code> variables for each entry in <code>dataset</code>. Hint: Use the group_by() function to group the data by the appropriate column and then the summarise() function to calculate the mean.</p></li>
<li><p>Compute the standard deviation, the correlation, and the median in the same way. Round the numbers.</p></li>
<li><p>What can you conclude?</p></li>
<li><p>Plot all datasets of <code>ds</code>. Hide the legend. Hint: Use the <code>facet_wrap()</code> and the <code>theme()</code> function.</p></li>
<li><p>Create a loop that generates separate scatter plots for each unique datatset of the tibble <code>ds</code>. Export each graph as a png file.</p></li>
<li><p>Watch the video <a href="https://youtu.be/T-kxUB29t0o">Animating the Datasaurus Dozen Dataset in R</a> from The Data Digest on YouTube.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>cor</code>, <code>dim</code>, <code>dir.create</code>, <code>dir.exists</code>, <code>facet_wrap</code>, <code>filter</code>, <code>geom_point</code>, <code>ggplot</code>, <code>ggsave</code>, <code>glimpse</code>, <code>group_by</code>, <code>head</code>, <code>labs</code>, <code>length</code>, <code>mean</code>, <code>median</code>, <code>paste</code>, <code>paste0</code>, <code>round</code>, <code>sd</code>, <code>select</code>, <code>summarise</code>, <code>summary</code>, <code>theme</code>, <code>theme_bw</code>, <code>unique</code>, <code>view</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/23-ws/ds_mim/")</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages datasauRus and tidyverse. If necessary, install these packages.</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasauRus, tidyverse)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The packagedatasauRus comes with a dataset in two different formats:</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   datasaurus_dozen and datasaurus_dozen_wide. Store them as ds and ds_wide.</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> datasaurus_dozen</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>ds_wide <span class="ot">&lt;-</span> datasaurus_dozen_wide</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Open and read the R vignette of the datasauRus package.</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   Also open the R documentation of the dataset datasaurus_dozen.</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>??datasaurus</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the dataset: What are the dimensions of this dataset? Look at the descriptive statistics.</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>ds</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ds)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ds)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ds)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(ds)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ds)</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="co"># How many unique values does the variable dataset of the tibble ds have?</span></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   Hint: The function unique() return the unique values of a variable and the</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   function length() returns the length of a vector, such as the unique elements.</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ds<span class="sc">$</span>dataset)</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ds<span class="sc">$</span>dataset) <span class="sc">|&gt;</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>()</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean values of the x and y variables for each entry in dataset.</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   Hint: Use the group_by() function to group the data by the appropriate column and</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   then the summarise() function to calculate the mean.</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">|&gt;</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">|&gt;</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_x =</span> <span class="fu">mean</span>(x),</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_y =</span> <span class="fu">mean</span>(y)</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the standard deviation, the correlation, and the median in the same way. Round the numbers.</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">|&gt;</span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">|&gt;</span></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_x =</span> <span class="fu">round</span>(<span class="fu">mean</span>(x), <span class="dv">2</span>),</span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_y =</span> <span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>),</span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_x =</span> <span class="fu">round</span>(<span class="fu">sd</span>(x), <span class="dv">2</span>),</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_y =</span> <span class="fu">round</span>(<span class="fu">sd</span>(y), <span class="dv">2</span>),</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">med_x =</span> <span class="fu">round</span>(<span class="fu">median</span>(x), <span class="dv">2</span>),</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">med_y =</span> <span class="fu">round</span>(<span class="fu">median</span>(y), <span class="dv">2</span>),</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">cor =</span> <span class="fu">round</span>(<span class="fu">cor</span>(x, y), <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a><span class="co"># What can you conclude?</span></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   --&gt; The standard deviation, the mean, and the correlation are basically the</span></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a><span class="co">#   same for all datasets. The median is different.</span></span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all datasets of ds. Hide the legend. Hint: Use the facet_wrap() and the theme() function.</span></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dataset, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a loop that generates separate scatter plots for each unique datatset of the tibble ds.</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   Export each graph as a png file.</span></span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming uni_ds is a vector of unique values for the 'dataset' variable</span></span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>uni_ds <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>dataset)</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the 'pic' folder if it doesn't exist</span></span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"fig"</span>)) {</span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"fig"</span>)</span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (uni_v <span class="cf">in</span> uni_ds) {</span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select data for the current value</span></span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>  subset_ds <span class="ot">&lt;-</span> ds <span class="sc">|&gt;</span></span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataset <span class="sc">==</span> uni_v) <span class="sc">|&gt;</span></span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(x, y)</span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make plot</span></span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_ds, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Dataset:"</span>, uni_v),</span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"X"</span>,</span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Y"</span></span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the plot as a PNG file</span></span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"fig/"</span>, <span class="st">"plot_ds_"</span>, uni_v, <span class="st">".png"</span>)</span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(filename, <span class="at">plot =</span> graph)</span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasauRus, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/23-ws/ds_mim/")</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages datasauRus and tidyverse. If necessary, install these packages.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(datasauRus, tidyverse)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The packagedatasauRus comes with a dataset in two different formats:</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   datasaurus_dozen and datasaurus_dozen_wide. Store them as ds and ds_wide.</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> datasaurus_dozen</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>ds_wide <span class="ot">&lt;-</span> datasaurus_dozen_wide</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Open and read the R vignette of the datasauRus package.</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   Also open the R documentation of the dataset datasaurus_dozen.</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>??datasaurus</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the dataset: What are the dimensions of this dataset? Look at the descriptive statistics.</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,846 × 3
   dataset     x     y
   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 dino     55.4  97.2
 2 dino     51.5  96.0
 3 dino     46.2  94.5
 4 dino     42.8  91.4
 5 dino     40.8  88.3
 6 dino     38.7  84.9
 7 dino     35.6  79.9
 8 dino     33.1  77.6
 9 dino     29.0  74.5
10 dino     26.2  71.4
# ℹ 1,836 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1846    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  dataset     x     y
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 dino     55.4  97.2
2 dino     51.5  96.0
3 dino     46.2  94.5
4 dino     42.8  91.4
5 dino     40.8  88.3
6 dino     38.7  84.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,846
Columns: 3
$ dataset &lt;chr&gt; "dino", "dino", "dino", "dino", "dino", "dino", "dino", "dino"…
$ x       &lt;dbl&gt; 55.3846, 51.5385, 46.1538, 42.8205, 40.7692, 38.7179, 35.6410,…
$ y       &lt;dbl&gt; 97.1795, 96.0256, 94.4872, 91.4103, 88.3333, 84.8718, 79.8718,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(ds)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dataset                x               y           
 Length:1846        Min.   :15.56   Min.   : 0.01512  
 Class :character   1st Qu.:41.07   1st Qu.:22.56107  
 Mode  :character   Median :52.59   Median :47.59445  
                    Mean   :54.27   Mean   :47.83510  
                    3rd Qu.:67.28   3rd Qu.:71.81078  
                    Max.   :98.29   Max.   :99.69468  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many unique values does the variable dataset of the tibble ds have?</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   Hint: The function unique() return the unique values of a variable and the</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   function length() returns the length of a vector, such as the unique elements.</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ds<span class="sc">$</span>dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "dino"       "away"       "h_lines"    "v_lines"    "x_shape"   
 [6] "star"       "high_lines" "dots"       "circle"     "bullseye"  
[11] "slant_up"   "slant_down" "wide_lines"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(ds<span class="sc">$</span>dataset) <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean values of the x and y variables for each entry in dataset.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   Hint: Use the group_by() function to group the data by the appropriate column and</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   then the summarise() function to calculate the mean.</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">|&gt;</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">|&gt;</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_x =</span> <span class="fu">mean</span>(x),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_y =</span> <span class="fu">mean</span>(y)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   dataset    mean_x mean_y
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
 1 away         54.3   47.8
 2 bullseye     54.3   47.8
 3 circle       54.3   47.8
 4 dino         54.3   47.8
 5 dots         54.3   47.8
 6 h_lines      54.3   47.8
 7 high_lines   54.3   47.8
 8 slant_down   54.3   47.8
 9 slant_up     54.3   47.8
10 star         54.3   47.8
11 v_lines      54.3   47.8
12 wide_lines   54.3   47.8
13 x_shape      54.3   47.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the standard deviation, the correlation, and the median in the same way. Round the numbers.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>ds <span class="sc">|&gt;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_x =</span> <span class="fu">round</span>(<span class="fu">mean</span>(x), <span class="dv">2</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_y =</span> <span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_x =</span> <span class="fu">round</span>(<span class="fu">sd</span>(x), <span class="dv">2</span>),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_y =</span> <span class="fu">round</span>(<span class="fu">sd</span>(y), <span class="dv">2</span>),</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">med_x =</span> <span class="fu">round</span>(<span class="fu">median</span>(x), <span class="dv">2</span>),</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">med_y =</span> <span class="fu">round</span>(<span class="fu">median</span>(y), <span class="dv">2</span>),</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cor =</span> <span class="fu">round</span>(<span class="fu">cor</span>(x, y), <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 8
   dataset    mean_x mean_y  sd_x  sd_y med_x med_y     cor
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 away         54.3   47.8  16.8  26.9  53.3  47.5 -0.0641
 2 bullseye     54.3   47.8  16.8  26.9  53.8  47.4 -0.0686
 3 circle       54.3   47.8  16.8  26.9  54.0  51.0 -0.0683
 4 dino         54.3   47.8  16.8  26.9  53.3  46.0 -0.0645
 5 dots         54.3   47.8  16.8  26.9  51.0  51.3 -0.0603
 6 h_lines      54.3   47.8  16.8  26.9  53.1  50.5 -0.0617
 7 high_lines   54.3   47.8  16.8  26.9  54.2  32.5 -0.0685
 8 slant_down   54.3   47.8  16.8  26.9  53.1  46.4 -0.069 
 9 slant_up     54.3   47.8  16.8  26.9  54.3  45.3 -0.0686
10 star         54.3   47.8  16.8  26.9  56.5  50.1 -0.063 
11 v_lines      54.3   47.8  16.8  26.9  50.4  47.1 -0.0694
12 wide_lines   54.3   47.8  16.8  26.9  64.6  46.3 -0.0666
13 x_shape      54.3   47.8  16.8  26.9  47.1  39.9 -0.0656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What can you conclude?</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   --&gt; The standard deviation, the mean, and the correlation are basically the</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   same for all datasets. The median is different.</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all datasets of ds. Hide the legend. Hint: Use the facet_wrap() and the theme() function.</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dataset, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="80_exercises_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a loop that generates separate scatter plots for each unique datatset of the tibble ds.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   Export each graph as a png file.</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming uni_ds is a vector of unique values for the 'dataset' variable</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>uni_ds <span class="ot">&lt;-</span> <span class="fu">unique</span>(ds<span class="sc">$</span>dataset)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the 'pic' folder if it doesn't exist</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"fig"</span>)) {</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"fig"</span>)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (uni_v <span class="cf">in</span> uni_ds) {</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select data for the current value</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  subset_ds <span class="ot">&lt;-</span> ds <span class="sc">|&gt;</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataset <span class="sc">==</span> uni_v) <span class="sc">|&gt;</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(x, y)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make plot</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_ds, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Dataset:"</span>, uni_v),</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"X"</span>,</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Y"</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save the plot as a PNG file</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  filename <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"fig/"</span>, <span class="st">"plot_ds_"</span>, uni_v, <span class="st">".png"</span>)</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(filename, <span class="at">plot =</span> graph)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image
Saving 7 x 5 in image</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(datasauRus, tidyverse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Please find the solutions [here](https://htmlpreview.github.io/?https://raw.githubusercontent.com/hubchev/hubchev.github.io/main/various/datasaurus_solution.html). -->
</section>
<section id="convergence" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="convergence"><span class="header-section-number">9.8</span> Convergence</h2>
<p>The dataset convergence.dta, see https://github.com/hubchev/courses/blob/main/dta/convergence.dta, contains the per capita GDP of 1960 (gdppc60) and the average growth rate of GDP per capita between 1960 and 1995 (growth) for different countries (country), as well as 3 dummy variables indicating the belonging of a country to the region Asia (asia), Western Europe (weurope) or Africa (africa).</p>
<ul>
<li>Some countries are not assigned to a certain country group. Name the countries which are assign to be part of Western Europe, Africa or Asia. If you find countries that are members of the EU, assign them a ‘1’ in the variable weurope.</li>
<li>Create a table that shows the average GDP per capita for all available points in time. Group by Western European, Asian, African, and the remaining countries.</li>
<li>Create the growth rate of GDP per capita from 1960 to 1995 and call it gdpgrowth. (Note: The log value X minus the log value X of the previous period is approximately equal to the growth rate).</li>
<li>Calculate the unconditional convergence of all countries by constructing a graph in which a scatterplot shows the GDP per capita growth rate between 1960 and 1995 (gdpgrowth) on the y-axis and the 1960 GDP per capita (gdppc60) on the x-axis. Add to the same graph the estimated linear relationship. You do not need to label the graph further, just two things: title the graph <code>world</code> and label the individual observations with the country names.</li>
<li>Create three graphs describing the same relationship for the sample of Western European, African and Asian countries. Title the graph accordingly with <code>weurope</code>, <code>africa</code> and <code>asia</code>.</li>
<li>Combine the four graphs into one image. Discuss how an upward or downward sloping regression line can be interpreted.</li>
<li>Estimate the relationships illustrated in the 4 graphs using the least squares method. Present the 4 estimation results in a table, indicating the significance level with stars. In addition, the Akaike information criterion, and the number of observations should be displayed in the table. Interpret the four estimation results regarding their significance.</li>
<li>Put the data set into the so-called long format and calculate the GDP per capita growth rates for the available time points in the countries.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>as.numeric</code>, <code>c</code>, <code>cor</code>, <code>describe</code>, <code>diff</code>, <code>filter</code>, <code>gather</code>, <code>geom_point</code>, <code>geom_text</code>, <code>ggarrange</code>, <code>ggplot</code>, <code>ggtitle</code>, <code>group_by</code>, <code>head</code>, <code>ifelse</code>, <code>lag</code>, <code>list</code>, <code>lm</code>, <code>log</code>, <code>mean</code>, <code>mutate</code>, <code>names</code>, <code>read_dta</code>, <code>select</code>, <code>set_label</code>, <code>starts_with</code>, <code>stat_smooth</code>, <code>stat.desc</code>, <code>str</code>, <code>subset</code>, <code>substr</code>, <code>summarise</code>, <code>summarise_all</code>, <code>summarise_at</code>, <code>summary</code>, <code>tab_model</code>, <code>tail</code>, <code>tbl_summary</code>, <code>vars</code>, <code>view</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convergence</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/github/courses/")</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear the environment</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  haven, tidyverse, vtable, gtsummary, pastecs, Hmisc,</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  sjlabelled, tis, ggpubr, sjPlot, psych</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/convergence.dta"</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(vtable)</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a><span class="co"># vtable(data, missing=TRUE)</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pastecs)</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a><span class="fu">stat.desc</span>(data)</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Hmisc)</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data)</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gtsummary)</span></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_summary</span>(data)</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a><span class="co"># check the assignments of countries to continents</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">x_1 =</span> africa <span class="sc">+</span> asia <span class="sc">+</span> weurope)</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x_1 <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(africa, asia, weurope, country) <span class="sc">|&gt;</span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a><span class="co"># correct the assignment manually</span></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Austria"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Greece"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Cyprus"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(data, data<span class="sc">$</span>weurope <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># check changes</span></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a><span class="co"># In the following, I do the same with a loop</span></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a><span class="co"># c_europe &lt;- c("Austria","Greece","Cyprus")</span></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(data$weurope)                       # check changes</span></span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in c_europe){</span></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(i)</span></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   data$weurope[data$country == i] &lt;- 1</span></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(data$weurope)                       # check changes</span></span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a><span class="co"># data$weurope[data$country == "Austria"] # check changes</span></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a><span class="co"># create a category for the remaining countries</span></span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a><span class="co"># use ifelse -- ifelse(condition, result if TRUE, result if FALSE)</span></span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>rest <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>africa <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> data<span class="sc">$</span>asia <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> data<span class="sc">$</span>weurope <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>rest <span class="ot">&lt;-</span> <span class="fu">set_label</span>(data<span class="sc">$</span>rest, <span class="at">label =</span> <span class="st">"=1 if not in Africa, W.Europe, or Asia"</span>)</span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a><span class="co"># create table with means across country groups</span></span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a>table_gdp <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(gdppc60<span class="sc">:</span>gdppc95), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-79"><a href="#cb78-79" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb78-80"><a href="#cb78-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb78-81"><a href="#cb78-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gdppc60<span class="sc">:</span>gdppc95) <span class="sc">|&gt;</span></span>
<span id="cb78-82"><a href="#cb78-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb78-83"><a href="#cb78-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-84"><a href="#cb78-84" aria-hidden="true" tabindex="-1"></a><span class="co"># create growth rate</span></span>
<span id="cb78-85"><a href="#cb78-85" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>gr1 <span class="ot">&lt;-</span> (data<span class="sc">$</span>gdppc95 <span class="sc">-</span> data<span class="sc">$</span>gdppc60) <span class="sc">/</span> data<span class="sc">$</span>gdppc60</span>
<span id="cb78-86"><a href="#cb78-86" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>gr2 <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>gdppc95) <span class="sc">-</span> <span class="fu">log</span>(data<span class="sc">$</span>gdppc60)</span>
<span id="cb78-87"><a href="#cb78-87" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>gr1, data<span class="sc">$</span>gr2)</span>
<span id="cb78-88"><a href="#cb78-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-89"><a href="#cb78-89" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb78-90"><a href="#cb78-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-91"><a href="#cb78-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>)</span>
<span id="cb78-92"><a href="#cb78-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-93"><a href="#cb78-93" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb78-94"><a href="#cb78-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-95"><a href="#cb78-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-96"><a href="#cb78-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb78-97"><a href="#cb78-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"World"</span>)</span>
<span id="cb78-98"><a href="#cb78-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-99"><a href="#cb78-99" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb78-100"><a href="#cb78-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weurope <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-101"><a href="#cb78-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb78-102"><a href="#cb78-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-103"><a href="#cb78-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-104"><a href="#cb78-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb78-105"><a href="#cb78-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Western Europe"</span>)</span>
<span id="cb78-106"><a href="#cb78-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-107"><a href="#cb78-107" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb78-108"><a href="#cb78-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(asia <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-109"><a href="#cb78-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb78-110"><a href="#cb78-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-111"><a href="#cb78-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-112"><a href="#cb78-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb78-113"><a href="#cb78-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Asia"</span>)</span>
<span id="cb78-114"><a href="#cb78-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-115"><a href="#cb78-115" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb78-116"><a href="#cb78-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(africa <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-117"><a href="#cb78-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb78-118"><a href="#cb78-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-119"><a href="#cb78-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-120"><a href="#cb78-120" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  geom_text( hjust=0, vjust=0) +</span></span>
<span id="cb78-121"><a href="#cb78-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Africa"</span>)</span>
<span id="cb78-122"><a href="#cb78-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-123"><a href="#cb78-123" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, p3, p4,</span>
<span id="cb78-124"><a href="#cb78-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>),</span>
<span id="cb78-125"><a href="#cb78-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb78-126"><a href="#cb78-126" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-127"><a href="#cb78-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-128"><a href="#cb78-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression analysis</span></span>
<span id="cb78-129"><a href="#cb78-129" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> data)</span>
<span id="cb78-130"><a href="#cb78-130" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, weurope <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb78-131"><a href="#cb78-131" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, asia <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb78-132"><a href="#cb78-132" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, africa <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb78-133"><a href="#cb78-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-134"><a href="#cb78-134" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4,</span>
<span id="cb78-135"><a href="#cb78-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb78-136"><a href="#cb78-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb78-137"><a href="#cb78-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb78-138"><a href="#cb78-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb78-139"><a href="#cb78-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-140"><a href="#cb78-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"World"</span>, <span class="st">"W.Europe"</span>, <span class="st">"Asia"</span>, <span class="st">"Africa"</span>)</span>
<span id="cb78-141"><a href="#cb78-141" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-142"><a href="#cb78-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-143"><a href="#cb78-143" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape data (see: https://stackoverflow.com/questions/2185252/reshaping-data-frame-from-wide-to-long-format)</span></span>
<span id="cb78-144"><a href="#cb78-144" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(data, condition, measurement, gdppc60<span class="sc">:</span>gdppc95, <span class="at">factor_key =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-145"><a href="#cb78-145" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(data_long<span class="sc">$</span>condition, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb78-146"><a href="#cb78-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-147"><a href="#cb78-147" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>gr_long <span class="ot">&lt;-</span> data_long <span class="sc">|&gt;</span></span>
<span id="cb78-148"><a href="#cb78-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, measurement) <span class="sc">|&gt;</span></span>
<span id="cb78-149"><a href="#cb78-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb78-150"><a href="#cb78-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gr =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(measurement)) <span class="sc">/</span> <span class="fu">lag</span>(measurement, <span class="dv">1</span>))</span>
<span id="cb78-151"><a href="#cb78-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-152"><a href="#cb78-152" aria-hidden="true" tabindex="-1"></a><span class="co"># erase all helping variables</span></span>
<span id="cb78-153"><a href="#cb78-153" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">select</span>(data, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"h_"</span>))</span>
<span id="cb78-154"><a href="#cb78-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-155"><a href="#cb78-155" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and remove variables in a dataframe</span></span>
<span id="cb78-156"><a href="#cb78-156" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">Land =</span> country)</span>
<span id="cb78-157"><a href="#cb78-157" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">select</span>(data, <span class="sc">-</span>country)</span>
<span id="cb78-158"><a href="#cb78-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-159"><a href="#cb78-159" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb78-160"><a href="#cb78-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb78-161"><a href="#cb78-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">y65 =</span> <span class="fu">mean</span>(gdppc65, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-162"><a href="#cb78-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">y70 =</span> <span class="fu">mean</span>(gdppc70, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-163"><a href="#cb78-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">y75 =</span> <span class="fu">mean</span>(gdppc75, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-164"><a href="#cb78-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">y80 =</span> <span class="fu">mean</span>(gdppc80, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-165"><a href="#cb78-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">y85 =</span> <span class="fu">mean</span>(gdppc85, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-166"><a href="#cb78-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">y90 =</span> <span class="fu">mean</span>(gdppc90, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-167"><a href="#cb78-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">y95 =</span> <span class="fu">mean</span>(gdppc95, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-168"><a href="#cb78-168" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-169"><a href="#cb78-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-170"><a href="#cb78-170" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(</span>
<span id="cb78-171"><a href="#cb78-171" aria-hidden="true" tabindex="-1"></a>  haven, tidyverse, vtable, gtsummary, pastecs, Hmisc,</span>
<span id="cb78-172"><a href="#cb78-172" aria-hidden="true" tabindex="-1"></a>  sjlabelled, tis, ggpubr, sjPlot</span>
<span id="cb78-173"><a href="#cb78-173" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convergence</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/github/courses/")</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear the environment</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  haven, tidyverse, vtable, gtsummary, pastecs, Hmisc,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  sjlabelled, tis, ggpubr, sjPlot, psych</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/convergence.dta"</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "country" "gdppc60" "gdppc65" "gdppc70" "gdppc75" "gdppc80" "gdppc85"
 [8] "gdppc90" "gdppc95" "africa"  "asia"    "weurope" "growth" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [107 × 13] (S3: tbl_df/tbl/data.frame)
 $ country: chr [1:107] "Algeria" "Angola" "Argentina" "Australia" ...
  ..- attr(*, "format.stata")= chr "%24s"
 $ gdppc60: num [1:107] 2848 2642 7879 11436 7842 ...
  ..- attr(*, "label")= chr "real gdp per capita 1960"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc65: num [1:107] 3536 3072 8802 13192 9387 ...
  ..- attr(*, "label")= chr "real gdp per capita 1965"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc70: num [1:107] 3670 3558 9903 15842 11946 ...
  ..- attr(*, "label")= chr "real gdp per capita 1970"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc75: num [1:107] 3917 2230 10609 16716 14198 ...
  ..- attr(*, "label")= chr "real gdp per capita 1975"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc80: num [1:107] 5094 2059 11359 18300 16869 ...
  ..- attr(*, "label")= chr "real gdp per capita 1980"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc85: num [1:107] 5876 1988 9246 19669 17919 ...
  ..- attr(*, "label")= chr "real gdp per capita 1985"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc90: num [1:107] 5307 2081 7716 21446 21178 ...
  ..- attr(*, "label")= chr "real gdp per capita 1990"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ gdppc95: num [1:107] 4935 1339 10973 23827 22474 ...
  ..- attr(*, "label")= chr "real gdp per capita 1995"
  ..- attr(*, "format.stata")= chr "%9.0g"
 $ africa : num [1:107] 1 1 0 0 0 0 0 0 1 0 ...
  ..- attr(*, "label")= chr "=1 if in Africa"
  ..- attr(*, "format.stata")= chr "%8.0g"
 $ asia   : num [1:107] 0 0 0 0 0 1 0 0 0 0 ...
  ..- attr(*, "label")= chr "=1 if in Asia"
  ..- attr(*, "format.stata")= chr "%8.0g"
 $ weurope: num [1:107] 0 0 0 0 0 0 0 1 0 0 ...
  ..- attr(*, "label")= chr "=1 if in Western Europe"
  ..- attr(*, "format.stata")= chr "%8.0g"
 $ growth : num [1:107] 0.55 -0.68 0.331 0.734 1.053 ...
  ..- attr(*, "format.stata")= chr "%9.0g"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 107 × 13
   country    gdppc60 gdppc65 gdppc70 gdppc75 gdppc80 gdppc85 gdppc90 gdppc95
   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 Algeria      2848.   3536.   3670.   3917.   5094.   5876.   5307.   4935.
 2 Angola       2642.   3072.   3558.   2230.   2059.   1988.   2081.   1339.
 3 Argentina    7879.   8802.   9903.  10609.  11359.   9246.   7716.  10973.
 4 Australia   11436.  13192.  15842.  16716.  18300.  19669.  21446.  23827.
 5 Austria      7842.   9387.  11946.  14198.  16869.  17919.  21178.  22474.
 6 Bangladesh   1130.   1164.   1181.   1030.   1040.   1245.   1366.   1568.
 7 Barbados     3632.   4632.   6456.   8827.  10911.  11090.  14411.  14636.
 8 Belgium      8314.  10454.  12980.  15024.  17451.  18109.  21246.  22356.
 9 Benin        1140.   1188.   1170.   1048.   1069.   1252.   1069.   1139.
10 Bolivia      2516.   2880.   2670.   3124.   3264.   2718.   2615.   2795.
# ℹ 97 more rows
# ℹ 4 more variables: africa &lt;dbl&gt;, asia &lt;dbl&gt;, weurope &lt;dbl&gt;, growth &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country gdppc60 gdppc65 gdppc70 gdppc75 gdppc80 gdppc85 gdppc90 gdppc95 africa
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Algeria   2848.   3536.   3670.   3917.   5094.   5876.   5307.   4935.      1
2 Angola    2642.   3072.   3558.   2230.   2059.   1988.   2081.   1339.      1
3 Argent…   7879.   8802.   9903.  10609.  11359.   9246.   7716.  10973.      0
4 Austra…  11436.  13192.  15842.  16716.  18300.  19669.  21446.  23827.      0
5 Austria   7842.   9387.  11946.  14198.  16869.  17919.  21178.  22474.      0
6 Bangla…   1130.   1164.   1181.   1030.   1040.   1245.   1366.   1568.      0
# ℹ 3 more variables: asia &lt;dbl&gt;, weurope &lt;dbl&gt;, growth &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country gdppc60 gdppc65 gdppc70 gdppc75 gdppc80 gdppc85 gdppc90 gdppc95 africa
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 United…  10341.  11633.  12917.  14072.  15302.  16878.  19585.  20963.      0
2 United…  13118.  15697.  17478.  19284.  22806.  25251.  28281.  30366.      0
3 Uruguay   6279.   5936.   6553.   6949.   8580.   6625.   7763.   9399.      0
4 Venezu…   8381.  10618.  11253.   8815.   8516.   7274.   7431.   7582.      0
5 Zambia    1290.   1564.   1427.   1446.   1324.   1167.   1091.    870.      1
6 Zimbab…   1317.   1539.   2303.   2694.   2816.   2923.   3115.   2832.      1
# ℹ 3 more variables: asia &lt;dbl&gt;, weurope &lt;dbl&gt;, growth &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country             gdppc60           gdppc65           gdppc70       
 Length:107         Min.   :  407.8   Min.   :  513.6   Min.   :  354.5  
 Class :character   1st Qu.: 1153.2   1st Qu.: 1364.5   1st Qu.: 1488.0  
 Mode  :character   Median : 2484.7   Median : 2884.4   Median : 3072.2  
                    Mean   : 3634.3   Mean   : 4367.5   Mean   : 5128.4  
                    3rd Qu.: 4354.0   3rd Qu.: 5873.3   3rd Qu.: 6994.6  
                    Max.   :16010.3   Max.   :18928.9   Max.   :22030.9  
    gdppc75           gdppc80           gdppc85           gdppc90       
 Min.   :  617.9   Min.   :  473.6   Min.   :  542.3   Min.   :  527.7  
 1st Qu.: 1480.7   1st Qu.: 1708.6   1st Qu.: 1598.8   1st Qu.: 1829.0  
 Median : 3741.7   Median : 4306.2   Median : 4200.7   Median : 4034.0  
 Mean   : 5759.1   Mean   : 6553.6   Mean   : 6900.3   Mean   : 7775.1  
 3rd Qu.: 8355.8   3rd Qu.: 9968.6   3rd Qu.:10037.2   3rd Qu.:11716.2  
 Max.   :21808.9   Max.   :23860.1   Max.   :25251.4   Max.   :28744.1  
    gdppc95            africa            asia           weurope      
 Min.   :  499.3   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.: 1673.7   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median : 4467.9   Median :0.0000   Median :0.0000   Median :0.0000  
 Mean   : 8468.2   Mean   :0.3738   Mean   :0.1308   Mean   :0.1402  
 3rd Qu.:13627.8   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.0000  
 Max.   :36741.1   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
     growth       
 Min.   :-0.6888  
 1st Qu.: 0.2458  
 Median : 0.6587  
 Mean   : 0.6345  
 3rd Qu.: 1.0505  
 Max.   : 2.3493  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(vtable)</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vtable(data, missing=TRUE)</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(pastecs)</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stat.desc</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         country      gdppc60      gdppc65      gdppc70      gdppc75
nbr.val       NA 1.070000e+02 1.070000e+02 1.070000e+02 1.070000e+02
nbr.null      NA 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
nbr.na        NA 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
min           NA 4.078180e+02 5.135667e+02 3.545075e+02 6.178639e+02
max           NA 1.601025e+04 1.892888e+04 2.203095e+04 2.180892e+04
range         NA 1.560243e+04 1.841531e+04 2.167644e+04 2.119105e+04
sum           NA 3.888715e+05 4.673224e+05 5.487424e+05 6.162241e+05
median        NA 2.484720e+03 2.884388e+03 3.072176e+03 3.741725e+03
mean          NA 3.634313e+03 4.367500e+03 5.128433e+03 5.759103e+03
SE.mean       NA 3.314566e+02 4.021934e+02 4.736475e+02 5.272377e+02
CI.mean       NA 6.571449e+02 7.973875e+02 9.390523e+02 1.045300e+03
var           NA 1.175539e+07 1.730827e+07 2.400459e+07 2.974381e+07
std.dev       NA 3.428613e+03 4.160321e+03 4.899448e+03 5.453789e+03
coef.var      NA 9.434006e-01 9.525635e-01 9.553499e-01 9.469857e-01
              gdppc80      gdppc85      gdppc90      gdppc95       africa
nbr.val  1.070000e+02 1.070000e+02 1.070000e+02 1.070000e+02 107.00000000
nbr.null 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  67.00000000
nbr.na   0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00   0.00000000
min      4.735793e+02 5.422725e+02 5.277151e+02 4.993415e+02   0.00000000
max      2.386009e+04 2.525136e+04 2.874414e+04 3.674105e+04   1.00000000
range    2.338651e+04 2.470909e+04 2.821642e+04 3.624171e+04   1.00000000
sum      7.012400e+05 7.383373e+05 8.319308e+05 9.061030e+05  40.00000000
median   4.306217e+03 4.200733e+03 4.034010e+03 4.467940e+03   0.00000000
mean     6.553645e+03 6.900349e+03 7.775054e+03 8.468253e+03   0.37383178
SE.mean  6.018749e+02 6.552251e+02 7.711596e+02 8.456513e+02   0.04699273
CI.mean  1.193276e+03 1.299048e+03 1.528899e+03 1.676586e+03   0.09316766
var      3.876112e+07 4.593724e+07 6.363152e+07 7.651850e+07   0.23628990
std.dev  6.225843e+03 6.777701e+03 7.976937e+03 8.747486e+03   0.48609659
coef.var 9.499817e-01 9.822259e-01 1.025965e+00 1.032974e+00   1.30030838
                 asia      weurope      growth
nbr.val  107.00000000 107.00000000 107.0000000
nbr.null  93.00000000  92.00000000   0.0000000
nbr.na     0.00000000   0.00000000   0.0000000
min        0.00000000   0.00000000  -0.6887722
max        1.00000000   1.00000000   2.3493433
range      1.00000000   1.00000000   3.0381155
sum       14.00000000  15.00000000  67.8899760
median     0.00000000   0.00000000   0.6586871
mean       0.13084112   0.14018692   0.6344858
SE.mean    0.03275433   0.03372119   0.0601857
CI.mean    0.06493865   0.06685553   0.1193240
var        0.11479457   0.12167166   0.3875881
std.dev    0.33881347   0.34881465   0.6225657
coef.var   2.58950297   2.48821120   0.9812131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Hmisc)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         vars   n    mean      sd  median trimmed     mad    min      max
country*    1 107   54.00   31.03   54.00   54.00   40.03   1.00   107.00
gdppc60     2 107 3634.31 3428.61 2484.72 3032.19 2027.76 407.82 16010.25
gdppc65     3 107 4367.50 4160.32 2884.39 3673.42 2579.50 513.57 18928.88
gdppc70     4 107 5128.43 4899.45 3072.18 4370.29 2854.11 354.51 22030.95
gdppc75     5 107 5759.10 5453.79 3741.72 4977.54 3708.25 617.86 21808.92
gdppc80     6 107 6553.64 6225.84 4306.22 5707.40 4476.29 473.58 23860.09
gdppc85     7 107 6900.35 6777.70 4200.73 5929.46 4382.44 542.27 25251.36
gdppc90     8 107 7775.05 7976.94 4034.01 6660.00 4258.37 527.72 28744.14
gdppc95     9 107 8468.25 8747.49 4467.94 7235.12 4935.09 499.34 36741.05
africa     10 107    0.37    0.49    0.00    0.34    0.00   0.00     1.00
asia       11 107    0.13    0.34    0.00    0.05    0.00   0.00     1.00
weurope    12 107    0.14    0.35    0.00    0.06    0.00   0.00     1.00
growth     13 107    0.63    0.62    0.66    0.63    0.59  -0.69     2.35
            range skew kurtosis     se
country*   106.00 0.00    -1.23   3.00
gdppc60  15602.43 1.53     1.55 331.46
gdppc65  18415.31 1.41     1.16 402.19
gdppc70  21676.44 1.29     0.74 473.65
gdppc75  21191.05 1.15     0.09 527.24
gdppc80  23386.51 1.07    -0.11 601.87
gdppc85  24709.09 1.14     0.01 655.23
gdppc90  28216.42 1.13    -0.10 771.16
gdppc95  36241.71 1.14     0.12 845.65
africa       1.00 0.51    -1.75   0.05
asia         1.00 2.16     2.69   0.03
weurope      1.00 2.04     2.20   0.03
growth       3.04 0.15     0.07   0.06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(gtsummary)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="swtahpxulc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#swtahpxulc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#swtahpxulc thead, #swtahpxulc tbody, #swtahpxulc tfoot, #swtahpxulc tr, #swtahpxulc td, #swtahpxulc th {
  border-style: none;
}

#swtahpxulc p {
  margin: 0;
  padding: 0;
}

#swtahpxulc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#swtahpxulc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#swtahpxulc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#swtahpxulc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#swtahpxulc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swtahpxulc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swtahpxulc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swtahpxulc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#swtahpxulc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#swtahpxulc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#swtahpxulc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#swtahpxulc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#swtahpxulc .gt_spanner_row {
  border-bottom-style: hidden;
}

#swtahpxulc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#swtahpxulc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#swtahpxulc .gt_from_md > :first-child {
  margin-top: 0;
}

#swtahpxulc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#swtahpxulc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#swtahpxulc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#swtahpxulc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#swtahpxulc .gt_row_group_first td {
  border-top-width: 2px;
}

#swtahpxulc .gt_row_group_first th {
  border-top-width: 2px;
}

#swtahpxulc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swtahpxulc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#swtahpxulc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#swtahpxulc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swtahpxulc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swtahpxulc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#swtahpxulc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#swtahpxulc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#swtahpxulc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swtahpxulc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swtahpxulc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swtahpxulc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swtahpxulc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#swtahpxulc .gt_left {
  text-align: left;
}

#swtahpxulc .gt_center {
  text-align: center;
}

#swtahpxulc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#swtahpxulc .gt_font_normal {
  font-weight: normal;
}

#swtahpxulc .gt_font_bold {
  font-weight: bold;
}

#swtahpxulc .gt_font_italic {
  font-style: italic;
}

#swtahpxulc .gt_super {
  font-size: 65%;
}

#swtahpxulc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#swtahpxulc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#swtahpxulc .gt_indent_1 {
  text-indent: 5px;
}

#swtahpxulc .gt_indent_2 {
  text-indent: 10px;
}

#swtahpxulc .gt_indent_3 {
  text-indent: 15px;
}

#swtahpxulc .gt_indent_4 {
  text-indent: 20px;
}

#swtahpxulc .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="<strong>Characteristic</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="<strong>N = 107</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 107</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">country</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Algeria</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Angola</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Argentina</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Australia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Austria</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Bangladesh</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Barbados</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Belgium</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Benin</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Bolivia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Botswana</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Brazil</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Burkina Faso</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Burundi</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Cameroon</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Canada</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Cape Verde</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Central African Republic</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chad</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chile</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;China</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Colombia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Comoros</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Congo, Republic of</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Costa Rica</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Cote d'lvoire</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Cyprus</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Denmark</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Dominican Republic</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Ecuador</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Egypt</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;El Salvador</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Ethiopia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Fiji</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Finland</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;France</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gabon</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gambia, The</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Ghana</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Greece</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Guatemala</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Guinea</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Guinea-Bissau</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Guyana</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Honduras</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hong Kong</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Iceland</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;India</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Indonesia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Iran</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Ireland</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Israel</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Italy</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Jamaica</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Japan</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Jordan</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Kenya</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Lesotho</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Luxembourg</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Madagascar</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Malawi</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Malaysia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mali</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mauritania</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mauritius</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mexico</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Morocco</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mozambique</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Namibia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Nepal</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Netherlands</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;New Zealand</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Nicaragua</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Niger</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Nigeria</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Norway</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Pakistan</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Panama</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Papua New Guinea</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Paraguay</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Peru</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Philippines</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Portugal</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Romania</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Rwanda</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Senegal</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Seychelles</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Singapore</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;South Africa</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;South Korea</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Spain</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Sri Lanka</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Sweden</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Switzerland</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Syria</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Tanzania</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Thailand</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Togo</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Trinidad &amp; Tobago</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Turkey</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Uganda</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;United Kingdom</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;United States of America</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Uruguay</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Venezuela</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Zambia</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Zimbabwe</td>
<td class="gt_row gt_center" headers="stat_0">1 (0.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">real gdp per capita 1960</td>
<td class="gt_row gt_center" headers="stat_0">2,485 (1,153, 4,354)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">real gdp per capita 1965</td>
<td class="gt_row gt_center" headers="stat_0">2,884 (1,365, 5,873)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">real gdp per capita 1970</td>
<td class="gt_row gt_center" headers="stat_0">3,072 (1,488, 6,995)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">real gdp per capita 1975</td>
<td class="gt_row gt_center" headers="stat_0">3,742 (1,481, 8,356)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">real gdp per capita 1980</td>
<td class="gt_row gt_center" headers="stat_0">4,306 (1,709, 9,969)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">real gdp per capita 1985</td>
<td class="gt_row gt_center" headers="stat_0">4,201 (1,599, 10,037)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">real gdp per capita 1990</td>
<td class="gt_row gt_center" headers="stat_0">4,034 (1,829, 11,716)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">real gdp per capita 1995</td>
<td class="gt_row gt_center" headers="stat_0">4,468 (1,674, 13,628)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">=1 if in Africa</td>
<td class="gt_row gt_center" headers="stat_0">40 (37%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">=1 if in Asia</td>
<td class="gt_row gt_center" headers="stat_0">14 (13%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">=1 if in Western Europe</td>
<td class="gt_row gt_center" headers="stat_0">15 (14%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">growth</td>
<td class="gt_row gt_center" headers="stat_0">0.66 (0.25, 1.05)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%); Median (IQR)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the assignments of countries to continents</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">x_1 =</span> africa <span class="sc">+</span> asia <span class="sc">+</span> weurope)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x_1 <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(africa, asia, weurope, country) <span class="sc">|&gt;</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co"># correct the assignment manually</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Austria"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Greece"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>weurope[data<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Cyprus"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(data, data<span class="sc">$</span>weurope <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># check changes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 14
   country       gdppc60 gdppc65 gdppc70 gdppc75 gdppc80 gdppc85 gdppc90 gdppc95
   &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 Austria         7842.   9387.  11946.  14198.  16869.  17919.  21178.  22474.
 2 Belgium         8314.  10454.  12980.  15024.  17451.  18109.  21246.  22356.
 3 Cyprus          3178.   4261.   5638.   4827.   8302.  10228.  13798.  17169.
 4 Denmark        11745.  14749.  17143.  17750.  19558.  21596.  23308.  25293.
 5 Finland         8007.   9851.  12198.  14884.  16621.  18585.  21667.  20084.
 6 France          8364.  10497.  13186.  14951.  17335.  18429.  21403.  21502.
 7 Greece          4454.   6549.   9022.  11121.  12672.  12287.  12794.  13332.
 8 Iceland         8786.  11403.  11678.  15235.  19440.  20414.  22502.  21901.
 9 Ireland         5490.   6413.   7760.   9064.  10649.  11641.  15133.  18456.
10 Italy           7364.   9097.  12072.  13386.  16286.  17518.  20638.  21691.
11 Luxembourg     12510.  14019.  16163.  17384.  19089.  21414.  28744.  36741.
12 Netherlands     9883.  11702.  14237.  15803.  17339.  17974.  20823.  22320.
13 Norway          8808.  10478.  11959.  14873.  17977.  20630.  21855.  25538.
14 Portugal        3665.   4866.   6730.   7951.   9667.   9847.  13155.  13924.
15 Spain           4956.   7459.   9701.  11970.  12294.  12583.  15475.  17434.
16 Sweden         10870.  13552.  15850.  17588.  18348.  20001.  22219.  22122.
17 Switzerland    16010.  18929.  22031.  21809.  23860.  24844.  27931.  26227.
18 United Kingd…  10341.  11633.  12917.  14072.  15302.  16878.  19585.  20963.
# ℹ 5 more variables: africa &lt;dbl&gt;, asia &lt;dbl&gt;, weurope &lt;dbl&gt;, growth &lt;dbl&gt;,
#   x_1 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In the following, I do the same with a loop</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># c_europe &lt;- c("Austria","Greece","Cyprus")</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(data$weurope)                       # check changes</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in c_europe){</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(i)</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   data$weurope[data$country == i] &lt;- 1</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(data$weurope)                       # check changes</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># data$weurope[data$country == "Austria"] # check changes</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create a category for the remaining countries</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co"># use ifelse -- ifelse(condition, result if TRUE, result if FALSE)</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>rest <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>africa <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> data<span class="sc">$</span>asia <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> data<span class="sc">$</span>weurope <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>rest <span class="ot">&lt;-</span> <span class="fu">set_label</span>(data<span class="sc">$</span>rest, <span class="at">label =</span> <span class="st">"=1 if not in Africa, W.Europe, or Asia"</span>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create table with means across country groups</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>table_gdp <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(gdppc60<span class="sc">:</span>gdppc95), <span class="fu">list</span>(<span class="at">name =</span> mean))</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(africa, asia, weurope) <span class="sc">|&gt;</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gdppc60<span class="sc">:</span>gdppc95) <span class="sc">|&gt;</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `africa`, `asia`, `weurope`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 11
# Groups:   africa, asia [3]
  africa  asia weurope gdppc60 gdppc65 gdppc70 gdppc75 gdppc80 gdppc85 gdppc90
   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1      0     0       0   4288.   5034.   5727.   6411.   7042.   7185.   7457.
2      0     0       1   8366.  10294.  12401.  13994.  16059.  17272.  20192.
3      0     1       0   1739.   2247.   3090.   3760.   4905.   5761.   7501.
4      1     0       0   1596.   1860.   2046.   2182.   2426.   2382.   2562.
# ℹ 1 more variable: gdppc95 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create growth rate</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>gr1 <span class="ot">&lt;-</span> (data<span class="sc">$</span>gdppc95 <span class="sc">-</span> data<span class="sc">$</span>gdppc60) <span class="sc">/</span> data<span class="sc">$</span>gdppc60</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>gr2 <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>gdppc95) <span class="sc">-</span> <span class="fu">log</span>(data<span class="sc">$</span>gdppc60)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>gr1, data<span class="sc">$</span>gr2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9008887</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="80_exercises_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"World"</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weurope <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Western Europe"</span>)</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(asia <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(hjust=0, vjust=0) +</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Asia"</span>)</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(africa <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdppc60, <span class="at">y =</span> growth, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  geom_text( hjust=0, vjust=0) +</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Africa"</span>)</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, p3, p4,</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>),</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: label.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: label.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: label.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?
The following aesthetics were dropped during statistical transformation: label.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-27-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="80_exercises_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression analysis</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> data)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, weurope <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, asia <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> gdppc60, <span class="at">data =</span> <span class="fu">subset</span>(data, africa <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.aic =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"World"</span>, <span class="st">"W.Europe"</span>, <span class="st">"Asia"</span>, <span class="st">"Africa"</span>)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">World</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">W.Europe</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Asia</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Africa</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.54 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.59 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.91 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.20 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">real gdp per capita 1960</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.00 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00 <sup></sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">107</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">18</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">14</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">40</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.021 / 0.012</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.727 / 0.710</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.158 / 0.088</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.002 / -0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">AIC</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">204.917</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">-14.237</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">31.220</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">76.318</td>
</tr>
<tr class="even">
<td colspan="5" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.2&nbsp;&nbsp;&nbsp;** p&lt;0.1&nbsp;&nbsp;&nbsp;*** p&lt;0.05</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape data (see: https://stackoverflow.com/questions/2185252/reshaping-data-frame-from-wide-to-long-format)</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(data, condition, measurement, gdppc60<span class="sc">:</span>gdppc95, <span class="at">factor_key =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(data_long<span class="sc">$</span>condition, <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>gr_long <span class="ot">&lt;-</span> data_long <span class="sc">|&gt;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, measurement) <span class="sc">|&gt;</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gr =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(measurement)) <span class="sc">/</span> <span class="fu">lag</span>(measurement, <span class="dv">1</span>))</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># erase all helping variables</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">select</span>(data, <span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"h_"</span>))</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and remove variables in a dataframe</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">Land =</span> country)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">select</span>(data, <span class="sc">-</span>country)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y65 =</span> <span class="fu">mean</span>(gdppc65, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y70 =</span> <span class="fu">mean</span>(gdppc70, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y75 =</span> <span class="fu">mean</span>(gdppc75, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y80 =</span> <span class="fu">mean</span>(gdppc80, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y85 =</span> <span class="fu">mean</span>(gdppc85, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y90 =</span> <span class="fu">mean</span>(gdppc90, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y95 =</span> <span class="fu">mean</span>(gdppc95, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
    y65   y70   y75   y80   y85   y90   y95
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 4367. 5128. 5759. 6554. 6900. 7775. 8468.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  haven, tidyverse, vtable, gtsummary, pastecs, Hmisc,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  sjlabelled, tis, ggpubr, sjPlot</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="unemployment-and-gdp-in-germany-and-france" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="unemployment-and-gdp-in-germany-and-france"><span class="header-section-number">9.9</span> Unemployment and GDP in Germany and France</h2>
<p>The following exercise was a former exam.</p>
<p>Please answer all (!) questions in an R script. Normal text should be written as comments, using the ‘#’ to comment out text. Make sure the script runs without errors before submitting it. Each task (starting with 1) is worth five points. You have a total of 120 minutes of editing time. Please do not forget to number your answers.</p>
<p>When you are done with your work, save the R script, export the script to pdf format and upload the pdf file.</p>
<p>Suppose you aim to empirically examine unemployment and GDP for Germany and France. The data set that we use in the following is ‘forest.Rdata’.</p>
<ol start="0" type="1">
<li><p>Write down your name, matriculation number, and date.</p></li>
<li><p>Set your working directory.</p></li>
</ol>
<ol start="2" type="1">
<li>Clear your global environment.</li>
</ol>
<ol start="3" type="1">
<li>Install and load the following packages: ‘tidyverse’, ‘sjPlot’, and ‘ggpubr’</li>
</ol>
<ol start="4" type="1">
<li>Download and load the data, respectively, with the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If that is not working, you can also download the data from ILIAS, save it in your working directory and load it from there with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load("forest.Rdata")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li><p>Show the <strong>first eight</strong> observations of the dataset <code>df</code>.</p></li>
<li><p>Show the <strong>last observation</strong> of the dataset <code>df</code>.</p></li>
<li><p>Which type of data do we have here (Panel, cross-section,time series, …)? Name the variable(s) that are necessary to identify the observations in the dataset.</p></li>
<li><p>Explain what the <strong>assignment operator</strong> in R is and what it is good for.</p></li>
<li><p>Write down the R code to store the number of observations and the number of variables that are in the dataset <code>df</code>. Name the object in which you store these numbers ‘observations_df’.</p></li>
<li><p>In the dataset <code>df</code>, rename the variable ‘country.x’ to ‘nation’ and the variable ‘date’ to ‘year’.</p></li>
<li><p>Explain what the <strong>pipe operator</strong> in R is and what it is good for.</p></li>
<li><p>For the upcoming analysis you are only interested the following <strong>variables</strong> that are part of the dataframe <code>df</code>: nation, year, gdp, pop, gdppc, and unemployment. Drop all other variables from the dataframe <code>df</code>.</p></li>
<li><p>Create a variable that indicates the GDP per capita (‘gdp’ divided by ‘pop’). Name the variable ‘gdp_pc’. (Hint: If you fail here, use the variable ‘gdppc’ which is already in the dataset as a replacement for ‘gdp_pc’ in the following tasks.)</p></li>
<li><p>For the upcoming analysis you are only interested the following <strong>countries</strong> that are part of the dataframe <code>df</code>: Germany and France. Drop all other countries from the dataframe <code>df</code>.</p></li>
<li><p>Create a table showing the <strong>average</strong> unemployment rate and GDP per capita for Germany and France in the given years. Use the pipe operator. (Hint: See below for how your results should look like.)</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  9.75        34356.
2 Germany                 7.22        36739.</code></pre>
</div>
</div>
<ol start="16" type="1">
<li>Create a table showing the unemployment rate and GDP per capita for Germany and France in the <strong>year 2020</strong>. Use the pipe operator. (Hint: See below for how your results should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  8.01        35786.
2 Germany                 3.81        41315.</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Create a table showing the <strong>highest</strong> unemployment rate and the <strong>highest</strong> GDP per capita for Germany and France during the given period. Use the pipe operator. (Hint: See below for how your results should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `max(unemployment)` `max(gdppc)`
  &lt;chr&gt;                 &lt;dbl&gt;        &lt;dbl&gt;
1 France                 12.6       38912.
2 Germany                11.2       43329.</code></pre>
</div>
</div>
<ol start="18" type="1">
<li>Calculate the standard deviation of the unemployment rate and GDP per capita for Germany and France in the given years. (Hint: See below for how your result should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `sd(gdppc)` `sd(unemployment)`
  &lt;chr&gt;         &lt;dbl&gt;              &lt;dbl&gt;
1 France        2940.               1.58
2 Germany       4015.               2.37</code></pre>
</div>
</div>
<ol start="19" type="1">
<li>In statistics, the coefficient of variation (COV) is a standardized measure of dispersion. It is defined as the ratio of the standard deviation (<span class="math inline">\(\sigma\)</span>) to the mean (<span class="math inline">\(\mu\)</span>): <span class="math inline">\(COV={\frac {\sigma }{\mu }}\)</span>. Write down the R code to calculate the coefficient of variation (COV) for the <strong>unemployment rate</strong> in Germany and France. (Hint: See below for what your result should should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(unemployment)` `mean(unemployment)`   cov
  &lt;chr&gt;                &lt;dbl&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 France                1.58                 9.75 0.162
2 Germany               2.37                 7.22 0.328</code></pre>
</div>
</div>
<ol start="20" type="1">
<li>Write down the R code to calculate the coefficient of variation (COV) for the <strong>GDP per capita</strong> in Germany and France. (Hint: See below for what your result should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(gdppc)` `mean(gdppc)`    cov
  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 France        2940.        34356. 0.0856
2 Germany       4015.        36739. 0.109 </code></pre>
</div>
</div>
<ol start="21" type="1">
<li>Create a chart (bar chart, line chart, or scatter plot) that shows the unemployment rate of <strong>Germany</strong> over the available years. Label the chart ‘Germany’ with ‘ggtitle(“Germany”)’. Please note that you may choose any type of graphical representation. (Hint: Below you can see one of many <code>|&gt;</code> of what your result may look like).</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="80_exercises_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="22" type="1">
<li>and 23. <em>(This task is worth 10 points)</em> The following chart shows the simultaneous development of the unemployment rate and GDP per capita over time for <strong>France</strong>.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-48-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="80_exercises_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Suppose you want to visualize the simultaneous evolution of the unemployment rate and GDP per capita over time for Germany as well.<br>
Suppose further that you have found the following lines of code that create the kind of chart you are looking for.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-49-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="80_exercises_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Use these lines of code and customize them to create the co-movement visualization for <strong>Germany</strong> using the available <code>df</code> data. The result should look something like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-50-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="80_exercises_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="24" type="1">
<li>Interpret the two graphs above, which show the simultaneous evolution of the unemployment rate and GDP per capita over time for Germany and France. What are your expectations regarding the correlation between the unemployment rate and GDP per capita variables? Can you see this expectation in the figures? Discuss.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>c</code>, <code>dim</code>, <code>filter</code>, <code>geom_line</code>, <code>ggplot</code>, <code>ggtitle</code>, <code>group_by</code>, <code>head</code>, <code>load</code>, <code>max</code>, <code>mean</code>, <code>mutate</code>, <code>plot</code>, <code>rename</code>, <code>sd</code>, <code>select</code>, <code>summarise</code>, <code>tail</code>, <code>text</code>, <code>title</code>, <code>url</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/exams/22-11/scr/")</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, ggpubr, sjPlot)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">8</span>)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df, <span class="dv">1</span>)</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co"># panel data set</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co"># date and country.x</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">nation =</span> country.x)</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">year =</span> date)</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nation, year, gdp, pop, gdppc, unemployment)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc =</span> gdp <span class="sc">/</span> pop)</span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">|</span> nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">max</span>(unemployment), <span class="fu">max</span>(gdppc))</span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">sd</span>(unemployment))</span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(unemployment), <span class="fu">mean</span>(unemployment), <span class="at">cov =</span> <span class="fu">sd</span>(unemployment) <span class="sc">/</span> <span class="fu">mean</span>(unemployment))</span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-52"><a href="#cb121-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb121-53"><a href="#cb121-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">mean</span>(gdppc), <span class="at">cov =</span> <span class="fu">sd</span>(gdppc) <span class="sc">/</span> <span class="fu">mean</span>(gdppc))</span>
<span id="cb121-54"><a href="#cb121-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-55"><a href="#cb121-55" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb121-56"><a href="#cb121-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>) <span class="sc">|&gt;</span></span>
<span id="cb121-57"><a href="#cb121-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment)) <span class="sc">+</span></span>
<span id="cb121-58"><a href="#cb121-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb121-59"><a href="#cb121-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Germany"</span>)</span>
<span id="cb121-60"><a href="#cb121-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-61"><a href="#cb121-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-62"><a href="#cb121-62" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb121-63"><a href="#cb121-63" aria-hidden="true" tabindex="-1"></a>dfra <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb121-64"><a href="#cb121-64" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfra<span class="sc">$</span>gdppc, dfra<span class="sc">$</span>unemployment,</span>
<span id="cb121-65"><a href="#cb121-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb121-66"><a href="#cb121-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"GDP per capita"</span>, <span class="at">ylab =</span> <span class="st">"Unemployment rate"</span></span>
<span id="cb121-67"><a href="#cb121-67" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-68"><a href="#cb121-68" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfra<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.1</span>, dfra<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb121-69"><a href="#cb121-69" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"France"</span>)</span>
<span id="cb121-70"><a href="#cb121-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-71"><a href="#cb121-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb121-72"><a href="#cb121-72" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb121-73"><a href="#cb121-73" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb121-74"><a href="#cb121-74" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb121-75"><a href="#cb121-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-76"><a href="#cb121-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb121-77"><a href="#cb121-77" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb121-78"><a href="#cb121-78" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb121-79"><a href="#cb121-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-80"><a href="#cb121-80" aria-hidden="true" tabindex="-1"></a>dfger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb121-81"><a href="#cb121-81" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb121-82"><a href="#cb121-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfger<span class="sc">$</span>gdppc, dfger<span class="sc">$</span>unemployment,</span>
<span id="cb121-83"><a href="#cb121-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb121-84"><a href="#cb121-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span></span>
<span id="cb121-85"><a href="#cb121-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-86"><a href="#cb121-86" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfger<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.7</span>, dfger<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.4</span>, labels)</span>
<span id="cb121-87"><a href="#cb121-87" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Germany"</span>)</span>
<span id="cb121-88"><a href="#cb121-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-89"><a href="#cb121-89" aria-hidden="true" tabindex="-1"></a><span class="co"># rmarkdown::render("22-11_dsda_exam.Rmd", "all")</span></span>
<span id="cb121-90"><a href="#cb121-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-91"><a href="#cb121-91" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::purl(input = "22-11_dsda_exam.Rmd", output = "22-11_dsda_solution.R",documentation = 0)</span></span>
<span id="cb121-92"><a href="#cb121-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-93"><a href="#cb121-93" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, ggpubr, sjPlot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/exams/22-11/scr/")</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, ggpubr, sjPlot)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 11
# Groups:   country.x [1]
  country.x     date     gdp gdp_growth unemployment region income forest    pop
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 United Arab…  1992 1.26e11     -2.48          1.84 Middl… High …   3.63 2.05e6
2 United Arab…  1993 1.27e11     -4.34          1.85 Middl… High …   3.72 2.17e6
3 United Arab…  1994 1.36e11      1.25          1.81 Middl… High …   3.81 2.29e6
4 United Arab…  1995 1.45e11      1.35          1.80 Middl… High …   3.90 2.42e6
5 United Arab…  1996 1.54e11      0.631         1.90 Middl… High …   3.99 2.54e6
6 United Arab…  1997 1.66e11      2.83          1.98 Middl… High …   4.08 2.67e6
7 United Arab…  1998 1.67e11     -4.77          2.14 Middl… High …   4.18 2.81e6
8 United Arab…  1999 1.72e11     -2.40          2.22 Middl… High …   4.27 2.97e6
# ℹ 2 more variables: unemployment_dif &lt;dbl&gt;, gdppc &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
# Groups:   country.x [1]
  country.x  date        gdp gdp_growth unemployment region income forest    pop
  &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Zimbabwe   2020    1.94e10      -7.62         5.35 Sub-S… Lower…   45.1 1.49e7
# ℹ 2 more variables: unemployment_dif &lt;dbl&gt;, gdppc &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># panel data set</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># date and country.x</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">nation =</span> country.x)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">year =</span> date)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nation, year, gdp, pop, gdppc, unemployment)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc =</span> gdp <span class="sc">/</span> pop)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">|</span> nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  9.75        34356.
2 Germany                 7.22        36739.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  8.01        35786.
2 Germany                 3.81        41315.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">max</span>(unemployment), <span class="fu">max</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `max(unemployment)` `max(gdppc)`
  &lt;chr&gt;                 &lt;dbl&gt;        &lt;dbl&gt;
1 France                 12.6       38912.
2 Germany                11.2       43329.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">sd</span>(unemployment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `sd(gdppc)` `sd(unemployment)`
  &lt;chr&gt;         &lt;dbl&gt;              &lt;dbl&gt;
1 France        2940.               1.58
2 Germany       4015.               2.37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(unemployment), <span class="fu">mean</span>(unemployment), <span class="at">cov =</span> <span class="fu">sd</span>(unemployment) <span class="sc">/</span> <span class="fu">mean</span>(unemployment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(unemployment)` `mean(unemployment)`   cov
  &lt;chr&gt;                &lt;dbl&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 France                1.58                 9.75 0.162
2 Germany               2.37                 7.22 0.328</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">mean</span>(gdppc), <span class="at">cov =</span> <span class="fu">sd</span>(gdppc) <span class="sc">/</span> <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(gdppc)` `mean(gdppc)`    cov
  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 France        2940.        34356. 0.0856
2 Germany       4015.        36739. 0.109 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>) <span class="sc">|&gt;</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Germany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-52-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="80_exercises_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>dfra <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfra<span class="sc">$</span>gdppc, dfra<span class="sc">$</span>unemployment,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"GDP per capita"</span>, <span class="at">ylab =</span> <span class="st">"Unemployment rate"</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfra<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.1</span>, dfra<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"France"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-52-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="80_exercises_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-52-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="80_exercises_files/figure-html/unnamed-chunk-52-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>dfger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfger<span class="sc">$</span>gdppc, dfger<span class="sc">$</span>unemployment,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfger<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.7</span>, dfger<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.4</span>, labels)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Germany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-52-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="80_exercises_files/figure-html/unnamed-chunk-52-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rmarkdown::render("22-11_dsda_exam.Rmd", "all")</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::purl(input = "22-11_dsda_exam.Rmd", output = "22-11_dsda_solution.R",documentation = 0)</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, ggpubr, sjPlot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="import-data-and-write-a-report" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="import-data-and-write-a-report"><span class="header-section-number">9.10</span> Import data and write a report</h2>
<p>Reproduce Figure 3 of <span class="citation" data-cites="Hortacsu2015Ongoing">Hortaçsu &amp; Syverson (<a href="references.html#ref-Hortacsu2015Ongoing" role="doc-biblioref">2015, p. 99</a>)</span> using R. Write a clear report about your work, i.e., document everything with a R script or a R Markdown file.</p>
<p>Here are the required steps:</p>
<ol type="1">
<li>Go to <a href="https://www.aeaweb.org/articles?id=10.1257/jep.29.4.89" class="uri">https://www.aeaweb.org/articles?id=10.1257/jep.29.4.89</a> and download the <em>replication package</em> from the <em>OPENICPSR</em> page. Please note, that you can download the replication package after you have registered for the platform.</li>
<li>Unzip the replication package.</li>
<li>In the file <em>diffusion_curves_figure.xlsx</em> you find the required data. Import them to R.</li>
<li>Reproduce the plot using <code>ggplot()</code>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>download.file</code>, <code>geom_line</code>, <code>ggplot</code>, <code>pivot_longer</code>, <code>read_excel</code>, <code>unzip</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/courses/Rlang/hortacsu")</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install and load packages</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL of the ZIP file</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>zipF <span class="ot">&lt;-</span> <span class="st">"https://github.com/hubchev/courses/raw/main/dta/113962-V1.zip"</span></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the ZIP file</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(zipF, <span class="at">destfile =</span> <span class="st">"113962-V1.zip"</span>)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the contents</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">"113962-V1.zip"</span>)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>df_curves <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Hortacsu_Syverson_JEP_Retail/diffusion_curves_figure.xlsx"</span>,</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"Data and Predictions"</span>, <span class="at">range =</span> <span class="st">"N3:Y60"</span></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_curves <span class="sc">|&gt;</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">"Music and Video"</span><span class="sc">:</span><span class="st">"Food and Beverages"</span>,</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"industry"</span>,</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value, <span class="at">group =</span> industry, <span class="at">color =</span> industry)) <span class="sc">+</span></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a><span class="co">#  unload packages</span></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, readxl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/courses/Rlang/hortacsu")</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install and load packages</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL of the ZIP file</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>zipF <span class="ot">&lt;-</span> <span class="st">"https://github.com/hubchev/courses/raw/main/dta/113962-V1.zip"</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the ZIP file</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(zipF, <span class="at">destfile =</span> <span class="st">"113962-V1.zip"</span>)</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the contents</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">"113962-V1.zip"</span>)</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>df_curves <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Hortacsu_Syverson_JEP_Retail/diffusion_curves_figure.xlsx"</span>,</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"Data and Predictions"</span>, <span class="at">range =</span> <span class="st">"N3:Y60"</span></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_curves <span class="sc">|&gt;</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">"Music and Video"</span><span class="sc">:</span><span class="st">"Food and Beverages"</span>,</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"industry"</span>,</span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value, <span class="at">group =</span> industry, <span class="at">color =</span> industry)) <span class="sc">+</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-54-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="80_exercises_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  unload packages</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, readxl))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="explain-the-weight-of-students" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="explain-the-weight-of-students"><span class="header-section-number">9.11</span> Explain the weight of students</h2>
<p>In the statistic course of WS 2020, I asked 23 students about their weight, height, sex, and number of siblings. I wonder how good the height can explain the weight of students. Examine with corelations and a regression analysis the association. Load the data as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"haven"</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>classdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/classdata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>c</code>, <code>coef</code>, <code>fitted</code>, <code>geom_abline</code>, <code>geom_point</code>, <code>ggplot</code>, <code>head</code>, <code>library</code>, <code>lm</code>, <code>plot</code>, <code>read.csv</code>, <code>residuals</code>, <code>show</code>, <code>stat_smooth</code>, <code>subset</code>, <code>summary</code>, <code>tab_model</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo = TRUE--------------------------------------------------</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install and load packages</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>classdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/classdata.csv"</span>)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(classdata)</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo = TRUE--------------------------------------------------</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(classdata)</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ----pressure, echo=TRUE-------------------------------------------</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>)</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="do">## baseline regression  model</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(model)</span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a>interm <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a>interw <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> model<span class="sc">$</span>coefficients[<span class="dv">3</span>]</span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> interw, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> interm, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(model)[[<span class="dv">2</span>]], <span class="at">intercept =</span> <span class="fu">coef</span>(model)[[<span class="dv">1</span>]])</span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb148-51"><a href="#cb148-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span></span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-56"><a href="#cb148-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb148-57"><a href="#cb148-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> siblings))</span>
<span id="cb148-58"><a href="#cb148-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-59"><a href="#cb148-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-60"><a href="#cb148-60" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb148-61"><a href="#cb148-61" aria-hidden="true" tabindex="-1"></a><span class="do">## baseline model</span></span>
<span id="cb148-62"><a href="#cb148-62" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb148-63"><a href="#cb148-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-64"><a href="#cb148-64" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb148-65"><a href="#cb148-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb148-66"><a href="#cb148-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb148-67"><a href="#cb148-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb148-68"><a href="#cb148-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb148-69"><a href="#cb148-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> T,</span>
<span id="cb148-70"><a href="#cb148-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb148-71"><a href="#cb148-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span></span>
<span id="cb148-72"><a href="#cb148-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-73"><a href="#cb148-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-74"><a href="#cb148-74" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE, results='hide'------------------------------------</span></span>
<span id="cb148-75"><a href="#cb148-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-76"><a href="#cb148-76" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> classdata)</span>
<span id="cb148-77"><a href="#cb148-77" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb148-78"><a href="#cb148-78" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb148-79"><a href="#cb148-79" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex <span class="sc">+</span> siblings, <span class="at">data =</span> classdata)</span>
<span id="cb148-80"><a href="#cb148-80" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex, <span class="at">data =</span> <span class="fu">subset</span>(classdata, siblings <span class="sc">&lt;</span> <span class="dv">4</span>))</span>
<span id="cb148-81"><a href="#cb148-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-82"><a href="#cb148-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb148-83"><a href="#cb148-83" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4, m5,</span>
<span id="cb148-84"><a href="#cb148-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb148-85"><a href="#cb148-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb148-86"><a href="#cb148-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb148-87"><a href="#cb148-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb148-88"><a href="#cb148-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-89"><a href="#cb148-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-90"><a href="#cb148-90" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=FALSE---------------------------------------------------</span></span>
<span id="cb148-91"><a href="#cb148-91" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4,</span>
<span id="cb148-92"><a href="#cb148-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb148-93"><a href="#cb148-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb148-94"><a href="#cb148-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb148-95"><a href="#cb148-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb148-96"><a href="#cb148-96" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-97"><a href="#cb148-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-98"><a href="#cb148-98" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=FALSE---------------------------------------------------</span></span>
<span id="cb148-99"><a href="#cb148-99" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m3, m5,</span>
<span id="cb148-100"><a href="#cb148-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb148-101"><a href="#cb148-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb148-102"><a href="#cb148-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb148-103"><a href="#cb148-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb148-104"><a href="#cb148-104" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-105"><a href="#cb148-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-106"><a href="#cb148-106" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=T-------------------------------------------------------</span></span>
<span id="cb148-107"><a href="#cb148-107" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m3), <span class="fu">fitted</span>(m3))</span>
<span id="cb148-108"><a href="#cb148-108" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m3), classdata<span class="sc">$</span>siblings)</span>
<span id="cb148-109"><a href="#cb148-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-110"><a href="#cb148-110" aria-hidden="true" tabindex="-1"></a><span class="do">## ----eval=FALSE----------------------------------------------------</span></span>
<span id="cb148-111"><a href="#cb148-111" aria-hidden="true" tabindex="-1"></a><span class="co">#  rmarkdown::render("regress_lecture.Rmd", "all")</span></span>
<span id="cb148-112"><a href="#cb148-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-113"><a href="#cb148-113" aria-hidden="true" tabindex="-1"></a><span class="co">#  unload packages</span></span>
<span id="cb148-114"><a href="#cb148-114" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo = TRUE--------------------------------------------------</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install and load packages</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>classdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/classdata.csv"</span>)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(classdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id sex weight height siblings row
1  1   w     53    156        1   g
2  2   w     73    170        1   g
3  3   m     68    169        1   g
4  4   w     67    166        1   g
5  5   w     65    175        1   g
6  6   w     48    161        0   g</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo = TRUE--------------------------------------------------</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(classdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id           sex                weight          height     
 Min.   : 1.0   Length:23          Min.   :48.00   Min.   :156.0  
 1st Qu.: 6.5   Class :character   1st Qu.:64.50   1st Qu.:168.0  
 Median :12.0   Mode  :character   Median :70.00   Median :175.0  
 Mean   :12.0                      Mean   :70.61   Mean   :173.7  
 3rd Qu.:17.5                      3rd Qu.:81.00   3rd Qu.:180.0  
 Max.   :23.0                      Max.   :90.00   Max.   :194.0  
    siblings         row           
 Min.   :0.000   Length:23         
 1st Qu.:1.000   Class :character  
 Median :1.000   Mode  :character  
 Mean   :1.391                     
 3rd Qu.:2.000                     
 Max.   :4.000                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ----pressure, echo=TRUE-------------------------------------------</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="80_exercises_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="80_exercises_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="do">## baseline regression  model</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ height + sex, data = classdata)

Coefficients:
(Intercept)       height         sexw  
   -29.5297       0.5923      -5.7894  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>interm <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>interw <span class="ot">&lt;-</span> model<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> model<span class="sc">$</span>coefficients[<span class="dv">3</span>]</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ height + sex, data = classdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.086  -3.730   2.850   7.245  12.914 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -29.5297    47.6606  -0.620   0.5425  
height        0.5923     0.2671   2.217   0.0383 *
sexw         -5.7894     4.4773  -1.293   0.2107  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.942 on 20 degrees of freedom
Multiple R-squared:  0.4124,    Adjusted R-squared:  0.3537 
F-statistic: 7.019 on 2 and 20 DF,  p-value: 0.004904</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> interw, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> interm, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(model)[[<span class="dv">2</span>]], <span class="at">intercept =</span> <span class="fu">coef</span>(model)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="80_exercises_files/figure-html/unnamed-chunk-57-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">1</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="80_exercises_files/figure-html/unnamed-chunk-57-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> siblings))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="80_exercises_files/figure-html/unnamed-chunk-57-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE----------------------------------------------------</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="do">## baseline model</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(classdata, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> T,</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="80_exercises_files/figure-html/unnamed-chunk-57-6.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=TRUE, results='hide'------------------------------------</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> classdata)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex, <span class="at">data =</span> classdata)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex <span class="sc">+</span> siblings, <span class="at">data =</span> classdata)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> sex <span class="sc">+</span> height <span class="sc">*</span> sex, <span class="at">data =</span> <span class="fu">subset</span>(classdata, siblings <span class="sc">&lt;</span> <span class="dv">4</span>))</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4, m5,</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-65.44 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-29.53 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">47.14 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">50.27 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">27.69 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.78 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.59 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.28 <sup></sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.79 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-153.96 <sup>**</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-161.92 <sup>**</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-134.51 <sup>*</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height × sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.85 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.89 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.74 <sup>*</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">siblings</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.16 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.363 / 0.333</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.412 / 0.354</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.487 / 0.407</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.496 / 0.385</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.572 / 0.497</td>
</tr>
<tr class="even">
<td colspan="6" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.2&nbsp;&nbsp;&nbsp;** p&lt;0.1&nbsp;&nbsp;&nbsp;*** p&lt;0.05</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=FALSE---------------------------------------------------</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m1, m2, m3, m4,</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-65.44 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-29.53 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">47.14 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">50.27 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.78 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.59 <sup>***</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16 <sup></sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.79 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-153.96 <sup>**</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-161.92 <sup>**</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height × sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.85 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.89 <sup>*</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">siblings</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.16 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.363 / 0.333</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.412 / 0.354</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.487 / 0.407</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.496 / 0.385</td>
</tr>
<tr class="even">
<td colspan="5" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.2&nbsp;&nbsp;&nbsp;** p&lt;0.1&nbsp;&nbsp;&nbsp;*** p&lt;0.05</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=FALSE---------------------------------------------------</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(m3, m5,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.style =</span> <span class="st">"stars"</span>,</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.threshold =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.ci =</span> <span class="cn">FALSE</span>,</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.se =</span> <span class="cn">FALSE</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">weight</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">47.14 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">27.69 <sup></sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.16 <sup></sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.28 <sup></sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-153.96 <sup>**</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-134.51 <sup>*</sup></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">height × sex [w]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.85 <sup>*</sup></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.74 <sup>*</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">23</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">21</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.487 / 0.407</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.572 / 0.497</td>
</tr>
<tr class="odd">
<td colspan="3" style="text-align: right; font-style: italic; border-top: double black;">* p&lt;0.2&nbsp;&nbsp;&nbsp;** p&lt;0.1&nbsp;&nbsp;&nbsp;*** p&lt;0.05</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- echo=T-------------------------------------------------------</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m3), <span class="fu">fitted</span>(m3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="80_exercises_files/figure-html/unnamed-chunk-57-7.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m3), classdata<span class="sc">$</span>siblings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-57-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="80_exercises_files/figure-html/unnamed-chunk-57-8.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ----eval=FALSE----------------------------------------------------</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  rmarkdown::render("regress_lecture.Rmd", "all")</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  unload packages</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="calories-and-weight" class="level2" data-number="9.12">
<h2 data-number="9.12" class="anchored" data-anchor-id="calories-and-weight"><span class="header-section-number">9.12</span> Calories and weight</h2>
<ol type="a">
<li>Write down your name, your matriculation number, and the date.</li>
<li>Set your working directory.</li>
<li>Clear your global environment.</li>
<li>Load the following package: <code>tidyverse</code></li>
</ol>
<p>The following table stems from a survey carried out at the Campus of the German Sport University of Cologne at Opening Day (first day of the new semester) between 8:00am and 8:20am. The survey consists of 6 individuals with the following information:</p>
<table class="table">
<thead>
<tr class="header">
<th>id</th>
<th>sex</th>
<th>age</th>
<th>weight</th>
<th>calories</th>
<th>sport</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>f</td>
<td>21</td>
<td>48</td>
<td>1700</td>
<td>60</td>
</tr>
<tr class="even">
<td>2</td>
<td>f</td>
<td>19</td>
<td>55</td>
<td>1800</td>
<td>120</td>
</tr>
<tr class="odd">
<td>3</td>
<td>f</td>
<td>23</td>
<td>50</td>
<td>2300</td>
<td>180</td>
</tr>
<tr class="even">
<td>4</td>
<td>m</td>
<td>18</td>
<td>71</td>
<td>2000</td>
<td>60</td>
</tr>
<tr class="odd">
<td>5</td>
<td>m</td>
<td>20</td>
<td>77</td>
<td>2800</td>
<td>240</td>
</tr>
<tr class="even">
<td>6</td>
<td>m</td>
<td>61</td>
<td>85</td>
<td>2500</td>
<td>30</td>
</tr>
</tbody>
</table>
<p>Data Description:</p>
<ul>
<li><strong>id:</strong> Variable with an anonymized identifier for each participant.</li>
<li><strong>sex:</strong> Gender, i.e., the participants replied to be either male (m) or female (f).</li>
<li><strong>age:</strong> The age in years of the participants at the time of the survey.</li>
<li><strong>weight:</strong> Number of kg the participants pretended to weight.</li>
<li><strong>calories:</strong> Estimate of the participants on their average daily consumption of calories.</li>
<li><strong>sport:</strong> Estimate of the participants on their average daily time that they spend on doing sports (measured in minutes).</li>
</ul>
<ol start="5" type="a">
<li>Which type of data do we have here? (Panel data, repeated cross-sectional data, cross-sectional data, time Series data)</li>
<li>Store each of the five variables in a vector and put all five variables into a dataframe with the title <code>df</code>. If you fail here, read in the data using this line of code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/df-calories.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): sex
dbl (4): age, weight, calories, sport

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ol start="7" type="a">
<li><p>Show for all numerical variables the summary statistics including the mean, median, minimum, and the maximum.</p></li>
<li><p>Show for all numerical variables the summary statistics including the mean and the standard deviation, <strong>separated by male and female</strong>. Use therefore the pipe operator.</p></li>
<li><p>Suppose you want to analyze the general impact of average calories consumption per day on the weight. Discuss if the sample design is appropriate to draw conclusions on the population. What may cause some bias in the data? Discuss possibilities to improve the sampling and the survey, respectively.</p></li>
<li><p>The following plot visualizes the two variables weight and calories. Discuss what can be improved in the graphical visualization.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Weight vs.&nbsp;Calories</figcaption>
<p><a href="fig/sport-r.png" class="lightbox" data-glightbox="description: .lightbox-desc-23" data-gallery="quarto-lightbox-gallery-23" title="Weight vs.&nbsp;Calories"><img src="fig/sport-r.png" class="img-fluid figure-img" style="width:40.0%" alt="Weight vs.&nbsp;Calories"></a></p>
</figure>
</div>
<ol start="11" type="a">
<li><p>Make a scatterplot matrix containing all numerical variables.</p></li>
<li><p>Calculate the Pearson Correlation Coefficient of the two variables</p>
<ol type="1">
<li><code>calories</code> and <code>sport</code></li>
<li><code>weight</code> and <code>calories</code></li>
</ol></li>
<li><p>Make a scatterplot with <code>weight</code> in the y-axis and <code>calories</code> on the x-axis. Additionally, the plot should contain a linear fit and the points should be labeled with the <code>sex</code> just like in the figure shown above.</p></li>
<li><p>Estimate the following regression specification using the OLS method: [weight_i=_0+_1 calories_i+ _i]</p></li>
</ol>
<p>Show a summary of the estimates that look like the following:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ calories, data = df)

Residuals:
     1      2      3      4      5      6 
-5.490 -1.182 -6.640  9.435 -6.099  9.976 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  7.730275  20.197867   0.383   0.7214  
calories     0.026917   0.009107   2.956   0.0417 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.68 on 4 degrees of freedom
Multiple R-squared:  0.6859,    Adjusted R-squared:  0.6074 
F-statistic: 8.735 on 1 and 4 DF,  p-value: 0.04174</code></pre>
</div>
</div>
<ol start="15" type="a">
<li><p>Interpret the results. In particular, interpret how many kg the estimated weight increases—on average and ceteris paribus—if calories increase by 100 calories. Additionally, discuss the statistical properties of the estimated coefficient <span class="math inline">\(\hat{\beta_1}\)</span> and the meaning of the <strong>Adjusted R-squared</strong>.</p></li>
<li><p>OLS estimates can suffer from omitted variable bias. State the two conditions that need to be fulfilled for omitted bias to occur.</p></li>
<li><p>Discuss potential confounding variables that may cause omitted variable bias. Given the dataset above how can some of the confounding variables be <em>controlled for</em>?</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>c</code>, <code>cor</code>, <code>data.frame</code>, <code>geom_point</code>, <code>geom_text</code>, <code>ggplot</code>, <code>group_by</code>, <code>lm</code>, <code>mean</code>, <code>plot</code>, <code>read_csv</code>, <code>sd</code>, <code>stat_smooth</code>, <code>summarise</code>, <code>summary</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber, 000, 2020-May-30</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/22-ss/dsb_bac/work/")</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven)</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cross-section</span></span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>, <span class="st">"m"</span>, <span class="st">"m"</span>)</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">61</span>)</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">55</span>, <span class="dv">63</span>, <span class="dv">71</span>, <span class="dv">77</span>, <span class="dv">85</span>)</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>calories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1700</span>, <span class="dv">1800</span>, <span class="dv">2300</span>, <span class="dv">2000</span>, <span class="dv">2800</span>, <span class="dv">2500</span>)</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>sport <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">60</span>, <span class="dv">240</span>, <span class="dv">30</span>)</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sex, age, weight, calories, sport)</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(df, file = "/home/sthu/Dropbox/hsf/exams/21-04/stuff/df.csv")</span></span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(df, file = "/home/sthu/Dropbox/hsf/github/courses/dta/df-calories.csv")</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/df-calories.csv"</span>)</span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 7</span></span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 8</span></span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">mcal =</span> <span class="fu">mean</span>(calories),</span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdcal =</span> <span class="fu">sd</span>(calories),</span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">mweight =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdweight =</span> <span class="fu">sd</span>(weight)</span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 9</span></span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a><span class="co"># discussed in class</span></span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 10</span></span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Many things can be mentioned here such as the use of colors</span></span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a><span class="co"># (red/blue is not a good choice for color blind people),</span></span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a><span class="co"># the legend makes no sense as red and green both refer to \textit{sport},</span></span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a><span class="co"># the label of `f' and `m' is not explained in the legend,</span></span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a><span class="co"># rotating the labels of the y-axis would increase readability, and</span></span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a><span class="co"># both axes do not start at zero which is hard to see.</span></span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, it is a common to draw the variable you want to explain</span></span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a><span class="co"># (here: calories) on the y-axis.</span></span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 11</span></span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df)</span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-58"><a href="#cb173-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 12</span></span>
<span id="cb173-59"><a href="#cb173-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>calories, df<span class="sc">$</span>sport, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span>
<span id="cb173-60"><a href="#cb173-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>weight, df<span class="sc">$</span>calories, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span>
<span id="cb173-61"><a href="#cb173-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-62"><a href="#cb173-62" aria-hidden="true" tabindex="-1"></a><span class="co"># 13</span></span>
<span id="cb173-63"><a href="#cb173-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> calories, <span class="at">y =</span> weight, <span class="at">label =</span> sex)) <span class="sc">+</span></span>
<span id="cb173-64"><a href="#cb173-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb173-65"><a href="#cb173-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb173-66"><a href="#cb173-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb173-67"><a href="#cb173-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-68"><a href="#cb173-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 14</span></span>
<span id="cb173-69"><a href="#cb173-69" aria-hidden="true" tabindex="-1"></a>reg_base <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> calories, <span class="at">data =</span> df)</span>
<span id="cb173-70"><a href="#cb173-70" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_base)</span>
<span id="cb173-71"><a href="#cb173-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-72"><a href="#cb173-72" aria-hidden="true" tabindex="-1"></a><span class="co"># 15</span></span>
<span id="cb173-73"><a href="#cb173-73" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) An increase of 100 calories (taken on average on a daily basis) is associated</span></span>
<span id="cb173-74"><a href="#cb173-74" aria-hidden="true" tabindex="-1"></a><span class="co"># - on average and ceteris paribus - with 2.69 more of kg the participants are</span></span>
<span id="cb173-75"><a href="#cb173-75" aria-hidden="true" tabindex="-1"></a><span class="co"># pretended to weight.</span></span>
<span id="cb173-76"><a href="#cb173-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) The estimated coefficient $beta_1$ is statistically significantly different to zero</span></span>
<span id="cb173-77"><a href="#cb173-77" aria-hidden="true" tabindex="-1"></a><span class="co"># on a significance level of 5%.</span></span>
<span id="cb173-78"><a href="#cb173-78" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) About 60 % of the variation of the weight is explained by the</span></span>
<span id="cb173-79"><a href="#cb173-79" aria-hidden="true" tabindex="-1"></a><span class="co"># estimated coefficients of the empirical model.</span></span>
<span id="cb173-80"><a href="#cb173-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-81"><a href="#cb173-81" aria-hidden="true" tabindex="-1"></a><span class="co"># 16</span></span>
<span id="cb173-82"><a href="#cb173-82" aria-hidden="true" tabindex="-1"></a><span class="co"># For omitted variable bias to occur, the omitted variable `Z` must satisfy</span></span>
<span id="cb173-83"><a href="#cb173-83" aria-hidden="true" tabindex="-1"></a><span class="co"># two conditions:</span></span>
<span id="cb173-84"><a href="#cb173-84" aria-hidden="true" tabindex="-1"></a><span class="co">#   1) The omitted variable is correlated with the included regressor</span></span>
<span id="cb173-85"><a href="#cb173-85" aria-hidden="true" tabindex="-1"></a><span class="co">#   2) The omitted variable is a determinant of the dependent variable</span></span>
<span id="cb173-86"><a href="#cb173-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-87"><a href="#cb173-87" aria-hidden="true" tabindex="-1"></a><span class="co"># 17</span></span>
<span id="cb173-88"><a href="#cb173-88" aria-hidden="true" tabindex="-1"></a><span class="co"># discussed in class</span></span>
<span id="cb173-89"><a href="#cb173-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-90"><a href="#cb173-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-91"><a href="#cb173-91" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb173-92"><a href="#cb173-92" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Stephan Huber, 000, 2020-May-30</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/22-ss/dsb_bac/work/")</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven)</span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cross-section</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>, <span class="st">"m"</span>, <span class="st">"m"</span>)</span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">61</span>)</span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">55</span>, <span class="dv">63</span>, <span class="dv">71</span>, <span class="dv">77</span>, <span class="dv">85</span>)</span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a>calories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1700</span>, <span class="dv">1800</span>, <span class="dv">2300</span>, <span class="dv">2000</span>, <span class="dv">2800</span>, <span class="dv">2500</span>)</span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>sport <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">60</span>, <span class="dv">240</span>, <span class="dv">30</span>)</span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sex, age, weight, calories, sport)</span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(df, file = "/home/sthu/Dropbox/hsf/exams/21-04/stuff/df.csv")</span></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(df, file = "/home/sthu/Dropbox/hsf/github/courses/dta/df-calories.csv")</span></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/hubchev/courses/main/dta/df-calories.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): sex
dbl (4): age, weight, calories, sport

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sex                 age            weight        calories        sport    
 Length:6           Min.   :18.00   Min.   :48.0   Min.   :1700   Min.   : 30  
 Class :character   1st Qu.:19.25   1st Qu.:57.0   1st Qu.:1850   1st Qu.: 60  
 Mode  :character   Median :20.50   Median :67.0   Median :2150   Median : 90  
                    Mean   :27.00   Mean   :66.5   Mean   :2183   Mean   :115  
                    3rd Qu.:22.50   3rd Qu.:75.5   3rd Qu.:2450   3rd Qu.:165  
                    Max.   :61.00   Max.   :85.0   Max.   :2800   Max.   :240  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mcal =</span> <span class="fu">mean</span>(calories),</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdcal =</span> <span class="fu">sd</span>(calories),</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mweight =</span> <span class="fu">mean</span>(weight),</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sdweight =</span> <span class="fu">sd</span>(weight)</span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  sex    mcal sdcal mweight sdweight
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 f     1933.  321.    55.3     7.51
2 m     2433.  404.    77.7     7.02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># discussed in class</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 10</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Many things can be mentioned here such as the use of colors</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (red/blue is not a good choice for color blind people),</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the legend makes no sense as red and green both refer to \textit{sport},</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the label of `f' and `m' is not explained in the legend,</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rotating the labels of the y-axis would increase readability, and</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="co"># both axes do not start at zero which is hard to see.</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, it is a common to draw the variable you want to explain</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (here: calories) on the y-axis.</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 11</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-62-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="80_exercises_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 12</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>calories, df<span class="sc">$</span>sport, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5330615</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>weight, df<span class="sc">$</span>calories, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8281972</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 13</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> calories, <span class="at">y =</span> weight, <span class="at">label =</span> sex)) <span class="sc">+</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: label.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-62-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="80_exercises_files/figure-html/unnamed-chunk-62-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 14</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>reg_base <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> calories, <span class="at">data =</span> df)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ calories, data = df)

Residuals:
     1      2      3      4      5      6 
-5.490 -1.182 -6.640  9.435 -6.099  9.976 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  7.730275  20.197867   0.383   0.7214  
calories     0.026917   0.009107   2.956   0.0417 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.68 on 4 degrees of freedom
Multiple R-squared:  0.6859,    Adjusted R-squared:  0.6074 
F-statistic: 8.735 on 1 and 4 DF,  p-value: 0.04174</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 15</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) An increase of 100 calories (taken on average on a daily basis) is associated</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - on average and ceteris paribus - with 2.69 more of kg the participants are</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pretended to weight.</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) The estimated coefficient $beta_1$ is statistically significantly different to zero</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co"># on a significance level of 5%.</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) About 60 % of the variation of the weight is explained by the</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co"># estimated coefficients of the empirical model.</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 16</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For omitted variable bias to occur, the omitted variable `Z` must satisfy</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co"># two conditions:</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   1) The omitted variable is correlated with the included regressor</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   2) The omitted variable is a determinant of the dependent variable</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 17</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="co"># discussed in class</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bundesliga" class="level2" data-number="9.13">
<h2 data-number="9.13" class="anchored" data-anchor-id="bundesliga"><span class="header-section-number">9.13</span> Bundesliga</h2>
<p>Open the script that you find <a href="https://raw.githubusercontent.com/hubchev/courses/main/scr/ask_dfb.R">here</a> and work on the following tasks:</p>
<ol type="1">
<li><p>Set your working directory.</p></li>
<li><p>Clear th environment.</p></li>
<li><p>Install and load the <code>bundesligR</code> and <code>tidyverse</code>.</p></li>
<li><p>Read in the data <code>bundesligR</code> as a tibble.</p></li>
<li><p>Replace “Bor. Moenchengladbach” with “Borussia Moenchengladbach.”</p></li>
<li><p>Check for the data class.</p></li>
<li><p>View the data.</p></li>
<li><p>Glimpse on the data.</p></li>
<li><p>Show the first and last observations.</p></li>
<li><p>Show summary statistics to all variables.</p></li>
<li><p>How many teams have played in the league over the years?</p></li>
<li><p>Which teams have played Bundesliga so far?</p></li>
<li><p>How many teams have played Bundesliga?</p></li>
<li><p>How often has each team played in the Bundesliga?</p></li>
<li><p>Show summary statistics of variable <code>Season</code> only.</p></li>
<li><p>Show summary statistics of all numeric variables (<code>Team</code> is a character).</p></li>
<li><p>What is the highest number of points ever received by a team? Show only the name of the club with the highest number of points ever received.</p></li>
<li><p>Create a new tibble using <code>liga</code> removing the variable <code>Pts_pre_95</code> from the data.</p></li>
<li><p>Create a new tibble using <code>liga</code> renaming W, D, and L to Win, Draw, and Loss. Additionally rename GF, GA, GD to Goals_shot, Goals_received, Goal_difference.</p></li>
<li><p>Create a new tibble using <code>liga</code> without the variable <code>Pts_pre_95</code> and only observations before the year 1996.</p></li>
<li><p>Remove the three tibbles just created from the environment.</p></li>
<li><p>Rename all variables of <code>liga</code> to lowercase and store it as <code>dfb</code>.</p></li>
<li><p>Show the winner and the runner up after the year 2010. Additionally show the points received.</p></li>
<li><p>Create a variable that counts how often a team was ranked first.</p></li>
<li><p>How often has each team played in the Bundesliga?</p></li>
<li><p>Make a ranking that shows which team has played the Bundesliga most often.</p></li>
<li><p>Add a variable to <code>dfb</code> that contains the number of appearances of a team in the league.</p></li>
<li><p>Create a number that indicates how often a team has played Bundesliga in a given year.</p></li>
<li><p>Make a ranking with the number of titles of all teams that ever won the league.</p></li>
<li><p>Create a numeric identifying variable for each team.</p></li>
<li><p>When a team is in the league, what is the probability that it wins the league?</p></li>
<li><p>Make a scatterplot with points on the y-axis and position on the x-axis.</p></li>
<li><p>Make a scatterplot with points on the y-axis and position on the x-axis. Additionally, only consider seasons with 18 teams and add lines that make clear how many points you needed to be placed in between rank 2 and 15.</p></li>
<li><p>Remove all objects from the environment except <code>dfb</code> and <code>liga</code>.</p></li>
<li><p>In Figure <a href="#fig-fckpic" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>, the ranking history of <em>1. FC Kaiserslautern</em> is shown. Replicate that plot.</p></li>
</ol>
<div id="fig-fckpic" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-fckpic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Ranking history: 1. FC Kaiserslautern
</figcaption>
<div aria-describedby="fig-fckpic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/fckpic-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-26" data-gallery="quarto-lightbox-gallery-26"><img src="80_exercises_files/figure-html/fckpic-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<ol start="34" type="1">
<li>In Figure <a href="#fig-efzplot" class="quarto-xref">Figure&nbsp;<span>9.3</span></a>, I made the graph a bit nicer. Can you spot all differences and can you guess what the dashed line and the triangles mean? How could the visualization be improved further? Replicate the plot.</li>
</ol>
<div id="fig-efzplot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-efzplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Ranking history: 1. FC Köln
</figcaption>
<div aria-describedby="fig-efzplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/efzplot-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-27" data-gallery="quarto-lightbox-gallery-27"><img src="80_exercises_files/figure-html/efzplot-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<ol start="35" type="1">
<li>Try to make the ranking history for each club ever played the league and export the graph as a <code>png</code> file.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>arrange</code>, <code>as_tibble</code>, <code>as.numeric</code>, <code>between</code>, <code>c</code>, <code>case_when</code>, <code>class</code>, <code>complete</code>, <code>desc</code>, <code>dir.create</code>, <code>dir.exists</code>, <code>element_blank</code>, <code>facet_wrap</code>, <code>factor</code>, <code>filter</code>, <code>geom_hline</code>, <code>geom_line</code>, <code>geom_point</code>, <code>geom_vline</code>, <code>ggplot</code>, <code>ggsave</code>, <code>glimpse</code>, <code>group_by</code>, <code>head</code>, <code>ifelse</code>, <code>is.na</code>, <code>labs</code>, <code>list</code>, <code>max</code>, <code>mutate</code>, <code>n_distinct</code>, <code>paste</code>, <code>print</code>, <code>rename</code>, <code>rename_all</code>, <code>row_number</code>, <code>scale_x_continuous</code>, <code>scale_y_continuous</code>, <code>scale_y_reverse</code>, <code>select</code>, <code>seq</code>, <code>setdiff</code>, <code>slice_head</code>, <code>subset</code>, <code>sum</code>, <code>summarise</code>, <code>summary</code>, <code>table</code>, <code>tail</code>, <code>theme</code>, <code>theme_classic</code>, <code>theme_minimal</code>, <code>unique</code>, <code>unlink</code>, <code>view</code>, <code>xlim</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In dfb.R I analyze German soccer results</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/23-ws/dsda/scripts")</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear environment</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (Install and) load packagages</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  bundesligR,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>  tidyverse</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data as tibble</span></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>liga <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(bundesligR)</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="co"># !!! ERRORS / ISSUES:</span></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a><span class="co"># "Borussia Moenchengladbach" is also entitled "Bor. Moenchengladbach"!</span></span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Leverkusen is falsly entitled "SV Bayer 04 Leverkusen"</span></span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Uerdingen has changed its name several times</span></span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Stuttgarter Kickers are named differently</span></span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a><span class="co"># How often is "Bor. Moenchengladbach" in the data?</span></span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(liga<span class="sc">$</span>Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>)</span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a><span class="co"># show the entries</span></span>
<span id="cb190-30"><a href="#cb190-30" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-31"><a href="#cb190-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>)</span>
<span id="cb190-32"><a href="#cb190-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-33"><a href="#cb190-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "Bor. Moenchengladbach" with "Borussia Moenchengladbach"</span></span>
<span id="cb190-34"><a href="#cb190-34" aria-hidden="true" tabindex="-1"></a>liga <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb190-35"><a href="#cb190-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>,</span>
<span id="cb190-36"><a href="#cb190-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Borussia Moenchengladbach"</span>,</span>
<span id="cb190-37"><a href="#cb190-37" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb190-38"><a href="#cb190-38" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb190-39"><a href="#cb190-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"SV Bayer 04 Leverkusen"</span>,</span>
<span id="cb190-40"><a href="#cb190-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TSV Bayer 04 Leverkusen"</span>,</span>
<span id="cb190-41"><a href="#cb190-41" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb190-42"><a href="#cb190-42" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb190-43"><a href="#cb190-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"FC Bayer 05 Uerdingen"</span> <span class="sc">|</span></span>
<span id="cb190-44"><a href="#cb190-44" aria-hidden="true" tabindex="-1"></a>    Team <span class="sc">==</span> <span class="st">"Bayer 05 Uerdingen"</span>,</span>
<span id="cb190-45"><a href="#cb190-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"KFC Uerdingen 05"</span>,</span>
<span id="cb190-46"><a href="#cb190-46" aria-hidden="true" tabindex="-1"></a>  Team</span>
<span id="cb190-47"><a href="#cb190-47" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb190-48"><a href="#cb190-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"SV Stuttgarter Kickers"</span>,</span>
<span id="cb190-49"><a href="#cb190-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stuttgarter Kickers"</span>,</span>
<span id="cb190-50"><a href="#cb190-50" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb190-51"><a href="#cb190-51" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb190-52"><a href="#cb190-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-53"><a href="#cb190-53" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------</span></span>
<span id="cb190-54"><a href="#cb190-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-55"><a href="#cb190-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for the data class</span></span>
<span id="cb190-56"><a href="#cb190-56" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(liga)</span>
<span id="cb190-57"><a href="#cb190-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-58"><a href="#cb190-58" aria-hidden="true" tabindex="-1"></a><span class="co"># view data</span></span>
<span id="cb190-59"><a href="#cb190-59" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(liga)</span>
<span id="cb190-60"><a href="#cb190-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-61"><a href="#cb190-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse on the data</span></span>
<span id="cb190-62"><a href="#cb190-62" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(liga)</span>
<span id="cb190-63"><a href="#cb190-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-64"><a href="#cb190-64" aria-hidden="true" tabindex="-1"></a><span class="co"># first and last observations</span></span>
<span id="cb190-65"><a href="#cb190-65" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(liga)</span>
<span id="cb190-66"><a href="#cb190-66" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(liga)</span>
<span id="cb190-67"><a href="#cb190-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-68"><a href="#cb190-68" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb190-69"><a href="#cb190-69" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(liga)</span>
<span id="cb190-70"><a href="#cb190-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-71"><a href="#cb190-71" aria-hidden="true" tabindex="-1"></a><span class="co"># How many teams have played in the league over the years?</span></span>
<span id="cb190-72"><a href="#cb190-72" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Season)</span>
<span id="cb190-73"><a href="#cb190-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-74"><a href="#cb190-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Which teams have played Bundesliga</span></span>
<span id="cb190-75"><a href="#cb190-75" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(liga<span class="sc">$</span>Team)</span>
<span id="cb190-76"><a href="#cb190-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-77"><a href="#cb190-77" aria-hidden="true" tabindex="-1"></a><span class="co"># How many teams have played Bundesliga</span></span>
<span id="cb190-78"><a href="#cb190-78" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(liga<span class="sc">$</span>Team)</span>
<span id="cb190-79"><a href="#cb190-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-80"><a href="#cb190-80" aria-hidden="true" tabindex="-1"></a><span class="co"># How often has each team played in the Bundesliga</span></span>
<span id="cb190-81"><a href="#cb190-81" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Team)</span>
<span id="cb190-82"><a href="#cb190-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-83"><a href="#cb190-83" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of variable Season only</span></span>
<span id="cb190-84"><a href="#cb190-84" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(liga<span class="sc">$</span>Season)</span>
<span id="cb190-85"><a href="#cb190-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-86"><a href="#cb190-86" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of numeric of variables (Team is a character)</span></span>
<span id="cb190-87"><a href="#cb190-87" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-88"><a href="#cb190-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Season, Position, Played, W, D, L, GF, GA, GD, Points, Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb190-89"><a href="#cb190-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb190-90"><a href="#cb190-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-91"><a href="#cb190-91" aria-hidden="true" tabindex="-1"></a><span class="co"># shorter alternative</span></span>
<span id="cb190-92"><a href="#cb190-92" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-93"><a href="#cb190-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Season, Position, Played<span class="sc">:</span>Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb190-94"><a href="#cb190-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb190-95"><a href="#cb190-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-96"><a href="#cb190-96" aria-hidden="true" tabindex="-1"></a><span class="co"># shortest alternative</span></span>
<span id="cb190-97"><a href="#cb190-97" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-98"><a href="#cb190-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Team) <span class="sc">|&gt;</span></span>
<span id="cb190-99"><a href="#cb190-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Season <span class="sc">==</span> <span class="dv">1999</span> <span class="sc">|</span> Season <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-100"><a href="#cb190-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb190-101"><a href="#cb190-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-102"><a href="#cb190-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Most points ever received by a team</span></span>
<span id="cb190-103"><a href="#cb190-103" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-104"><a href="#cb190-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Points <span class="sc">==</span> <span class="fu">max</span>(Points))</span>
<span id="cb190-105"><a href="#cb190-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-106"><a href="#cb190-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only the team name</span></span>
<span id="cb190-107"><a href="#cb190-107" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb190-108"><a href="#cb190-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Points <span class="sc">==</span> <span class="fu">max</span>(Points)) <span class="sc">|&gt;</span></span>
<span id="cb190-109"><a href="#cb190-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Team) <span class="sc">|&gt;</span></span>
<span id="cb190-110"><a href="#cb190-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb190-111"><a href="#cb190-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-112"><a href="#cb190-112" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the variable `Pts_pre_95` from the data</span></span>
<span id="cb190-113"><a href="#cb190-113" aria-hidden="true" tabindex="-1"></a>liga_post95 <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb190-114"><a href="#cb190-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Pts_pre_95)</span>
<span id="cb190-115"><a href="#cb190-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-116"><a href="#cb190-116" aria-hidden="true" tabindex="-1"></a><span class="co"># rename W, D, and L to Win, Draw, and Loss</span></span>
<span id="cb190-117"><a href="#cb190-117" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally rename GF, GA, GD to Goals_shot, Goals_received, Goal_difference</span></span>
<span id="cb190-118"><a href="#cb190-118" aria-hidden="true" tabindex="-1"></a>liga_longnames <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb190-119"><a href="#cb190-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Win =</span> W, <span class="at">Draw =</span> D, <span class="at">Loss =</span> L) <span class="sc">|&gt;</span></span>
<span id="cb190-120"><a href="#cb190-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Goals_shot =</span> GF, <span class="at">Goals_received =</span> GA, <span class="at">Goal_difference =</span> GD)</span>
<span id="cb190-121"><a href="#cb190-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-122"><a href="#cb190-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the variable `Pts_pre_95` from `liga`</span></span>
<span id="cb190-123"><a href="#cb190-123" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally remove all observations before the year 1996</span></span>
<span id="cb190-124"><a href="#cb190-124" aria-hidden="true" tabindex="-1"></a>liga_no3point <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb190-125"><a href="#cb190-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb190-126"><a href="#cb190-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Season <span class="sc">&gt;=</span> <span class="dv">1996</span>)</span>
<span id="cb190-127"><a href="#cb190-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-128"><a href="#cb190-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the objects liga_post95, liga_longnames, and liga_no3point from the environment</span></span>
<span id="cb190-129"><a href="#cb190-129" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(liga_post95, liga_longnames, liga_no3point)</span>
<span id="cb190-130"><a href="#cb190-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-131"><a href="#cb190-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename all variables of `liga`to lower cases and store it as `dfb`</span></span>
<span id="cb190-132"><a href="#cb190-132" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb190-133"><a href="#cb190-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb190-134"><a href="#cb190-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-135"><a href="#cb190-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the winner and the runner up after 2010</span></span>
<span id="cb190-136"><a href="#cb190-136" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally show the points</span></span>
<span id="cb190-137"><a href="#cb190-137" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb190-138"><a href="#cb190-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season <span class="sc">&gt;</span> <span class="dv">2010</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-139"><a href="#cb190-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb190-140"><a href="#cb190-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(points)) <span class="sc">|&gt;</span></span>
<span id="cb190-141"><a href="#cb190-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-142"><a href="#cb190-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(team, points, position)</span>
<span id="cb190-143"><a href="#cb190-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-144"><a href="#cb190-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable that counts how often a team was ranked first</span></span>
<span id="cb190-145"><a href="#cb190-145" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-146"><a href="#cb190-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb190-147"><a href="#cb190-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meister_count =</span> <span class="fu">sum</span>(position <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb190-148"><a href="#cb190-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-149"><a href="#cb190-149" aria-hidden="true" tabindex="-1"></a><span class="co"># How often has each team played in the Bundesliga</span></span>
<span id="cb190-150"><a href="#cb190-150" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Team)</span>
<span id="cb190-151"><a href="#cb190-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-152"><a href="#cb190-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a ranking</span></span>
<span id="cb190-153"><a href="#cb190-153" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb190-154"><a href="#cb190-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb190-155"><a href="#cb190-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">appearances =</span> <span class="fu">n_distinct</span>(season)) <span class="sc">|&gt;</span></span>
<span id="cb190-156"><a href="#cb190-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(appearances)) <span class="sc">|&gt;</span></span>
<span id="cb190-157"><a href="#cb190-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span>
<span id="cb190-158"><a href="#cb190-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-159"><a href="#cb190-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a variable to `dfb` that contains the number of appearances of a team in the league</span></span>
<span id="cb190-160"><a href="#cb190-160" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-161"><a href="#cb190-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb190-162"><a href="#cb190-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">appearances =</span> <span class="fu">n_distinct</span>(season))</span>
<span id="cb190-163"><a href="#cb190-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-164"><a href="#cb190-164" aria-hidden="true" tabindex="-1"></a><span class="co"># create a number that indicates how often a team has played Bundesliga in a given year</span></span>
<span id="cb190-165"><a href="#cb190-165" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-166"><a href="#cb190-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(team, season) <span class="sc">|&gt;</span></span>
<span id="cb190-167"><a href="#cb190-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb190-168"><a href="#cb190-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_in_liga_count =</span> <span class="fu">row_number</span>())</span>
<span id="cb190-169"><a href="#cb190-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-170"><a href="#cb190-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a ranking with the number of titles of all teams that ever won the league</span></span>
<span id="cb190-171"><a href="#cb190-171" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb190-172"><a href="#cb190-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team_in_liga_count <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-173"><a href="#cb190-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(meister_count <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-174"><a href="#cb190-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meister_count)) <span class="sc">|&gt;</span></span>
<span id="cb190-175"><a href="#cb190-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(meister_count, team)</span>
<span id="cb190-176"><a href="#cb190-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-177"><a href="#cb190-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a numeric identifying variable for each team</span></span>
<span id="cb190-178"><a href="#cb190-178" aria-hidden="true" tabindex="-1"></a>dfb_teamid <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-179"><a href="#cb190-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_id =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(team)))</span>
<span id="cb190-180"><a href="#cb190-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-181"><a href="#cb190-181" aria-hidden="true" tabindex="-1"></a><span class="co"># When a team is in the league, what is the probability that it wins the league</span></span>
<span id="cb190-182"><a href="#cb190-182" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb190-183"><a href="#cb190-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team_in_liga_count <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-184"><a href="#cb190-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob_win =</span> meister_count <span class="sc">/</span> appearances) <span class="sc">|&gt;</span></span>
<span id="cb190-185"><a href="#cb190-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prob_win <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-186"><a href="#cb190-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prob_win)) <span class="sc">|&gt;</span></span>
<span id="cb190-187"><a href="#cb190-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(meister_count, prob_win, team)</span>
<span id="cb190-188"><a href="#cb190-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-189"><a href="#cb190-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-190"><a href="#cb190-190" aria-hidden="true" tabindex="-1"></a><span class="co"># make a scatterplot with points on the y-axis and position on the x-axis</span></span>
<span id="cb190-191"><a href="#cb190-191" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> points)) <span class="sc">+</span></span>
<span id="cb190-192"><a href="#cb190-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb190-193"><a href="#cb190-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-194"><a href="#cb190-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a scatterplot with points on the y-axis and position on the x-axis.</span></span>
<span id="cb190-195"><a href="#cb190-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Additionally, only consider seasons with 18 teams and</span></span>
<span id="cb190-196"><a href="#cb190-196" aria-hidden="true" tabindex="-1"></a><span class="co"># add lines that make clear how many points you needed to be placed</span></span>
<span id="cb190-197"><a href="#cb190-197" aria-hidden="true" tabindex="-1"></a><span class="co"># in between rank 2 and 15.</span></span>
<span id="cb190-198"><a href="#cb190-198" aria-hidden="true" tabindex="-1"></a>dfb_18 <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-199"><a href="#cb190-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb190-200"><a href="#cb190-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">teams_in_league =</span> <span class="fu">n_distinct</span>(team)) <span class="sc">|&gt;</span></span>
<span id="cb190-201"><a href="#cb190-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(teams_in_league <span class="sc">==</span> <span class="dv">18</span>)</span>
<span id="cb190-202"><a href="#cb190-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-203"><a href="#cb190-203" aria-hidden="true" tabindex="-1"></a>h_1 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb190-204"><a href="#cb190-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(position <span class="sc">==</span> <span class="dv">16</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-205"><a href="#cb190-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ma =</span> <span class="fu">max</span>(points))</span>
<span id="cb190-206"><a href="#cb190-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-207"><a href="#cb190-207" aria-hidden="true" tabindex="-1"></a>max_points_rank_16 <span class="ot">&lt;-</span> <span class="fu">max</span>(h_1<span class="sc">$</span>ma) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb190-208"><a href="#cb190-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-209"><a href="#cb190-209" aria-hidden="true" tabindex="-1"></a>h_2 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb190-210"><a href="#cb190-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(position <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb190-211"><a href="#cb190-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mb =</span> <span class="fu">max</span>(points))</span>
<span id="cb190-212"><a href="#cb190-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-213"><a href="#cb190-213" aria-hidden="true" tabindex="-1"></a>min_points_rank_2 <span class="ot">&lt;-</span> <span class="fu">max</span>(h_2<span class="sc">$</span>mb) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb190-214"><a href="#cb190-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-215"><a href="#cb190-215" aria-hidden="true" tabindex="-1"></a>dfb_18 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb190-216"><a href="#cb190-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb190-217"><a href="#cb190-217" aria-hidden="true" tabindex="-1"></a>    season <span class="sc">&lt;</span> <span class="dv">1970</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb190-218"><a href="#cb190-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1970</span>, <span class="dv">1979</span>) <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb190-219"><a href="#cb190-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1980</span>, <span class="dv">1989</span>) <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb190-220"><a href="#cb190-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1990</span>, <span class="dv">1999</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb190-221"><a href="#cb190-221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">2000</span>, <span class="dv">2009</span>) <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb190-222"><a href="#cb190-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">2010</span>, <span class="dv">2019</span>) <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb190-223"><a href="#cb190-223" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">7</span> <span class="co"># Adjust this line based on the actual range of your data</span></span>
<span id="cb190-224"><a href="#cb190-224" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb190-225"><a href="#cb190-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-226"><a href="#cb190-226" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_18, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> points)) <span class="sc">+</span></span>
<span id="cb190-227"><a href="#cb190-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb190-228"><a href="#cb190-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb190-229"><a href="#cb190-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatterplot of Points and Position"</span>,</span>
<span id="cb190-230"><a href="#cb190-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Position"</span>,</span>
<span id="cb190-231"><a href="#cb190-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Points"</span></span>
<span id="cb190-232"><a href="#cb190-232" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb190-233"><a href="#cb190-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">15.5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb190-234"><a href="#cb190-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_points_rank_16, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb190-235"><a href="#cb190-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> min_points_rank_2, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb190-236"><a href="#cb190-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(min_points_rank_2, max_points_rank_16, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(dfb_18<span class="sc">$</span>points), <span class="at">by =</span> <span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb190-237"><a href="#cb190-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(dfb_18<span class="sc">$</span>points), <span class="at">by =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb190-238"><a href="#cb190-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb190-239"><a href="#cb190-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-240"><a href="#cb190-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-241"><a href="#cb190-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all objects except liga and dfb</span></span>
<span id="cb190-242"><a href="#cb190-242" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="fu">c</span>(<span class="st">"liga"</span>, <span class="st">"dfb"</span>)))</span>
<span id="cb190-243"><a href="#cb190-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-244"><a href="#cb190-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank "1. FC Kaiserslautern" over time</span></span>
<span id="cb190-245"><a href="#cb190-245" aria-hidden="true" tabindex="-1"></a>dfb_bal <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb190-246"><a href="#cb190-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(season, team, position) <span class="sc">|&gt;</span></span>
<span id="cb190-247"><a href="#cb190-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb190-248"><a href="#cb190-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(season, team)</span>
<span id="cb190-249"><a href="#cb190-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-250"><a href="#cb190-250" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dfb_bal<span class="sc">$</span>team)</span>
<span id="cb190-251"><a href="#cb190-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-252"><a href="#cb190-252" aria-hidden="true" tabindex="-1"></a>dfb_fck <span class="ot">&lt;-</span> dfb_bal <span class="sc">|&gt;</span></span>
<span id="cb190-253"><a href="#cb190-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team <span class="sc">==</span> <span class="st">"1. FC Kaiserslautern"</span>)</span>
<span id="cb190-254"><a href="#cb190-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-255"><a href="#cb190-255" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_fck, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb190-256"><a href="#cb190-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb190-257"><a href="#cb190-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb190-258"><a href="#cb190-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb190-259"><a href="#cb190-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-260"><a href="#cb190-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-261"><a href="#cb190-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-262"><a href="#cb190-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-263"><a href="#cb190-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot nice</span></span>
<span id="cb190-264"><a href="#cb190-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-265"><a href="#cb190-265" aria-hidden="true" tabindex="-1"></a><span class="co"># consider different rules for having to leave the league:</span></span>
<span id="cb190-266"><a href="#cb190-266" aria-hidden="true" tabindex="-1"></a>dfb_fck <span class="ot">&lt;-</span> dfb_fck <span class="sc">|&gt;</span></span>
<span id="cb190-267"><a href="#cb190-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&lt;=</span> <span class="dv">1964</span>, <span class="fl">14.5</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb190-268"><a href="#cb190-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1964</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1973</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-269"><a href="#cb190-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1973</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1980</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-270"><a href="#cb190-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1980</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1990</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-271"><a href="#cb190-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="dv">1991</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-272"><a href="#cb190-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1991</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">2008</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-273"><a href="#cb190-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">2008</span>, <span class="dv">16</span>, godown))</span>
<span id="cb190-274"><a href="#cb190-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-275"><a href="#cb190-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-276"><a href="#cb190-276" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_fck, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb190-277"><a href="#cb190-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb190-278"><a href="#cb190-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb190-279"><a href="#cb190-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb190-280"><a href="#cb190-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb190-281"><a href="#cb190-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb190-282"><a href="#cb190-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb190-283"><a href="#cb190-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb190-284"><a href="#cb190-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-285"><a href="#cb190-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-286"><a href="#cb190-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-287"><a href="#cb190-287" aria-hidden="true" tabindex="-1"></a>dfb_bal <span class="ot">&lt;-</span> dfb_bal <span class="sc">|&gt;</span></span>
<span id="cb190-288"><a href="#cb190-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&lt;=</span> <span class="dv">1964</span>, <span class="fl">14.5</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb190-289"><a href="#cb190-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1964</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1973</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-290"><a href="#cb190-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1973</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1980</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-291"><a href="#cb190-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1980</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1990</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-292"><a href="#cb190-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="dv">1991</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-293"><a href="#cb190-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1991</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">2008</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-294"><a href="#cb190-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">2008</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb190-295"><a href="#cb190-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inliga =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(position), <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb190-296"><a href="#cb190-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-297"><a href="#cb190-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-298"><a href="#cb190-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-299"><a href="#cb190-299" aria-hidden="true" tabindex="-1"></a>rank_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfb_bal, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb190-300"><a href="#cb190-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-301"><a href="#cb190-301" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(y = position)) +</span></span>
<span id="cb190-302"><a href="#cb190-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb190-303"><a href="#cb190-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb190-304"><a href="#cb190-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1963</span>, <span class="dv">2015</span>) <span class="sc">+</span></span>
<span id="cb190-305"><a href="#cb190-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb190-306"><a href="#cb190-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb190-307"><a href="#cb190-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>)</span>
<span id="cb190-308"><a href="#cb190-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-309"><a href="#cb190-309" aria-hidden="true" tabindex="-1"></a>rank_plot</span>
<span id="cb190-310"><a href="#cb190-310" aria-hidden="true" tabindex="-1"></a><span class="co"># !--&gt; in 1979 is a gap! Error?</span></span>
<span id="cb190-311"><a href="#cb190-311" aria-hidden="true" tabindex="-1"></a><span class="co"># No. Reason: two clubs shared the third place.</span></span>
<span id="cb190-312"><a href="#cb190-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-313"><a href="#cb190-313" aria-hidden="true" tabindex="-1"></a>rank_plot <span class="sc">+</span></span>
<span id="cb190-314"><a href="#cb190-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb190-315"><a href="#cb190-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-316"><a href="#cb190-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Create "test" directory if it doesn't already exist</span></span>
<span id="cb190-317"><a href="#cb190-317" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"test"</span>)) {</span>
<span id="cb190-318"><a href="#cb190-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"test"</span>)</span>
<span id="cb190-319"><a href="#cb190-319" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb190-320"><a href="#cb190-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-321"><a href="#cb190-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-322"><a href="#cb190-322" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb190-323"><a href="#cb190-323" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (club <span class="cf">in</span> <span class="fu">unique</span>(dfb_bal<span class="sc">$</span>team)) {</span>
<span id="cb190-324"><a href="#cb190-324" aria-hidden="true" tabindex="-1"></a>  dfb_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(dfb_bal, team <span class="sc">==</span> club)</span>
<span id="cb190-325"><a href="#cb190-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-326"><a href="#cb190-326" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfb_subset, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb190-327"><a href="#cb190-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb190-328"><a href="#cb190-328" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb190-329"><a href="#cb190-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb190-330"><a href="#cb190-330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb190-331"><a href="#cb190-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">1963</span>, <span class="dv">2015</span>) <span class="sc">+</span></span>
<span id="cb190-332"><a href="#cb190-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb190-333"><a href="#cb190-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb190-334"><a href="#cb190-334" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb190-335"><a href="#cb190-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Ranking History:"</span>, club))</span>
<span id="cb190-336"><a href="#cb190-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">paste</span>(<span class="st">"test/r_"</span>, club, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb190-337"><a href="#cb190-337" aria-hidden="true" tabindex="-1"></a>  plots[[club]] <span class="ot">&lt;-</span> p</span>
<span id="cb190-338"><a href="#cb190-338" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb190-339"><a href="#cb190-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-340"><a href="#cb190-340" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span><span class="st">`</span><span class="at">Meidericher SV</span><span class="st">`</span>)</span>
<span id="cb190-341"><a href="#cb190-341" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span><span class="st">`</span><span class="at">1. FC Koeln</span><span class="st">`</span>)</span>
<span id="cb190-342"><a href="#cb190-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-343"><a href="#cb190-343" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb190-344"><a href="#cb190-344" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(</span>
<span id="cb190-345"><a href="#cb190-345" aria-hidden="true" tabindex="-1"></a>  bundesligR,</span>
<span id="cb190-346"><a href="#cb190-346" aria-hidden="true" tabindex="-1"></a>  tidyverse</span>
<span id="cb190-347"><a href="#cb190-347" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb190-348"><a href="#cb190-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-349"><a href="#cb190-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the "test" directory and its contents after saving all graphs</span></span>
<span id="cb190-350"><a href="#cb190-350" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"test"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In dfb.R I analyze German soccer results</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/23-ws/dsda/scripts")</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear environment</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (Install and) load packagages</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>  bundesligR,</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>  tidyverse</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data as tibble</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>liga <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(bundesligR)</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a><span class="co"># !!! ERRORS / ISSUES:</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="co"># "Borussia Moenchengladbach" is also entitled "Bor. Moenchengladbach"!</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Leverkusen is falsly entitled "SV Bayer 04 Leverkusen"</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Uerdingen has changed its name several times</span></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Stuttgarter Kickers are named differently</span></span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a><span class="co"># How often is "Bor. Moenchengladbach" in the data?</span></span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(liga<span class="sc">$</span>Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the entries</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 12
  Season Position Team         Played     W     D     L    GF    GA    GD Points
   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1   1989       15 Bor. Moench…     34    11     8    15    37    45    -8     41
2   1976        1 Bor. Moench…     34    17    10     7    58    34    24     61
# ℹ 1 more variable: Pts_pre_95 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "Bor. Moenchengladbach" with "Borussia Moenchengladbach"</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>liga <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"Bor. Moenchengladbach"</span>,</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Borussia Moenchengladbach"</span>,</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"SV Bayer 04 Leverkusen"</span>,</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"TSV Bayer 04 Leverkusen"</span>,</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"FC Bayer 05 Uerdingen"</span> <span class="sc">|</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>    Team <span class="sc">==</span> <span class="st">"Bayer 05 Uerdingen"</span>,</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"KFC Uerdingen 05"</span>,</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>  Team</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Team =</span> <span class="fu">ifelse</span>(Team <span class="sc">==</span> <span class="st">"SV Stuttgarter Kickers"</span>,</span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Stuttgarter Kickers"</span>,</span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>    Team</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------</span></span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for the data class</span></span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(liga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view data</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(liga)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse on the data</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(liga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 952
Columns: 12
$ Season     &lt;dbl&gt; 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015,…
$ Position   &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …
$ Team       &lt;chr&gt; "FC Bayern Muenchen", "Borussia Dortmund", "Bayer 04 Leverk…
$ Played     &lt;dbl&gt; 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34,…
$ W          &lt;dbl&gt; 28, 24, 18, 17, 15, 14, 14, 12, 10, 11, 10, 9, 10, 9, 9, 9,…
$ D          &lt;dbl&gt; 4, 6, 6, 4, 7, 8, 8, 9, 13, 8, 10, 11, 8, 11, 10, 9, 6, 4, …
$ L          &lt;dbl&gt; 2, 4, 10, 13, 12, 12, 12, 13, 11, 15, 14, 14, 16, 14, 15, 1…
$ GF         &lt;dbl&gt; 80, 82, 56, 67, 51, 46, 42, 47, 38, 40, 33, 42, 50, 38, 39,…
$ GA         &lt;dbl&gt; 17, 34, 40, 50, 49, 42, 42, 49, 42, 46, 42, 52, 65, 53, 54,…
$ GD         &lt;dbl&gt; 63, 48, 16, 17, 2, 4, 0, -2, -4, -6, -9, -10, -15, -15, -15…
$ Points     &lt;dbl&gt; 88, 78, 60, 55, 52, 50, 50, 45, 43, 41, 40, 38, 38, 38, 37,…
$ Pts_pre_95 &lt;dbl&gt; 60, 54, 42, 38, 37, 36, 36, 33, 33, 30, 30, 29, 28, 29, 28,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first and last observations</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(liga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
  Season Position Team         Played     W     D     L    GF    GA    GD Points
   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1   2015        1 FC Bayern M…     34    28     4     2    80    17    63     88
2   2015        2 Borussia Do…     34    24     6     4    82    34    48     78
3   2015        3 Bayer 04 Le…     34    18     6    10    56    40    16     60
4   2015        4 Borussia Mo…     34    17     4    13    67    50    17     55
5   2015        5 FC Schalke …     34    15     7    12    51    49     2     52
6   2015        6 1. FSV Main…     34    14     8    12    46    42     4     50
# ℹ 1 more variable: Pts_pre_95 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(liga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
  Season Position Team         Played     W     D     L    GF    GA    GD Points
   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1   1963       11 Eintracht B…     30    11     6    13    36    49   -13     39
2   1963       12 1. FC Kaise…     30    10     6    14    48    69   -21     36
3   1963       13 Karlsruher …     30     8     8    14    42    55   -13     32
4   1963       14 Hertha BSC       30     9     6    15    45    65   -20     33
5   1963       15 Preussen Mu…     30     7     9    14    34    52   -18     30
6   1963       16 1. FC Saarb…     30     6     5    19    44    72   -28     23
# ℹ 1 more variable: Pts_pre_95 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(liga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Season        Position          Team               Played     
 Min.   :1963   Min.   : 1.000   Length:952         Min.   :30.00  
 1st Qu.:1976   1st Qu.: 5.000   Class :character   1st Qu.:34.00  
 Median :1989   Median : 9.000   Mode  :character   Median :34.00  
 Mean   :1989   Mean   : 9.486                      Mean   :33.95  
 3rd Qu.:2002   3rd Qu.:14.000                      3rd Qu.:34.00  
 Max.   :2015   Max.   :20.000                      Max.   :38.00  
       W               D                L               GF        
 Min.   : 2.00   Min.   : 2.000   Min.   : 1.00   Min.   : 15.00  
 1st Qu.: 9.75   1st Qu.: 7.000   1st Qu.:10.00   1st Qu.: 42.00  
 Median :12.00   Median : 9.000   Median :13.00   Median : 50.00  
 Mean   :12.61   Mean   : 8.733   Mean   :12.61   Mean   : 52.01  
 3rd Qu.:15.00   3rd Qu.:11.000   3rd Qu.:15.00   3rd Qu.: 61.00  
 Max.   :29.00   Max.   :18.000   Max.   :28.00   Max.   :101.00  
       GA             GD               Points        Pts_pre_95   
 Min.   :10.0   Min.   :-60.0000   Min.   :10.00   Min.   : 8.00  
 1st Qu.:43.0   1st Qu.:-13.0000   1st Qu.:38.00   1st Qu.:29.00  
 Median :51.0   Median : -2.0000   Median :44.00   Median :33.00  
 Mean   :51.7   Mean   :  0.3015   Mean   :46.56   Mean   :33.95  
 3rd Qu.:60.0   3rd Qu.: 13.0000   3rd Qu.:55.00   3rd Qu.:39.00  
 Max.   :93.0   Max.   : 80.0000   Max.   :91.00   Max.   :62.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many teams have played in the league over the years?</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 
  16   16   18   18   18   18   18   18   18   18   18   18   18   18   18   18 
1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 
  18   18   18   18   18   18   18   18   18   18   18   18   20   18   18   18 
1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 
  18   18   18   18   18   18   18   18   18   18   18   18   18   18   18   18 
2011 2012 2013 2014 2015 
  18   18   18   18   18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which teams have played Bundesliga</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(liga<span class="sc">$</span>Team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FC Bayern Muenchen"        "Borussia Dortmund"        
 [3] "Bayer 04 Leverkusen"       "Borussia Moenchengladbach"
 [5] "FC Schalke 04"             "1. FSV Mainz 05"          
 [7] "Hertha BSC"                "VfL Wolfsburg"            
 [9] "1. FC Koeln"               "Hamburger SV"             
[11] "FC Ingolstadt 04"          "FC Augsburg"              
[13] "Werder Bremen"             "SV Darmstadt 98"          
[15] "TSG 1899 Hoffenheim"       "Eintracht Frankfurt"      
[17] "VfB Stuttgart"             "Hannover 96"              
[19] "SC Freiburg"               "SC Paderborn 07"          
[21] "1. FC Nuernberg"           "Eintracht Braunschweig"   
[23] "Fortuna Duesseldorf"       "SpVgg Greuther Fuerth"    
[25] "1. FC Kaiserslautern"      "FC St. Pauli"             
[27] "VfL Bochum"                "Energie Cottbus"          
[29] "Karlsruher SC"             "Arminia Bielefeld"        
[31] "Hansa Rostock"             "MSV Duisburg"             
[33] "Alemannia Aachen"          "TSV 1860 Muenchen"        
[35] "SpVgg Unterhaching"        "SSV Ulm 1846"             
[37] "KFC Uerdingen 05"          "Dynamo Dresden"           
[39] "SG Wattenscheid 09"        "VfB Leipzig"              
[41] "1. FC Saarbruecken"        "TSV Bayer 04 Leverkusen"  
[43] "SV Werder Bremen"          "1. FC Dynamo Dresden"     
[45] "Stuttgarter Kickers"       "FC Hansa Rostock"         
[47] "SV Waldhof Mannheim"       "FC 08 Homburg"            
[49] "FC Homburg"                "Blau-Weiss 90 Berlin"     
[51] "Kickers Offenbach"         "Tennis Borussia Berlin"   
[53] "Rot-Weiss Essen"           "Wuppertaler SV"           
[55] "SC Fortuna Koeln"          "Rot-Weiss Oberhausen"     
[57] "SC Rot-Weiss Oberhausen"   "Borussia Neunkirchen"     
[59] "Meidericher SV"            "SC Tasmania 1900 Berlin"  
[61] "Preussen Muenster"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many teams have played Bundesliga</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(liga<span class="sc">$</span>Team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How often has each team played in the Bundesliga</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     1. FC Dynamo Dresden      1. FC Kaiserslautern               1. FC Koeln 
                        1                        44                        45 
          1. FC Nuernberg        1. FC Saarbruecken           1. FSV Mainz 05 
                       32                         5                        10 
         Alemannia Aachen         Arminia Bielefeld       Bayer 04 Leverkusen 
                        4                        17                        30 
     Blau-Weiss 90 Berlin         Borussia Dortmund Borussia Moenchengladbach 
                        1                        49                        48 
     Borussia Neunkirchen            Dynamo Dresden    Eintracht Braunschweig 
                        3                         3                        21 
      Eintracht Frankfurt           Energie Cottbus             FC 08 Homburg 
                       47                         6                         2 
              FC Augsburg        FC Bayern Muenchen          FC Hansa Rostock 
                        5                        51                         1 
               FC Homburg          FC Ingolstadt 04             FC Schalke 04 
                        1                         1                        48 
             FC St. Pauli       Fortuna Duesseldorf              Hamburger SV 
                        8                        23                        53 
              Hannover 96             Hansa Rostock                Hertha BSC 
                       28                        11                        33 
            Karlsruher SC          KFC Uerdingen 05         Kickers Offenbach 
                       24                        14                         7 
           Meidericher SV              MSV Duisburg         Preussen Muenster 
                        3                        25                         1 
          Rot-Weiss Essen      Rot-Weiss Oberhausen          SC Fortuna Koeln 
                        7                         3                         1 
              SC Freiburg           SC Paderborn 07   SC Rot-Weiss Oberhausen 
                       16                         1                         1 
  SC Tasmania 1900 Berlin        SG Wattenscheid 09     SpVgg Greuther Fuerth 
                        1                         4                         1 
       SpVgg Unterhaching              SSV Ulm 1846       Stuttgarter Kickers 
                        2                         1                         2 
          SV Darmstadt 98       SV Waldhof Mannheim          SV Werder Bremen 
                        3                         7                         1 
   Tennis Borussia Berlin       TSG 1899 Hoffenheim         TSV 1860 Muenchen 
                        2                         8                        20 
  TSV Bayer 04 Leverkusen               VfB Leipzig             VfB Stuttgart 
                        7                         1                        51 
               VfL Bochum             VfL Wolfsburg             Werder Bremen 
                       34                        19                        51 
           Wuppertaler SV 
                        3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of variable Season only</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(liga<span class="sc">$</span>Season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1963    1976    1989    1989    2002    2015 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of numeric of variables (Team is a character)</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Season, Position, Played, W, D, L, GF, GA, GD, Points, Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Season        Position          Played            W        
 Min.   :1963   Min.   : 1.000   Min.   :30.00   Min.   : 2.00  
 1st Qu.:1976   1st Qu.: 5.000   1st Qu.:34.00   1st Qu.: 9.75  
 Median :1989   Median : 9.000   Median :34.00   Median :12.00  
 Mean   :1989   Mean   : 9.486   Mean   :33.95   Mean   :12.61  
 3rd Qu.:2002   3rd Qu.:14.000   3rd Qu.:34.00   3rd Qu.:15.00  
 Max.   :2015   Max.   :20.000   Max.   :38.00   Max.   :29.00  
       D                L               GF               GA      
 Min.   : 2.000   Min.   : 1.00   Min.   : 15.00   Min.   :10.0  
 1st Qu.: 7.000   1st Qu.:10.00   1st Qu.: 42.00   1st Qu.:43.0  
 Median : 9.000   Median :13.00   Median : 50.00   Median :51.0  
 Mean   : 8.733   Mean   :12.61   Mean   : 52.01   Mean   :51.7  
 3rd Qu.:11.000   3rd Qu.:15.00   3rd Qu.: 61.00   3rd Qu.:60.0  
 Max.   :18.000   Max.   :28.00   Max.   :101.00   Max.   :93.0  
       GD               Points        Pts_pre_95   
 Min.   :-60.0000   Min.   :10.00   Min.   : 8.00  
 1st Qu.:-13.0000   1st Qu.:38.00   1st Qu.:29.00  
 Median : -2.0000   Median :44.00   Median :33.00  
 Mean   :  0.3015   Mean   :46.56   Mean   :33.95  
 3rd Qu.: 13.0000   3rd Qu.:55.00   3rd Qu.:39.00  
 Max.   : 80.0000   Max.   :91.00   Max.   :62.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shorter alternative</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Season, Position, Played<span class="sc">:</span>Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Season        Position          Played            W        
 Min.   :1963   Min.   : 1.000   Min.   :30.00   Min.   : 2.00  
 1st Qu.:1976   1st Qu.: 5.000   1st Qu.:34.00   1st Qu.: 9.75  
 Median :1989   Median : 9.000   Median :34.00   Median :12.00  
 Mean   :1989   Mean   : 9.486   Mean   :33.95   Mean   :12.61  
 3rd Qu.:2002   3rd Qu.:14.000   3rd Qu.:34.00   3rd Qu.:15.00  
 Max.   :2015   Max.   :20.000   Max.   :38.00   Max.   :29.00  
       D                L               GF               GA      
 Min.   : 2.000   Min.   : 1.00   Min.   : 15.00   Min.   :10.0  
 1st Qu.: 7.000   1st Qu.:10.00   1st Qu.: 42.00   1st Qu.:43.0  
 Median : 9.000   Median :13.00   Median : 50.00   Median :51.0  
 Mean   : 8.733   Mean   :12.61   Mean   : 52.01   Mean   :51.7  
 3rd Qu.:11.000   3rd Qu.:15.00   3rd Qu.: 61.00   3rd Qu.:60.0  
 Max.   :18.000   Max.   :28.00   Max.   :101.00   Max.   :93.0  
       GD               Points        Pts_pre_95   
 Min.   :-60.0000   Min.   :10.00   Min.   : 8.00  
 1st Qu.:-13.0000   1st Qu.:38.00   1st Qu.:29.00  
 Median : -2.0000   Median :44.00   Median :33.00  
 Mean   :  0.3015   Mean   :46.56   Mean   :33.95  
 3rd Qu.: 13.0000   3rd Qu.:55.00   3rd Qu.:39.00  
 Max.   : 80.0000   Max.   :91.00   Max.   :62.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shortest alternative</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Team) <span class="sc">|&gt;</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Season <span class="sc">==</span> <span class="dv">1999</span> <span class="sc">|</span> Season <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">|&gt;</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Season        Position        Played         W               D         
 Min.   :1999   Min.   : 1.0   Min.   :34   Min.   : 4.00   Min.   : 3.000  
 1st Qu.:1999   1st Qu.: 5.0   1st Qu.:34   1st Qu.: 9.75   1st Qu.: 6.000  
 Median :2004   Median : 9.5   Median :34   Median :12.00   Median : 8.000  
 Mean   :2004   Mean   : 9.5   Mean   :34   Mean   :12.83   Mean   : 8.333  
 3rd Qu.:2010   3rd Qu.:14.0   3rd Qu.:34   3rd Qu.:14.25   3rd Qu.:10.250  
 Max.   :2010   Max.   :18.0   Max.   :34   Max.   :23.00   Max.   :15.000  
       L               GF              GA              GD        
 Min.   : 3.00   Min.   :31.00   Min.   :22.00   Min.   :-34.00  
 1st Qu.:10.75   1st Qu.:41.00   1st Qu.:44.00   1st Qu.:-10.25  
 Median :13.00   Median :47.00   Median :48.50   Median : -3.00  
 Mean   :12.83   Mean   :49.42   Mean   :49.42   Mean   :  0.00  
 3rd Qu.:16.00   3rd Qu.:54.25   3rd Qu.:59.00   3rd Qu.:  4.75  
 Max.   :21.00   Max.   :81.00   Max.   :71.00   Max.   : 45.00  
     Points        Pts_pre_95   
 Min.   :22.00   Min.   :18.00  
 1st Qu.:39.75   1st Qu.:29.75  
 Median :44.00   Median :32.00  
 Mean   :46.83   Mean   :34.00  
 3rd Qu.:50.75   3rd Qu.:37.50  
 Max.   :75.00   Max.   :52.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most points ever received by a team</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Points <span class="sc">==</span> <span class="fu">max</span>(Points))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  Season Position Team         Played     W     D     L    GF    GA    GD Points
   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1   2012        1 FC Bayern M…     34    29     4     1    98    18    80     91
# ℹ 1 more variable: Pts_pre_95 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show only the team name</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>liga <span class="sc">|&gt;</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Points <span class="sc">==</span> <span class="fu">max</span>(Points)) <span class="sc">|&gt;</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Team) <span class="sc">|&gt;</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Team              
  &lt;chr&gt;             
1 FC Bayern Muenchen</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the variable `Pts_pre_95` from the data</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>liga_post95 <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Pts_pre_95)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rename W, D, and L to Win, Draw, and Loss</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally rename GF, GA, GD to Goals_shot, Goals_received, Goal_difference</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>liga_longnames <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Win =</span> W, <span class="at">Draw =</span> D, <span class="at">Loss =</span> L) <span class="sc">|&gt;</span></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Goals_shot =</span> GF, <span class="at">Goals_received =</span> GA, <span class="at">Goal_difference =</span> GD)</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the variable `Pts_pre_95` from `liga`</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally remove all observations before the year 1996</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>liga_no3point <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Pts_pre_95) <span class="sc">|&gt;</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Season <span class="sc">&gt;=</span> <span class="dv">1996</span>)</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the objects liga_post95, liga_longnames, and liga_no3point from the environment</span></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(liga_post95, liga_longnames, liga_no3point)</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename all variables of `liga`to lower cases and store it as `dfb`</span></span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> liga <span class="sc">|&gt;</span></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_all</span>(tolower)</span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the winner and the runner up after 2010</span></span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a><span class="co"># additionally show the points</span></span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season <span class="sc">&gt;</span> <span class="dv">2010</span>) <span class="sc">|&gt;</span></span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(points)) <span class="sc">|&gt;</span></span>
<span id="cb225-30"><a href="#cb225-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb225-31"><a href="#cb225-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(team, points, position)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   season [5]
   season team               points position
    &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1   2011 Borussia Dortmund      81        1
 2   2011 FC Bayern Muenchen     73        2
 3   2012 FC Bayern Muenchen     91        1
 4   2012 Borussia Dortmund      66        2
 5   2013 FC Bayern Muenchen     90        1
 6   2013 Borussia Dortmund      71        2
 7   2014 FC Bayern Muenchen     79        1
 8   2014 VfL Wolfsburg          69        2
 9   2015 FC Bayern Muenchen     88        1
10   2015 Borussia Dortmund      78        2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable that counts how often a team was ranked first</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meister_count =</span> <span class="fu">sum</span>(position <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="co"># How often has each team played in the Bundesliga</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(liga<span class="sc">$</span>Team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     1. FC Dynamo Dresden      1. FC Kaiserslautern               1. FC Koeln 
                        1                        44                        45 
          1. FC Nuernberg        1. FC Saarbruecken           1. FSV Mainz 05 
                       32                         5                        10 
         Alemannia Aachen         Arminia Bielefeld       Bayer 04 Leverkusen 
                        4                        17                        30 
     Blau-Weiss 90 Berlin         Borussia Dortmund Borussia Moenchengladbach 
                        1                        49                        48 
     Borussia Neunkirchen            Dynamo Dresden    Eintracht Braunschweig 
                        3                         3                        21 
      Eintracht Frankfurt           Energie Cottbus             FC 08 Homburg 
                       47                         6                         2 
              FC Augsburg        FC Bayern Muenchen          FC Hansa Rostock 
                        5                        51                         1 
               FC Homburg          FC Ingolstadt 04             FC Schalke 04 
                        1                         1                        48 
             FC St. Pauli       Fortuna Duesseldorf              Hamburger SV 
                        8                        23                        53 
              Hannover 96             Hansa Rostock                Hertha BSC 
                       28                        11                        33 
            Karlsruher SC          KFC Uerdingen 05         Kickers Offenbach 
                       24                        14                         7 
           Meidericher SV              MSV Duisburg         Preussen Muenster 
                        3                        25                         1 
          Rot-Weiss Essen      Rot-Weiss Oberhausen          SC Fortuna Koeln 
                        7                         3                         1 
              SC Freiburg           SC Paderborn 07   SC Rot-Weiss Oberhausen 
                       16                         1                         1 
  SC Tasmania 1900 Berlin        SG Wattenscheid 09     SpVgg Greuther Fuerth 
                        1                         4                         1 
       SpVgg Unterhaching              SSV Ulm 1846       Stuttgarter Kickers 
                        2                         1                         2 
          SV Darmstadt 98       SV Waldhof Mannheim          SV Werder Bremen 
                        3                         7                         1 
   Tennis Borussia Berlin       TSG 1899 Hoffenheim         TSV 1860 Muenchen 
                        2                         8                        20 
  TSV Bayer 04 Leverkusen               VfB Leipzig             VfB Stuttgart 
                        7                         1                        51 
               VfL Bochum             VfL Wolfsburg             Werder Bremen 
                       34                        19                        51 
           Wuppertaler SV 
                        3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a ranking</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">appearances =</span> <span class="fu">n_distinct</span>(season)) <span class="sc">|&gt;</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(appearances)) <span class="sc">|&gt;</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 61 × 2
   team                      appearances
   &lt;chr&gt;                           &lt;int&gt;
 1 Hamburger SV                       53
 2 FC Bayern Muenchen                 51
 3 VfB Stuttgart                      51
 4 Werder Bremen                      51
 5 Borussia Dortmund                  49
 6 Borussia Moenchengladbach          48
 7 FC Schalke 04                      48
 8 Eintracht Frankfurt                47
 9 1. FC Koeln                        45
10 1. FC Kaiserslautern               44
11 VfL Bochum                         34
12 Hertha BSC                         33
13 1. FC Nuernberg                    32
14 Bayer 04 Leverkusen                30
15 Hannover 96                        28
16 MSV Duisburg                       25
17 Karlsruher SC                      24
18 Fortuna Duesseldorf                23
19 Eintracht Braunschweig             21
20 TSV 1860 Muenchen                  20
21 VfL Wolfsburg                      19
22 Arminia Bielefeld                  17
23 SC Freiburg                        16
24 KFC Uerdingen 05                   14
25 Hansa Rostock                      11
26 1. FSV Mainz 05                    10
27 FC St. Pauli                        8
28 TSG 1899 Hoffenheim                 8
29 Kickers Offenbach                   7
30 Rot-Weiss Essen                     7
31 SV Waldhof Mannheim                 7
32 TSV Bayer 04 Leverkusen             7
33 Energie Cottbus                     6
34 1. FC Saarbruecken                  5
35 FC Augsburg                         5
36 Alemannia Aachen                    4
37 SG Wattenscheid 09                  4
38 Borussia Neunkirchen                3
39 Dynamo Dresden                      3
40 Meidericher SV                      3
41 Rot-Weiss Oberhausen                3
42 SV Darmstadt 98                     3
43 Wuppertaler SV                      3
44 FC 08 Homburg                       2
45 SpVgg Unterhaching                  2
46 Stuttgarter Kickers                 2
47 Tennis Borussia Berlin              2
48 1. FC Dynamo Dresden                1
49 Blau-Weiss 90 Berlin                1
50 FC Hansa Rostock                    1
51 FC Homburg                          1
52 FC Ingolstadt 04                    1
53 Preussen Muenster                   1
54 SC Fortuna Koeln                    1
55 SC Paderborn 07                     1
56 SC Rot-Weiss Oberhausen             1
57 SC Tasmania 1900 Berlin             1
58 SSV Ulm 1846                        1
59 SV Werder Bremen                    1
60 SpVgg Greuther Fuerth               1
61 VfB Leipzig                         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a variable to `dfb` that contains the number of appearances of a team in the league</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">appearances =</span> <span class="fu">n_distinct</span>(season))</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a number that indicates how often a team has played Bundesliga in a given year</span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(team, season) <span class="sc">|&gt;</span></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">|&gt;</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_in_liga_count =</span> <span class="fu">row_number</span>())</span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a ranking with the number of titles of all teams that ever won the league</span></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team_in_liga_count <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(meister_count <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meister_count)) <span class="sc">|&gt;</span></span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(meister_count, team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
# Groups:   team [12]
   meister_count team                     
           &lt;int&gt; &lt;chr&gt;                    
 1            25 FC Bayern Muenchen       
 2             5 Borussia Dortmund        
 3             5 Borussia Moenchengladbach
 4             4 Werder Bremen            
 5             3 Hamburger SV             
 6             3 VfB Stuttgart            
 7             2 1. FC Kaiserslautern     
 8             2 1. FC Koeln              
 9             1 1. FC Nuernberg          
10             1 Eintracht Braunschweig   
11             1 TSV 1860 Muenchen        
12             1 VfL Wolfsburg            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a numeric identifying variable for each team</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>dfb_teamid <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_id =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(team)))</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="co"># When a team is in the league, what is the probability that it wins the league</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>dfb <span class="sc">|&gt;</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team_in_liga_count <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob_win =</span> meister_count <span class="sc">/</span> appearances) <span class="sc">|&gt;</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(prob_win <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prob_win)) <span class="sc">|&gt;</span></span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(meister_count, prob_win, team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
# Groups:   team [12]
   meister_count prob_win team                     
           &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;                    
 1            25   0.490  FC Bayern Muenchen       
 2             5   0.104  Borussia Moenchengladbach
 3             5   0.102  Borussia Dortmund        
 4             4   0.0784 Werder Bremen            
 5             3   0.0588 VfB Stuttgart            
 6             3   0.0566 Hamburger SV             
 7             1   0.0526 VfL Wolfsburg            
 8             1   0.05   TSV 1860 Muenchen        
 9             1   0.0476 Eintracht Braunschweig   
10             2   0.0455 1. FC Kaiserslautern     
11             2   0.0444 1. FC Koeln              
12             1   0.0312 1. FC Nuernberg          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a scatterplot with points on the y-axis and position on the x-axis</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> points)) <span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="80_exercises_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a scatterplot with points on the y-axis and position on the x-axis.</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Additionally, only consider seasons with 18 teams and</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add lines that make clear how many points you needed to be placed</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co"># in between rank 2 and 15.</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>dfb_18 <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season) <span class="sc">|&gt;</span></span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">teams_in_league =</span> <span class="fu">n_distinct</span>(team)) <span class="sc">|&gt;</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(teams_in_league <span class="sc">==</span> <span class="dv">18</span>)</span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>h_1 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(position <span class="sc">==</span> <span class="dv">16</span>) <span class="sc">|&gt;</span></span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ma =</span> <span class="fu">max</span>(points))</span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>max_points_rank_16 <span class="ot">&lt;-</span> <span class="fu">max</span>(h_1<span class="sc">$</span>ma) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a>h_2 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(position <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mb =</span> <span class="fu">max</span>(points))</span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a>min_points_rank_2 <span class="ot">&lt;-</span> <span class="fu">max</span>(h_2<span class="sc">$</span>mb) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a>dfb_18 <span class="ot">&lt;-</span> dfb_18 <span class="sc">|&gt;</span></span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a>    season <span class="sc">&lt;</span> <span class="dv">1970</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb236-25"><a href="#cb236-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1970</span>, <span class="dv">1979</span>) <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb236-26"><a href="#cb236-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1980</span>, <span class="dv">1989</span>) <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb236-27"><a href="#cb236-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">1990</span>, <span class="dv">1999</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb236-28"><a href="#cb236-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">2000</span>, <span class="dv">2009</span>) <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb236-29"><a href="#cb236-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(season, <span class="dv">2010</span>, <span class="dv">2019</span>) <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb236-30"><a href="#cb236-30" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">7</span> <span class="co"># Adjust this line based on the actual range of your data</span></span>
<span id="cb236-31"><a href="#cb236-31" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb236-32"><a href="#cb236-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-33"><a href="#cb236-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_18, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> points)) <span class="sc">+</span></span>
<span id="cb236-34"><a href="#cb236-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb236-35"><a href="#cb236-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb236-36"><a href="#cb236-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatterplot of Points and Position"</span>,</span>
<span id="cb236-37"><a href="#cb236-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Position"</span>,</span>
<span id="cb236-38"><a href="#cb236-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Points"</span></span>
<span id="cb236-39"><a href="#cb236-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb236-40"><a href="#cb236-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">15.5</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb236-41"><a href="#cb236-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> max_points_rank_16, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb236-42"><a href="#cb236-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> min_points_rank_2, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb236-43"><a href="#cb236-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(min_points_rank_2, max_points_rank_16, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(dfb_18<span class="sc">$</span>points), <span class="at">by =</span> <span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb236-44"><a href="#cb236-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(dfb_18<span class="sc">$</span>points), <span class="at">by =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb236-45"><a href="#cb236-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="80_exercises_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all objects except liga and dfb</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="fu">c</span>(<span class="st">"liga"</span>, <span class="st">"dfb"</span>)))</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank "1. FC Kaiserslautern" over time</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>dfb_bal <span class="ot">&lt;-</span> dfb <span class="sc">|&gt;</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(season, team, position) <span class="sc">|&gt;</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(season, team)</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dfb_bal<span class="sc">$</span>team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     1. FC Dynamo Dresden      1. FC Kaiserslautern               1. FC Koeln 
                       53                        53                        53 
          1. FC Nuernberg        1. FC Saarbruecken           1. FSV Mainz 05 
                       53                        53                        53 
         Alemannia Aachen         Arminia Bielefeld       Bayer 04 Leverkusen 
                       53                        53                        53 
     Blau-Weiss 90 Berlin         Borussia Dortmund Borussia Moenchengladbach 
                       53                        53                        53 
     Borussia Neunkirchen            Dynamo Dresden    Eintracht Braunschweig 
                       53                        53                        53 
      Eintracht Frankfurt           Energie Cottbus             FC 08 Homburg 
                       53                        53                        53 
              FC Augsburg        FC Bayern Muenchen          FC Hansa Rostock 
                       53                        53                        53 
               FC Homburg          FC Ingolstadt 04             FC Schalke 04 
                       53                        53                        53 
             FC St. Pauli       Fortuna Duesseldorf              Hamburger SV 
                       53                        53                        53 
              Hannover 96             Hansa Rostock                Hertha BSC 
                       53                        53                        53 
            Karlsruher SC          KFC Uerdingen 05         Kickers Offenbach 
                       53                        53                        53 
           Meidericher SV              MSV Duisburg         Preussen Muenster 
                       53                        53                        53 
          Rot-Weiss Essen      Rot-Weiss Oberhausen          SC Fortuna Koeln 
                       53                        53                        53 
              SC Freiburg           SC Paderborn 07   SC Rot-Weiss Oberhausen 
                       53                        53                        53 
  SC Tasmania 1900 Berlin        SG Wattenscheid 09     SpVgg Greuther Fuerth 
                       53                        53                        53 
       SpVgg Unterhaching              SSV Ulm 1846       Stuttgarter Kickers 
                       53                        53                        53 
          SV Darmstadt 98       SV Waldhof Mannheim          SV Werder Bremen 
                       53                        53                        53 
   Tennis Borussia Berlin       TSG 1899 Hoffenheim         TSV 1860 Muenchen 
                       53                        53                        53 
  TSV Bayer 04 Leverkusen               VfB Leipzig             VfB Stuttgart 
                       53                        53                        53 
               VfL Bochum             VfL Wolfsburg             Werder Bremen 
                       53                        53                        53 
           Wuppertaler SV 
                       53 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>dfb_fck <span class="ot">&lt;-</span> dfb_bal <span class="sc">|&gt;</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team <span class="sc">==</span> <span class="st">"1. FC Kaiserslautern"</span>)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_fck, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="80_exercises_files/figure-html/unnamed-chunk-66-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the plot nice</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># consider different rules for having to leave the league:</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>dfb_fck <span class="ot">&lt;-</span> dfb_fck <span class="sc">|&gt;</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&lt;=</span> <span class="dv">1964</span>, <span class="fl">14.5</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1964</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1973</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1973</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1980</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1980</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1990</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="dv">1991</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1991</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">2008</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">2008</span>, <span class="dv">16</span>, godown))</span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfb_fck, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb240-21"><a href="#cb240-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="80_exercises_files/figure-html/unnamed-chunk-66-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>dfb_bal <span class="ot">&lt;-</span> dfb_bal <span class="sc">|&gt;</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&lt;=</span> <span class="dv">1964</span>, <span class="fl">14.5</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1964</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1973</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1973</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1980</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1980</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">1990</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="dv">1991</span>, <span class="fl">16.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">1991</span> <span class="sc">&amp;</span> season <span class="sc">&lt;=</span> <span class="dv">2008</span>, <span class="fl">15.5</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">godown =</span> <span class="fu">ifelse</span>(season <span class="sc">&gt;</span> <span class="dv">2008</span>, <span class="dv">16</span>, godown)) <span class="sc">|&gt;</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inliga =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(position), <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a>rank_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfb_bal, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(aes(y = position)) +</span></span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1963</span>, <span class="dv">2015</span>) <span class="sc">+</span></span>
<span id="cb241-19"><a href="#cb241-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb241-20"><a href="#cb241-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb241-21"><a href="#cb241-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>)</span>
<span id="cb241-22"><a href="#cb241-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-23"><a href="#cb241-23" aria-hidden="true" tabindex="-1"></a>rank_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="80_exercises_files/figure-html/unnamed-chunk-66-5.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !--&gt; in 1979 is a gap! Error?</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="co"># No. Reason: two clubs shared the third place.</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>rank_plot <span class="sc">+</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="80_exercises_files/figure-html/unnamed-chunk-66-6.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create "test" directory if it doesn't already exist</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"test"</span>)) {</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="st">"test"</span>)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (club <span class="cf">in</span> <span class="fu">unique</span>(dfb_bal<span class="sc">$</span>team)) {</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>  dfb_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(dfb_bal, team <span class="sc">==</span> club)</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dfb_subset, <span class="fu">aes</span>(<span class="at">x =</span> season)) <span class="sc">+</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> position)) <span class="sc">+</span></span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> godown), <span class="at">shape =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">1963</span>, <span class="dv">2015</span>) <span class="sc">+</span></span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> position), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Ranking History:"</span>, club))</span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">paste</span>(<span class="st">"test/r_"</span>, club, <span class="st">".png"</span>, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a>  plots[[club]] <span class="ot">&lt;-</span> p</span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span><span class="st">`</span><span class="at">Meidericher SV</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="80_exercises_files/figure-html/unnamed-chunk-66-7.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plots<span class="sc">$</span><span class="st">`</span><span class="at">1. FC Koeln</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-66-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="80_exercises_files/figure-html/unnamed-chunk-66-8.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  bundesligR,</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  tidyverse</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the "test" directory and its contents after saving all graphs</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">"test"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="okuns-law" class="level2" data-number="9.14">
<h2 data-number="9.14" class="anchored" data-anchor-id="okuns-law"><span class="header-section-number">9.14</span> Okun’s Law</h2>
<p><em>Suppose you aim to empirically examine unemployment and GDP for Germany and France. The data set that we use in the following is ‘forest.Rdata’ and should already been known to you from the lecture.</em></p>
<ol start="0" type="1">
<li><p>Write down your name, matriculation number, and date.</p></li>
<li><p>Set your working directory.</p></li>
</ol>
<ol start="2" type="1">
<li>Clear your global environment.</li>
</ol>
<ol start="3" type="1">
<li>Install and load the following packages: ‘tidyverse’, ‘sjPlot’, and ‘ggpubr’</li>
</ol>
<ol start="4" type="1">
<li>Download and load the data, respectively, with the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If that is not working, you can also download the data from ILIAS, save it in your working directory and load it from there with:</p>
<pre><code>load("forest.Rdata")</code></pre>
<ol start="5" type="1">
<li><p>Show the <strong>first eight</strong> observations of the dataset <code>df</code>.</p></li>
<li><p>Show the <strong>last observation</strong> of the dataset <code>df</code>.</p></li>
<li><p>Which type of data do we have here (Panel, cross-section,time series, …)? Name the variable(s) that are necessary to identify the observations in the dataset.</p></li>
<li><p>Explain what the <strong>assignment operator</strong> in R is and what it is good for.</p></li>
<li><p>Write down the R code to store the number of observations and the number of variables that are in the dataset <code>df</code>. Name the object in which you store these numbers <code>observations_df</code>.</p></li>
<li><p>In the dataset <code>df</code>, rename the variable ‘country.x’ to ‘nation’ and the variable ‘date’ to ‘year’.</p></li>
<li><p>Explain what the <strong>pipe operator</strong> in R is and what it is good for.</p></li>
<li><p>For the upcoming analysis you are only interested the following <strong>variables</strong> that are part of the dataframe <code>df</code>: nation, year, gdp, pop, gdppc, and unemployment. Drop all other variables from the dataframe <code>df</code>.</p></li>
<li><p>Create a variable that indicates the GDP per capita (‘gdp’ divided by ‘pop’). Name the variable ‘gdp_pc’. (Hint: If you fail here, use the variable ‘gdppc’ which is already in the dataset as a replacement for ‘gdp_pc’ in the following tasks.)</p></li>
<li><p>For the upcoming analysis you are only interested the following <strong>countries</strong> that are part of the dataframe <code>df</code>: Germany and France. Drop all other countries from the dataframe <code>df</code>.</p></li>
<li><p>Create a table showing the <strong>average</strong> unemployment rate and GDP per capita for Germany and France in the given years. Use the pipe operator. (Hint: See below for how your results should look like.)</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  9.75        34356.
2 Germany                 7.22        36739.</code></pre>
</div>
</div>
<ol start="16" type="1">
<li>Create a table showing the unemployment rate and GDP per capita for Germany and France in the <strong>year 2020</strong>. Use the pipe operator. (Hint: See below for how your results should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  8.01        35786.
2 Germany                 3.81        41315.</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Create a table showing the <strong>highest</strong> unemployment rate and the <strong>highest</strong> GDP per capita for Germany and France during the given period. Use the pipe operator. (Hint: See below for how your results should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `max(unemployment)` `max(gdppc)`
  &lt;chr&gt;                 &lt;dbl&gt;        &lt;dbl&gt;
1 France                 12.6       38912.
2 Germany                11.2       43329.</code></pre>
</div>
</div>
<ol start="18" type="1">
<li>Calculate the standard deviation of the unemployment rate and GDP per capita for Germany and France in the given years. (Hint: See below for how your result should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `sd(gdppc)` `sd(unemployment)`
  &lt;chr&gt;         &lt;dbl&gt;              &lt;dbl&gt;
1 France        2940.               1.58
2 Germany       4015.               2.37</code></pre>
</div>
</div>
<ol start="19" type="1">
<li>In statistics, the coefficient of variation (COV) is a standardized measure of dispersion. It is defined as the ratio of the standard deviation (<span class="math inline">\(\sigma\)</span>) to the mean (<span class="math inline">\(\mu\)</span>): <span class="math inline">\(COV={\frac {\sigma }{\mu }}\)</span>. Write down the R code to calculate the coefficient of variation (COV) for the <strong>unemployment rate</strong> in Germany and France. (Hint: See below for what your result should should look like.)</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(unemployment)` `mean(unemployment)`   cov
  &lt;chr&gt;                &lt;dbl&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 France                1.58                 9.75 0.162
2 Germany               2.37                 7.22 0.328</code></pre>
</div>
</div>
<ol start="20" type="1">
<li>Write down the R code to calculate the coefficient of variation (COV) for the <strong>GDP per capita</strong> in Germany and France. (Hint: See below for what your result should should look like.)</li>
</ol>
<p>look like.)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(gdppc)` `mean(gdppc)`    cov
  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 France        2940.        34356. 0.0856
2 Germany       4015.        36739. 0.109 </code></pre>
</div>
</div>
<ol start="21" type="1">
<li>Create a chart (bar chart, line chart, or scatter plot) that shows the unemployment rate of <strong>Germany</strong> over the available years. Label the chart ‘Germany’ with <code>ggtitle("Germany")</code>. Please note that you may choose any type of graphical representation. (Hint: Below you can see one of many possible examples of what your result may look like).</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-85-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="80_exercises_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="22" type="1">
<li>and 23. <em>(This task is worth 10 points)</em> The following chart shows the simultaneous development of the unemployment rate and GDP per capita over time for <strong>France</strong>.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-86-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="80_exercises_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Suppose you want to visualize the simultaneous evolution of the unemployment rate and GDP per capita over time for Germany as well.<br>
Suppose further that you have found the following lines of code that create the kind of chart you are looking for.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-87-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="80_exercises_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Use these lines of code and customize them to create the co-movement visualization for <strong>Germany</strong> using the available <code>df</code> data. The result should look something like this:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-88-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="80_exercises_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="24" type="1">
<li>Interpret the two graphs above, which show the simultaneous evolution of the unemployment rate and GDP per capita over time for Germany and France. What are your expectations regarding the correlation between the unemployment rate and GDP per capita variables? Can you see this expectation in the figures? Discuss.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>c</code>, <code>dim</code>, <code>filter</code>, <code>geom_line</code>, <code>ggplot</code>, <code>ggtitle</code>, <code>group_by</code>, <code>head</code>, <code>load</code>, <code>max</code>, <code>mean</code>, <code>mutate</code>, <code>plot</code>, <code>rename</code>, <code>sd</code>, <code>select</code>, <code>summarise</code>, <code>tail</code>, <code>text</code>, <code>title</code>, <code>url</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/exams/22-11/scr/")</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, ggpubr, sjPlot)</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">8</span>)</span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df, <span class="dv">1</span>)</span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="co"># panel data set</span></span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a><span class="co"># date and country.x</span></span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)</span>
<span id="cb255-19"><a href="#cb255-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-20"><a href="#cb255-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">nation =</span> country.x)</span>
<span id="cb255-21"><a href="#cb255-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">year =</span> date)</span>
<span id="cb255-22"><a href="#cb255-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-23"><a href="#cb255-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb255-24"><a href="#cb255-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nation, year, gdp, pop, gdppc, unemployment)</span>
<span id="cb255-25"><a href="#cb255-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-26"><a href="#cb255-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb255-27"><a href="#cb255-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc =</span> gdp <span class="sc">/</span> pop)</span>
<span id="cb255-28"><a href="#cb255-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-29"><a href="#cb255-29" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">|</span> nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb255-30"><a href="#cb255-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-31"><a href="#cb255-31" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-32"><a href="#cb255-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-33"><a href="#cb255-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span>
<span id="cb255-34"><a href="#cb255-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-35"><a href="#cb255-35" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-36"><a href="#cb255-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb255-37"><a href="#cb255-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-38"><a href="#cb255-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span>
<span id="cb255-39"><a href="#cb255-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-40"><a href="#cb255-40" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-41"><a href="#cb255-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-42"><a href="#cb255-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">max</span>(unemployment), <span class="fu">max</span>(gdppc))</span>
<span id="cb255-43"><a href="#cb255-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-44"><a href="#cb255-44" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-45"><a href="#cb255-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-46"><a href="#cb255-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">sd</span>(unemployment))</span>
<span id="cb255-47"><a href="#cb255-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-48"><a href="#cb255-48" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-49"><a href="#cb255-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-50"><a href="#cb255-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(unemployment), <span class="fu">mean</span>(unemployment), <span class="at">cov =</span> <span class="fu">sd</span>(unemployment) <span class="sc">/</span> <span class="fu">mean</span>(unemployment))</span>
<span id="cb255-51"><a href="#cb255-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-52"><a href="#cb255-52" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb255-53"><a href="#cb255-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb255-54"><a href="#cb255-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">mean</span>(gdppc), <span class="at">cov =</span> <span class="fu">sd</span>(gdppc) <span class="sc">/</span> <span class="fu">mean</span>(gdppc))</span>
<span id="cb255-55"><a href="#cb255-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-56"><a href="#cb255-56" aria-hidden="true" tabindex="-1"></a>df_pger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb255-57"><a href="#cb255-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb255-58"><a href="#cb255-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-59"><a href="#cb255-59" aria-hidden="true" tabindex="-1"></a>pger <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pger, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment)) <span class="sc">+</span></span>
<span id="cb255-60"><a href="#cb255-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb255-61"><a href="#cb255-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Germany"</span>)</span>
<span id="cb255-62"><a href="#cb255-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-63"><a href="#cb255-63" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pger)</span>
<span id="cb255-64"><a href="#cb255-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-65"><a href="#cb255-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-66"><a href="#cb255-66" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb255-67"><a href="#cb255-67" aria-hidden="true" tabindex="-1"></a>dfra <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb255-68"><a href="#cb255-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfra<span class="sc">$</span>gdppc, dfra<span class="sc">$</span>unemployment,</span>
<span id="cb255-69"><a href="#cb255-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb255-70"><a href="#cb255-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"GDP per capita"</span>, <span class="at">ylab =</span> <span class="st">"Unemployment rate"</span></span>
<span id="cb255-71"><a href="#cb255-71" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb255-72"><a href="#cb255-72" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfra<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.1</span>, dfra<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb255-73"><a href="#cb255-73" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"France"</span>)</span>
<span id="cb255-74"><a href="#cb255-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-75"><a href="#cb255-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb255-76"><a href="#cb255-76" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb255-77"><a href="#cb255-77" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb255-78"><a href="#cb255-78" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb255-79"><a href="#cb255-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-80"><a href="#cb255-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb255-81"><a href="#cb255-81" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb255-82"><a href="#cb255-82" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb255-83"><a href="#cb255-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-84"><a href="#cb255-84" aria-hidden="true" tabindex="-1"></a>dfger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb255-85"><a href="#cb255-85" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb255-86"><a href="#cb255-86" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfger<span class="sc">$</span>gdppc, dfger<span class="sc">$</span>unemployment,</span>
<span id="cb255-87"><a href="#cb255-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb255-88"><a href="#cb255-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span></span>
<span id="cb255-89"><a href="#cb255-89" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb255-90"><a href="#cb255-90" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfger<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.7</span>, dfger<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.4</span>, labels)</span>
<span id="cb255-91"><a href="#cb255-91" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Germany"</span>)</span>
<span id="cb255-92"><a href="#cb255-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-93"><a href="#cb255-93" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, ggpubr, sjPlot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/home/sthu/Dropbox/hsf/exams/22-11/scr/")</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, ggpubr, sjPlot)</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/forest.Rdata"</span>))</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 11
# Groups:   country.x [1]
  country.x     date     gdp gdp_growth unemployment region income forest    pop
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 United Arab…  1992 1.26e11     -2.48          1.84 Middl… High …   3.63 2.05e6
2 United Arab…  1993 1.27e11     -4.34          1.85 Middl… High …   3.72 2.17e6
3 United Arab…  1994 1.36e11      1.25          1.81 Middl… High …   3.81 2.29e6
4 United Arab…  1995 1.45e11      1.35          1.80 Middl… High …   3.90 2.42e6
5 United Arab…  1996 1.54e11      0.631         1.90 Middl… High …   3.99 2.54e6
6 United Arab…  1997 1.66e11      2.83          1.98 Middl… High …   4.08 2.67e6
7 United Arab…  1998 1.67e11     -4.77          2.14 Middl… High …   4.18 2.81e6
8 United Arab…  1999 1.72e11     -2.40          2.22 Middl… High …   4.27 2.97e6
# ℹ 2 more variables: unemployment_dif &lt;dbl&gt;, gdppc &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
# Groups:   country.x [1]
  country.x  date        gdp gdp_growth unemployment region income forest    pop
  &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Zimbabwe   2020    1.94e10      -7.62         5.35 Sub-S… Lower…   45.1 1.49e7
# ℹ 2 more variables: unemployment_dif &lt;dbl&gt;, gdppc &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># panel data set</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co"># date and country.x</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>observations_df <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">nation =</span> country.x)</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(df, <span class="at">year =</span> date)</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nation, year, gdp, pop, gdppc, unemployment)</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_pc =</span> gdp <span class="sc">/</span> pop)</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">|</span> nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  9.75        34356.
2 Germany                 7.22        36739.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(unemployment), <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `mean(unemployment)` `mean(gdppc)`
  &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
1 France                  8.01        35786.
2 Germany                 3.81        41315.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">max</span>(unemployment), <span class="fu">max</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `max(unemployment)` `max(gdppc)`
  &lt;chr&gt;                 &lt;dbl&gt;        &lt;dbl&gt;
1 France                 12.6       38912.
2 Germany                11.2       43329.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">sd</span>(unemployment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  nation  `sd(gdppc)` `sd(unemployment)`
  &lt;chr&gt;         &lt;dbl&gt;              &lt;dbl&gt;
1 France        2940.               1.58
2 Germany       4015.               2.37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(unemployment), <span class="fu">mean</span>(unemployment), <span class="at">cov =</span> <span class="fu">sd</span>(unemployment) <span class="sc">/</span> <span class="fu">mean</span>(unemployment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(unemployment)` `mean(unemployment)`   cov
  &lt;chr&gt;                &lt;dbl&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 France                1.58                 9.75 0.162
2 Germany               2.37                 7.22 0.328</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nation) <span class="sc">|&gt;</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sd</span>(gdppc), <span class="fu">mean</span>(gdppc), <span class="at">cov =</span> <span class="fu">sd</span>(gdppc) <span class="sc">/</span> <span class="fu">mean</span>(gdppc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  nation  `sd(gdppc)` `mean(gdppc)`    cov
  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 France        2940.        34356. 0.0856
2 Germany       4015.        36739. 0.109 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>df_pger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>pger <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pger, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> unemployment)) <span class="sc">+</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Germany"</span>)</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pger)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-90-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="80_exercises_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>dfra <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"France"</span>)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfra<span class="sc">$</span>gdppc, dfra<span class="sc">$</span>unemployment,</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"GDP per capita"</span>, <span class="at">ylab =</span> <span class="st">"Unemployment rate"</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfra<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.1</span>, dfra<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"France"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-90-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="80_exercises_files/figure-html/unnamed-chunk-90-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1970</span><span class="sc">:</span><span class="dv">1978</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Connected scatter plot with text</span></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span>)</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x <span class="sc">+</span> <span class="fl">0.4</span>, y <span class="sc">+</span> <span class="fl">0.1</span>, labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-90-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="80_exercises_files/figure-html/unnamed-chunk-90-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>dfger <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">filter</span>(nation <span class="sc">==</span> <span class="st">"Germany"</span>)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="dv">1992</span><span class="sc">:</span><span class="dv">2020</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfger<span class="sc">$</span>gdppc, dfger<span class="sc">$</span>unemployment,</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Var 1"</span>, <span class="at">ylab =</span> <span class="st">"Var 2"</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(dfger<span class="sc">$</span>gdppc <span class="sc">+</span> <span class="fl">0.7</span>, dfger<span class="sc">$</span>unemployment <span class="sc">+</span> <span class="fl">0.4</span>, labels)</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Germany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-90-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="80_exercises_files/figure-html/unnamed-chunk-90-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, ggpubr, sjPlot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-exe_duplicates" class="level2" data-number="9.15">
<h2 data-number="9.15" class="anchored" data-anchor-id="sec-exe_duplicates"><span class="header-section-number">9.15</span> Names and duplicates</h2>
<ol type="1">
<li>Load the required packages (<code>pacman</code>, <code>tidyverse</code>, <code>janitor</code>, <code>babynames</code>, <code>stringr</code>).</li>
<li>Load the dataset from the URL: <a href="https://github.com/hubchev/courses/raw/main/dta/df_names.RData" class="uri">https://github.com/hubchev/courses/raw/main/dta/df_names.RData</a>. Make yourself familiar with the data.</li>
<li>After loading the dataset, remove all objects except <code>df_2022</code> and <code>df_2022_error</code>.</li>
<li>Reorder the data using the <code>relocate</code> function so that <code>surname</code>, <code>name</code>, and <code>age</code> appear first. Save the changed data in a tibble called <code>df</code>.</li>
<li>Sort the data according to <code>surname</code>, <code>name</code>, and <code>age</code>.</li>
<li>Make a variable named <code>born</code> that contains the year of birth. How is the <code>born</code> variable calculated?</li>
<li>Create a new variable named <code>id</code> that identifies each person by <code>surname</code>, <code>name</code>, and their birth year (<code>born</code>). Why is this identifier useful?</li>
<li>Investigate how the data is identified. Are there any duplicates? If so, can you think of strategies to identify and how to deal with these duplicates.</li>
<li>Unload the packages used in the script. Why is unloading packages considered good practice?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>anti_join</code>, <code>arrange</code>, <code>c</code>, <code>cur_group_id</code>, <code>desc</code>, <code>dim</code>, <code>distinct</code>, <code>filter</code>, <code>get_dupes</code>, <code>glimpse</code>, <code>group_by</code>, <code>head</code>, <code>load</code>, <code>max</code>, <code>mutate</code>, <code>n</code>, <code>paste</code>, <code>relocate</code>, <code>row_number</code>, <code>setdiff</code>, <code>summary</code>, <code>tail</code>, <code>ungroup</code>, <code>url</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicates</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/test/initial_script")</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear environment</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, janitor, babynames, stringr)</span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/df_names.RData"</span>))</span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all objects except df_2022 and df_2022_error</span></span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="fu">c</span>(<span class="st">"df_2022_error"</span>, <span class="st">"df_2022"</span>)))</span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-18"><a href="#cb277-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-order the data so that surname, name, and age appears first.</span></span>
<span id="cb277-19"><a href="#cb277-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the changed data in a tibble called `df`.</span></span>
<span id="cb277-20"><a href="#cb277-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_2022 <span class="sc">|&gt;</span></span>
<span id="cb277-21"><a href="#cb277-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(surname, name, age)</span>
<span id="cb277-22"><a href="#cb277-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-23"><a href="#cb277-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the data according to surname, name, and age.</span></span>
<span id="cb277-24"><a href="#cb277-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-25"><a href="#cb277-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(surname, name, age)</span>
<span id="cb277-26"><a href="#cb277-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-27"><a href="#cb277-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect df_2022 and df_2022_error</span></span>
<span id="cb277-28"><a href="#cb277-28" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb277-29"><a href="#cb277-29" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span>
<span id="cb277-30"><a href="#cb277-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb277-31"><a href="#cb277-31" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span>
<span id="cb277-32"><a href="#cb277-32" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb277-33"><a href="#cb277-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb277-34"><a href="#cb277-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-35"><a href="#cb277-35" aria-hidden="true" tabindex="-1"></a>df_2022_error</span>
<span id="cb277-36"><a href="#cb277-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-37"><a href="#cb277-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a variable that contains the year of birth. Name the variable `born`</span></span>
<span id="cb277-38"><a href="#cb277-38" aria-hidden="true" tabindex="-1"></a><span class="co"># and new dataframe `df`.</span></span>
<span id="cb277-39"><a href="#cb277-39" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_2022 <span class="sc">|&gt;</span></span>
<span id="cb277-40"><a href="#cb277-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">born =</span> time <span class="sc">-</span> age)</span>
<span id="cb277-41"><a href="#cb277-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-42"><a href="#cb277-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a new variable that identifies each person by surname, name,</span></span>
<span id="cb277-43"><a href="#cb277-43" aria-hidden="true" tabindex="-1"></a><span class="co"># and their birth born. Name the variable `id`.</span></span>
<span id="cb277-44"><a href="#cb277-44" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-45"><a href="#cb277-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">paste</span>(surname, name, born, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb277-46"><a href="#cb277-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-47"><a href="#cb277-47" aria-hidden="true" tabindex="-1"></a><span class="co"># How many different groups do exist?</span></span>
<span id="cb277-48"><a href="#cb277-48" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-49"><a href="#cb277-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb277-50"><a href="#cb277-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_num =</span> <span class="fu">cur_group_id</span>()) <span class="sc">|&gt;</span></span>
<span id="cb277-51"><a href="#cb277-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb277-52"><a href="#cb277-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-53"><a href="#cb277-53" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(df<span class="sc">$</span>id_num)</span>
<span id="cb277-54"><a href="#cb277-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-55"><a href="#cb277-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Show groups that exist more than once.</span></span>
<span id="cb277-56"><a href="#cb277-56" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-57"><a href="#cb277-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb277-58"><a href="#cb277-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb277-59"><a href="#cb277-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">dup_count =</span> <span class="fu">row_number</span>(),</span>
<span id="cb277-60"><a href="#cb277-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">dup_sum   =</span> <span class="fu">n</span>()</span>
<span id="cb277-61"><a href="#cb277-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb277-62"><a href="#cb277-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb277-63"><a href="#cb277-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id)</span>
<span id="cb277-64"><a href="#cb277-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-65"><a href="#cb277-65" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(dup_sum <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb277-66"><a href="#cb277-66" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(name, surname)</span>
<span id="cb277-67"><a href="#cb277-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-68"><a href="#cb277-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Make yourself familiar with the function `get_dupes()` from `janitor` package.</span></span>
<span id="cb277-69"><a href="#cb277-69" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>()</span>
<span id="cb277-70"><a href="#cb277-70" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(surname, name)</span>
<span id="cb277-71"><a href="#cb277-71" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(id)</span>
<span id="cb277-72"><a href="#cb277-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-73"><a href="#cb277-73" aria-hidden="true" tabindex="-1"></a>df_uni <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-74"><a href="#cb277-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>() <span class="sc">|&gt;</span></span>
<span id="cb277-75"><a href="#cb277-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb277-76"><a href="#cb277-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-77"><a href="#cb277-77" aria-hidden="true" tabindex="-1"></a>df_uni_b <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb277-78"><a href="#cb277-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(dup_count)) <span class="sc">|&gt;</span></span>
<span id="cb277-79"><a href="#cb277-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb277-80"><a href="#cb277-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-81"><a href="#cb277-81" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(df, df_uni)</span>
<span id="cb277-82"><a href="#cb277-82" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(df, df_uni_b)</span>
<span id="cb277-83"><a href="#cb277-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-84"><a href="#cb277-84" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb277-85"><a href="#cb277-85" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, janitor, babynames, stringr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find duplicates</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/test/initial_script")</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="co"># clear environment</span></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, janitor, babynames, stringr)</span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/df_names.RData"</span>))</span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all objects except df_2022 and df_2022_error</span></span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="fu">c</span>(<span class="st">"df_2022_error"</span>, <span class="st">"df_2022"</span>)))</span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-order the data so that surname, name, and age appears first.</span></span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the changed data in a tibble called `df`.</span></span>
<span id="cb278-20"><a href="#cb278-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_2022 <span class="sc">|&gt;</span></span>
<span id="cb278-21"><a href="#cb278-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(surname, name, age)</span>
<span id="cb278-22"><a href="#cb278-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-23"><a href="#cb278-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the data according to surname, name, and age.</span></span>
<span id="cb278-24"><a href="#cb278-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb278-25"><a href="#cb278-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(surname, name, age)</span>
<span id="cb278-26"><a href="#cb278-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-27"><a href="#cb278-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect df_2022 and df_2022_error</span></span>
<span id="cb278-28"><a href="#cb278-28" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,018 × 8
   surname name       age sex      cm  time error error_desc
   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
 1 Adams   Adonnis     30 M      192   2022     0 &lt;NA&gt;      
 2 Adams   Adonnis     30 M      192   2022     1 duplicate 
 3 Adams   Aila        79 F      157   2022     0 &lt;NA&gt;      
 4 Adams   Avenelle    69 F      157   2022     0 &lt;NA&gt;      
 5 Adams   Brysan      39 M      192   2022     0 &lt;NA&gt;      
 6 Adams   Eona        84 F      157   2022     0 &lt;NA&gt;      
 7 Adams   Eveline     42 F      157   2022     0 &lt;NA&gt;      
 8 Adams   Faithe      17 F      172.  2022     0 &lt;NA&gt;      
 9 Adams   Ineisha     47 F      157   2022     0 &lt;NA&gt;      
10 Adams   Kloeigh     31 F      157   2022     0 &lt;NA&gt;      
# ℹ 1,008 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1018    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  surname name       age sex      cm  time error error_desc
  &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
1 Adams   Adonnis     30 M       192  2022     0 &lt;NA&gt;      
2 Adams   Adonnis     30 M       192  2022     1 duplicate 
3 Adams   Aila        79 F       157  2022     0 &lt;NA&gt;      
4 Adams   Avenelle    69 F       157  2022     0 &lt;NA&gt;      
5 Adams   Brysan      39 M       192  2022     0 &lt;NA&gt;      
6 Adams   Eona        84 F       157  2022     0 &lt;NA&gt;      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  surname name       age sex      cm  time error error_desc                     
  &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                          
1 Young   Leiliana    54 F     157    2022     0 &lt;NA&gt;                           
2 Young   Shamar      23 M     192    2022     0 &lt;NA&gt;                           
3 Young   Tajanay      1 F      81.5  2022     0 &lt;NA&gt;                           
4 huber   Stephan    186 M      41    2022     1 age/cm false, not capitalized …
5 huber   Stephan     NA &lt;NA&gt;   NA    2022     1 wrong name                     
6 &lt;NA&gt;    Zita         6 &lt;NA&gt;  110    2022     2 surname missing, sex unspecifi…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,018
Columns: 8
$ surname    &lt;chr&gt; "Adams", "Adams", "Adams", "Adams", "Adams", "Adams", "Adam…
$ name       &lt;chr&gt; "Adonnis", "Adonnis", "Aila", "Avenelle", "Brysan", "Eona",…
$ age        &lt;dbl&gt; 30, 30, 79, 69, 39, 84, 42, 17, 47, 31, 65, 80, 6, 5, 5, 20…
$ sex        &lt;chr&gt; "M", "M", "F", "F", "M", "F", "F", "F", "F", "F", "M", "F",…
$ cm         &lt;dbl&gt; 192.00000, 192.00000, 157.00000, 157.00000, 192.00000, 157.…
$ time       &lt;dbl&gt; 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022,…
$ error      &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,…
$ error_desc &lt;chr&gt; NA, "duplicate", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   surname              name                age             sex           
 Length:1018        Length:1018        Min.   :  1.00   Length:1018       
 Class :character   Class :character   1st Qu.: 21.00   Class :character  
 Mode  :character   Mode  :character   Median : 43.00   Mode  :character  
                                       Mean   : 45.75                     
                                       3rd Qu.: 69.00                     
                                       Max.   :399.00                     
                                       NA's   :2                          
       cm             time          error          error_desc       
 Min.   : 41.0   Min.   :2022   Min.   :0.00000   Length:1018       
 1st Qu.:157.0   1st Qu.:2022   1st Qu.:0.00000   Class :character  
 Median :157.0   Median :2022   Median :0.00000   Mode  :character  
 Mean   :163.2   Mean   :2022   Mean   :0.02456                     
 3rd Qu.:192.0   3rd Qu.:2022   3rd Qu.:0.00000                     
 Max.   :295.0   Max.   :2022   Max.   :3.00000                     
 NA's   :4                                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>df_2022_error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 8
   sex   name    surname    age    cm  time error error_desc                    
   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                         
 1 M     Savier  Campbell    72 192    2022     1 duplicate                     
 2 F     Tina    Adams        5  98.0  2022     1 duplicate                     
 3 F     Abery   Allen       79 157    2022     1 duplicate                     
 4 M     Adonnis Adams       30 192    2022     1 duplicate                     
 5 M     Stephan Maier       41 186    2022     1 wrong surname                 
 6 &lt;NA&gt;  Stephan huber       NA  NA    2022     1 wrong name                    
 7 M     stephan Huber      186  41    2022     1 age/cm false, not capitalized…
 8 M     Stephan huber      186  41    2022     1 age/cm false, not capitalized…
 9 M     Stephan Huber       41 186    2022     1 duplicate                     
10 M     Stephan Huber       41  NA    2022     1 duplicate, cm NA              
11 F     Rosa    Huber        9  NA    2022     3 only age and sex given        
12 &lt;NA&gt;  Rosa    Huber       NA 130    2022     3 age missing, sex unspecified  
13 &lt;NA&gt;  Ignaz   Huber        7  NA    2022     2 cm missing, sex unspecified   
14 &lt;NA&gt;  Zita    &lt;NA&gt;         6 110    2022     2 surname missing, sex unspecif…
15 &lt;NA&gt;  Alois   Huber        3 295    2022     2 cm not possible, sex unspecif…
16 F     Martina Huber      399 169    2022     2 age not possible              
17 M     Stephan Huber       41 186    2022     0 no error                      
18 M     Stephan Huber       41 186    2022     1 duplicate                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a variable that contains the year of birth. Name the variable `born`</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and new dataframe `df`.</span></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_2022 <span class="sc">|&gt;</span></span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">born =</span> time <span class="sc">-</span> age)</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a new variable that identifies each person by surname, name,</span></span>
<span id="cb292-7"><a href="#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and their birth born. Name the variable `id`.</span></span>
<span id="cb292-8"><a href="#cb292-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb292-9"><a href="#cb292-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">paste</span>(surname, name, born, <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb292-10"><a href="#cb292-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-11"><a href="#cb292-11" aria-hidden="true" tabindex="-1"></a><span class="co"># How many different groups do exist?</span></span>
<span id="cb292-12"><a href="#cb292-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb292-13"><a href="#cb292-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb292-14"><a href="#cb292-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_num =</span> <span class="fu">cur_group_id</span>()) <span class="sc">|&gt;</span></span>
<span id="cb292-15"><a href="#cb292-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb292-16"><a href="#cb292-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-17"><a href="#cb292-17" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(df<span class="sc">$</span>id_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1011</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show groups that exist more than once.</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dup_count =</span> <span class="fu">row_number</span>(),</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dup_sum   =</span> <span class="fu">n</span>()</span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id)</span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">filter</span>(dup_sum <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 13
   sex   name    surname    age    cm  time error error_desc   born id    id_num
   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt;
 1 M     Adonnis Adams       30 192    2022     0 &lt;NA&gt;         1992 Adam…      1
 2 M     Adonnis Adams       30 192    2022     1 duplicate    1992 Adam…      1
 3 F     Tina    Adams        5  98.0  2022     1 duplicate    2017 Adam…     13
 4 F     Tina    Adams        5  98.0  2022     0 &lt;NA&gt;         2017 Adam…     13
 5 F     Abery   Allen       79 157    2022     0 &lt;NA&gt;         1943 Alle…     15
 6 F     Abery   Allen       79 157    2022     1 duplicate    1943 Alle…     15
 7 M     Savier  Campbell    72 192    2022     0 &lt;NA&gt;         1950 Camp…    100
 8 M     Savier  Campbell    72 192    2022     1 duplicate    1950 Camp…    100
 9 M     Stephan Huber       41 186    2022     1 duplicate    1981 Hube…    383
10 M     Stephan Huber       41 186    2022     0 no error     1981 Hube…    383
11 M     Stephan Huber       41 186    2022     1 duplicate    1981 Hube…    383
12 M     Stephan Huber       41  NA    2022     1 duplicate,…  1981 Hube…    383
# ℹ 2 more variables: dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(name, surname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 14
   name  surname dupe_count sex     age    cm  time error error_desc  born id   
   &lt;chr&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;
 1 Step… Huber            4 M        41 186    2022     1 duplicate   1981 Hube…
 2 Step… Huber            4 M        41 186    2022     0 no error    1981 Hube…
 3 Step… Huber            4 M        41 186    2022     1 duplicate   1981 Hube…
 4 Step… Huber            4 M        41  NA    2022     1 duplicate…  1981 Hube…
 5 Abery Allen            2 F        79 157    2022     0 &lt;NA&gt;        1943 Alle…
 6 Abery Allen            2 F        79 157    2022     1 duplicate   1943 Alle…
 7 Adon… Adams            2 M        30 192    2022     0 &lt;NA&gt;        1992 Adam…
 8 Adon… Adams            2 M        30 192    2022     1 duplicate   1992 Adam…
 9 Merl… Miller           2 F        12 153.   2022     0 &lt;NA&gt;        2010 Mill…
10 Merl… Miller           2 F         2  99.9  2022     0 &lt;NA&gt;        2020 Mill…
11 Rosa  Huber            2 F         9  NA    2022     3 only age …  2013 Hube…
12 Rosa  Huber            2 &lt;NA&gt;     NA 130    2022     3 age missi…    NA Hube…
13 Savi… Campbe…          2 M        72 192    2022     0 &lt;NA&gt;        1950 Camp…
14 Savi… Campbe…          2 M        72 192    2022     1 duplicate   1950 Camp…
15 Step… huber            2 M       186  41    2022     1 age/cm fa…  1836 hube…
16 Step… huber            2 &lt;NA&gt;     NA  NA    2022     1 wrong name    NA hube…
17 Tina  Adams            2 F         5  98.0  2022     1 duplicate   2017 Adam…
18 Tina  Adams            2 F         5  98.0  2022     0 &lt;NA&gt;        2017 Adam…
# ℹ 3 more variables: id_num &lt;int&gt;, dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make yourself familiar with the function `get_dupes()` from `janitor` package.</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No variable names specified - using all columns.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: sex, name, surname, age, cm, time, error, error_desc, born, ... and 4 other variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 14
# ℹ 14 variables: sex &lt;chr&gt;, name &lt;chr&gt;, surname &lt;chr&gt;, age &lt;dbl&gt;, cm &lt;dbl&gt;,
#   time &lt;dbl&gt;, error &lt;dbl&gt;, error_desc &lt;chr&gt;, born &lt;dbl&gt;, id &lt;chr&gt;,
#   id_num &lt;int&gt;, dup_count &lt;int&gt;, dup_sum &lt;int&gt;, dupe_count &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(surname, name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 14
   surname name  dupe_count sex     age    cm  time error error_desc  born id   
   &lt;chr&gt;   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;
 1 Huber   Step…          4 M        41 186    2022     1 duplicate   1981 Hube…
 2 Huber   Step…          4 M        41 186    2022     0 no error    1981 Hube…
 3 Huber   Step…          4 M        41 186    2022     1 duplicate   1981 Hube…
 4 Huber   Step…          4 M        41  NA    2022     1 duplicate…  1981 Hube…
 5 Adams   Adon…          2 M        30 192    2022     0 &lt;NA&gt;        1992 Adam…
 6 Adams   Adon…          2 M        30 192    2022     1 duplicate   1992 Adam…
 7 Adams   Tina           2 F         5  98.0  2022     1 duplicate   2017 Adam…
 8 Adams   Tina           2 F         5  98.0  2022     0 &lt;NA&gt;        2017 Adam…
 9 Allen   Abery          2 F        79 157    2022     0 &lt;NA&gt;        1943 Alle…
10 Allen   Abery          2 F        79 157    2022     1 duplicate   1943 Alle…
11 Campbe… Savi…          2 M        72 192    2022     0 &lt;NA&gt;        1950 Camp…
12 Campbe… Savi…          2 M        72 192    2022     1 duplicate   1950 Camp…
13 Huber   Rosa           2 F         9  NA    2022     3 only age …  2013 Hube…
14 Huber   Rosa           2 &lt;NA&gt;     NA 130    2022     3 age missi…    NA Hube…
15 Miller  Merl…          2 F        12 153.   2022     0 &lt;NA&gt;        2010 Mill…
16 Miller  Merl…          2 F         2  99.9  2022     0 &lt;NA&gt;        2020 Mill…
17 huber   Step…          2 M       186  41    2022     1 age/cm fa…  1836 hube…
18 huber   Step…          2 &lt;NA&gt;     NA  NA    2022     1 wrong name    NA hube…
# ℹ 3 more variables: id_num &lt;int&gt;, dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">get_dupes</span>(id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 14
   id    dupe_count sex   name  surname   age    cm  time error error_desc  born
   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 Hube…          4 M     Step… Huber      41 186    2022     1 duplicate   1981
 2 Hube…          4 M     Step… Huber      41 186    2022     0 no error    1981
 3 Hube…          4 M     Step… Huber      41 186    2022     1 duplicate   1981
 4 Hube…          4 M     Step… Huber      41  NA    2022     1 duplicate…  1981
 5 Adam…          2 M     Adon… Adams      30 192    2022     0 &lt;NA&gt;        1992
 6 Adam…          2 M     Adon… Adams      30 192    2022     1 duplicate   1992
 7 Adam…          2 F     Tina  Adams       5  98.0  2022     1 duplicate   2017
 8 Adam…          2 F     Tina  Adams       5  98.0  2022     0 &lt;NA&gt;        2017
 9 Alle…          2 F     Abery Allen      79 157    2022     0 &lt;NA&gt;        1943
10 Alle…          2 F     Abery Allen      79 157    2022     1 duplicate   1943
11 Camp…          2 M     Savi… Campbe…    72 192    2022     0 &lt;NA&gt;        1950
12 Camp…          2 M     Savi… Campbe…    72 192    2022     1 duplicate   1950
# ℹ 3 more variables: id_num &lt;int&gt;, dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>df_uni <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>() <span class="sc">|&gt;</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>df_uni_b <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(dup_count)) <span class="sc">|&gt;</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(df, df_uni)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sex, name, surname, age, cm, time, error,
error_desc, born, id, id_num, dup_count, dup_sum)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 13
  sex   name    surname    age    cm  time error error_desc    born id    id_num
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt;
1 M     Adonnis Adams       30 192    2022     1 duplicate     1992 Adam…      1
2 F     Tina    Adams        5  98.0  2022     0 &lt;NA&gt;          2017 Adam…     13
3 F     Abery   Allen       79 157    2022     1 duplicate     1943 Alle…     15
4 M     Savier  Campbell    72 192    2022     1 duplicate     1950 Camp…    100
5 M     Stephan Huber       41 186    2022     0 no error      1981 Hube…    383
6 M     Stephan Huber       41 186    2022     1 duplicate     1981 Hube…    383
7 M     Stephan Huber       41  NA    2022     1 duplicate, …  1981 Hube…    383
# ℹ 2 more variables: dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(df, df_uni_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(sex, name, surname, age, cm, time, error,
error_desc, born, id, id_num, dup_count, dup_sum)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 13
  sex   name    surname    age    cm  time error error_desc  born id      id_num
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt;
1 M     Adonnis Adams       30 192    2022     0 &lt;NA&gt;        1992 Adams_…      1
2 F     Tina    Adams        5  98.0  2022     1 duplicate   2017 Adams_…     13
3 F     Abery   Allen       79 157    2022     0 &lt;NA&gt;        1943 Allen_…     15
4 M     Savier  Campbell    72 192    2022     0 &lt;NA&gt;        1950 Campbe…    100
5 M     Stephan Huber       41 186    2022     1 duplicate   1981 Huber_…    383
6 M     Stephan Huber       41 186    2022     0 no error    1981 Huber_…    383
7 M     Stephan Huber       41 186    2022     1 duplicate   1981 Huber_…    383
# ℹ 2 more variables: dup_count &lt;int&gt;, dup_sum &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unload packages</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, janitor, babynames, stringr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zipfs-law" class="level2" data-number="9.16">
<h2 data-number="9.16" class="anchored" data-anchor-id="zipfs-law"><span class="header-section-number">9.16</span> Zipf’s law</h2>
<p>The data under investigation includes population information for various German cities, identified by the variable <code>stadt</code>, spanning the years 1970, 1987, and 2010. The variable status provides details about the legislative status of the cities, and the variable <code>state</code> (Bundesland) indicates the state in which each respective city is situated.</p>
<p><strong>Preamble</strong></p>
<ol type="1">
<li>Set your working directory.</li>
</ol>
<ol start="2" type="1">
<li>Clear your global environment.</li>
</ol>
<ol start="3" type="1">
<li>Install and load the following packages: ‘tidyverse’, ‘haven’, and ‘janitor’.</li>
</ol>
<p><strong>Read in, inspect, and clean the data</strong></p>
<ol start="4" type="1">
<li>Download and load the data, respectively, with the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://github.com/hubchev/courses/raw/main/dta/city.dta"</span>,</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">"latin1"</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If that is not working, you can also download the data from ILIAS, save it in your working directory and load it from there with:</p>
<pre><code>load("city.RData")</code></pre>
<ol start="5" type="1">
<li><p>Show the first six and the last six observations of the dataset <code>df</code>.</p></li>
<li><p>How many observations (rows) and variables (columns) are in the dataset?</p></li>
<li><p>Show for all numerical variables the summary statistics including the mean, median, minimum, and the maximum.</p></li>
<li><p>Rename the variable <code>stadt</code> to <code>city</code>.</p></li>
<li><p>Remove the variables <code>pop1970</code> and <code>pop1987</code>.</p></li>
<li><p>Replicate the following table which contains some summary statistics.</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 3
   state                  `mean(pop2011)` `sum(pop2011)`
   &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;
 1 Baden-Wrttemberg                 7580            7580
 2 Baden-Württemberg               23680.        7837917
 3 Bayern                          23996.        7558677
 4 Berlin                        3292365         3292365
 5 Brandenburg                     18472.        1865632
 6 Bremen                         325432.         650863
 7 Hamburg                       1706696         1706696
 8 Hessen                          22996.        5036121
 9 Mecklenburg-Vorpommern          27034.         811005
10 Niedersachsen                   24107.        6219515
11 Nordrhein-Westfalen             47465.       18036727
12 Rheinland-Pfalz                 25644.        1871995
13 Saarland                           NA              NA
14 Sachsen                         27788.        2973351
15 Sachsen-Anhalt                  21212.        1993915
16 Schleswig-Holstein              24157.        1739269
17 Th_ringen                       29192.        1167692</code></pre>
</div>
</div>
<ol start="11" type="1">
<li>The states “Baden-Wrttemberg” and “Th_ringen” are falsely pronounced. Correct the names and regenerate the summary statistics table presented above. Your result should look like this:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   state                  `mean(pop2011)` `sum(pop2011)`
   &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;
 1 Baden-Württemberg               23631.        7845497
 2 Bayern                          23996.        7558677
 3 Berlin                        3292365         3292365
 4 Brandenburg                     18472.        1865632
 5 Bremen                         325432.         650863
 6 Hamburg                       1706696         1706696
 7 Hessen                          22996.        5036121
 8 Mecklenburg-Vorpommern          27034.         811005
 9 Niedersachsen                   24107.        6219515
10 Nordrhein-Westfalen             47465.       18036727
11 Rheinland-Pfalz                 25644.        1871995
12 Saarland                           NA              NA
13 Sachsen                         27788.        2973351
14 Sachsen-Anhalt                  21212.        1993915
15 Schleswig-Holstein              24157.        1739269
16 Thüringen                       29192.        1167692</code></pre>
</div>
</div>
<ol start="12" type="1">
<li>To investigate the reason for observing only <code>NAs</code> for Saarland, examine all cities within Saarland. Therefore, please display all observations for cities in Saarland in the Console, as illustrated below.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 47 × 5
   city                status  state    pop2011 rankX
   &lt;chr&gt;               &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Perl                Commune Saarland    7775  2003
 2 Freisen             Commune Saarland    8270  1894
 3 Großrosseln         Commune Saarland    8403  1868
 4 Nonnweiler          Commune Saarland    8844  1775
 5 Nalbach             Commune Saarland    9302  1678
 6 Wallerfangen        Commune Saarland    9542  1642
 7 Kirkel              Commune Saarland   10058  1541
 8 Merchweiler         Commune Saarland   10219  1515
 9 Nohfelden           Commune Saarland   10247  1511
10 Friedrichsthal      City    Saarland   10409  1489
11 Marpingen           Commune Saarland   10590  1461
12 Mandelbachtal       Commune Saarland   11107  1390
13 Kleinblittersdorf   Commune Saarland   11396  1354
14 Überherrn           Commune Saarland   11655  1317
15 Mettlach            Commune Saarland   12180  1241
16 Tholey              Commune Saarland   12385  1217
17 Saarwellingen       Commune Saarland   13348  1104
18 Quierschied         Commune Saarland   13506  1088
19 Spiesen-Elversberg  Commune Saarland   13509  1086
20 Rehlingen-Siersburg Commune Saarland   14526   996
21 Riegelsberg         Commune Saarland   14763   982
22 Ottweiler           City    Saarland   14934   969
23 Beckingen           Commune Saarland   15355   931
24 Losheim am See      Commune Saarland   15906   887
25 Schiffweiler        Commune Saarland   15993   882
26 Wadern              City    Saarland   16181   874
27 Schmelz             Commune Saarland   16435   857
28 Sulzbach/Saar       City    Saarland   16591   849
29 Illingen            Commune Saarland   16978   827
30 Schwalbach          Commune Saarland   17320   812
31 Eppelborn           Commune Saarland   17726   793
32 Wadgassen           Commune Saarland   17885   785
33 Bexbach             City    Saarland   18038   777
34 Heusweiler          Commune Saarland   18201   762
35 Püttlingen          City    Saarland   19134   718
36 Lebach              City    Saarland   19484   701
37 Dillingen/Saar      City    Saarland   20253   654
38 Blieskastel         City    Saarland   21255   601
39 St. Wendel          City    Saarland   26220   460
40 Merzig              City    Saarland   29727   392
41 Saarlouis           City    Saarland   34479   323
42 St. Ingbert         City    Saarland   36645   299
43 Völklingen          City    Saarland   38809   279
44 Homburg             City    Saarland   41502   247
45 Neunkirchen         City    Saarland   46172   206
46 Saarbrücken         City    Saarland  175853    43
47 Perl                Commune Saarland      NA    NA</code></pre>
</div>
</div>
<ol start="13" type="1">
<li><p>With reference to the table above, we have identified an entry for the city of Perl that solely consists of <code>NAs</code>. This city is duplicated in the dataset, appearing at positions 1 and 47. The latter duplicate contains only <code>NAs</code> and can be safely removed without the loss of valuable information. Please eliminate this duplification and regenerate the list of all cities in the Saarland.</p></li>
<li><p>Calculate the total population and average size of cities in Saarland.</p></li>
<li><p>Check if any other city is recorded more than once in the dataset. To do so, reproduce the table below.</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
# Groups:   city [11]
   city        status                  state               pop2011 unique_count
   &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt;                 &lt;dbl&gt;        &lt;int&gt;
 1 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 2 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 3 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 4 Brühl       Commune                 Baden-Württemberg     13805            2
 5 Brühl       City                    Nordrhein-Westfalen   43568            2
 6 Erbach      City                    Baden-Württemberg     13024            2
 7 Erbach      City                    Hessen                13245            2
 8 Fürth       City with County Rights Bayern               115613            2
 9 Fürth       Commune                 Hessen                10481            2
10 Lichtenau   City                    Nordrhein-Westfalen   10473            2
11 Lichtenau   Commune                 Sachsen                7544            2
12 Münster     Commune                 Hessen                14071            2
13 Münster     City with County Rights Nordrhein-Westfalen  289576            2
14 Neunkirchen Commune                 Nordrhein-Westfalen   13930            2
15 Neunkirchen City                    Saarland              46172            2
16 Neuried     Commune                 Baden-Württemberg      9383            2
17 Neuried     Commune                 Bayern                 8277            2
18 Petersberg  Commune                 Hessen                14766            2
19 Petersberg  Commune                 Sachsen-Anhalt        10097            2
20 Senden      City                    Bayern                21560            2
21 Senden      Commune                 Nordrhein-Westfalen   19976            2
22 Staufenberg City                    Hessen                 8114            2
23 Staufenberg Commune                 Niedersachsen          7983            2</code></pre>
</div>
</div>
<ol start="16" type="1">
<li>The table indicates that the city of Bonn appears three times in the dataset, and all three observations contain identical information. Thus, remove two of these observations to ensure that Bonn is uniquely represented in the dataset. All other cities that occur more than once in the data are situated in different states. That means, these are distinct cities that coincidentally share the same name.</li>
</ol>
<p><strong>Data analysis (Zipf’s Law)</strong></p>
<p>*<strong>Note:</strong> If you have failed to solve the data cleaning tasks above, you can download the cleaned data from ILIAS, save it in your working directory and load it from there with: <code>load("city_clean.RData")</code></p>
<p>In the following, you aim to examine the validity of Zipf’s Law for Germany. Zipf’s Law postulates how the size of cities is distributed. The “law” states that there is a special relationship between the size of a city and the rank it occupies in a series sorted by city size. In the estimation equation <span class="math display">\[
\log(M_j) = c - q \log(R_j),
\]</span> the law postulates a coefficient of <span class="math inline">\(( q=1 )\)</span>. <span class="math inline">\(c\)</span> is a constant; <span class="math inline">\(M_j\)</span> is the size of city <span class="math inline">\(j\)</span>; <span class="math inline">\(R_j\)</span> is the rank that city <span class="math inline">\(j\)</span> occupies in a series sorted by city size.</p>
<ol start="17" type="1">
<li></li>
</ol>
<p>Create a variable named <code>rank</code> that includes a ranking of cities based on the population size in the year 2011. Therefore, Berlin should have a rank of 1, Hamburg a rank of 2, Munich a rank of 3, and so on.</p>
<p><strong>Note:</strong> If you cannot solve this task, use the variable <code>rankX</code> as a substitute for the variable <code>rank</code> that was not generated.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  city                    pop2011  rank
  &lt;chr&gt;                     &lt;dbl&gt; &lt;int&gt;
1 Berlin                  3292365     1
2 Hamburg                 1706696     2
3 München [Munich]        1348335     3
4 Köln [Cologne]          1005775     4
5 Frankfurt am Main        667925     5
6 Düsseldorf [Dusseldorf]  586291     6</code></pre>
</div>
</div>
<ol start="18" type="1">
<li>Calculate the Pearson Correlation Coefficient of the two variables <code>pop2011</code> and <code>rank</code>. The result should be:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2948903</code></pre>
</div>
</div>
<ol start="19" type="1">
<li>Create a scatter plot. On the x-axis, plot the variable <code>rank</code>, and on the y-axis, plot <code>pop2011</code>. Add a regression line representing the observed relationship to the same scatter plot.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-111-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="80_exercises_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="20" type="1">
<li>Logarithmize the variables <code>rank</code> and <code>pop2011</code>. Title the new variables as <code>lnrank</code> and <code>lnpop2011</code>, respectively. Here is a snapshot of the resulting variables:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  city                     rank lnrank pop2011 lnpop2011
  &lt;chr&gt;                   &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Berlin                      1  0     3292365      15.0
2 Hamburg                     2  0.693 1706696      14.4
3 München [Munich]            3  1.10  1348335      14.1
4 Köln [Cologne]              4  1.39  1005775      13.8
5 Frankfurt am Main           5  1.61   667925      13.4
6 Düsseldorf [Dusseldorf]     6  1.79   586291      13.3</code></pre>
</div>
</div>
<ol start="21" type="1">
<li>Calculate the Pearson Correlation Coefficient of the two variables <code>lnpop2011</code> and <code>lnrank</code>. The result should be:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9990053</code></pre>
</div>
</div>
<ol start="22" type="1">
<li>Create a scatter plot. On the x-axis, plot the variable <code>lnrank</code>, and on the y-axis, plot <code>lnpop2011</code>. Add a regression line representing the observed relationship to the same scatter plot. Additionally, add a title and label the axes like is shown here:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-114-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="80_exercises_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<ol start="23" type="1">
<li>Now, test the relationship postulated in Zipf’s Law. Regress the logarithmic city size in the year 2011 on the logarithmic rank of a city in a series sorted by city size. Briefly interpret the results, addressing the coefficient of determination. Show the regression results. Here is one way to present the results of the regression <em>(Note: The way how you present your regression results do not matter)</em>:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lnpop2011 ~ lnrank, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28015 -0.01879  0.01083  0.02005  0.25973 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 14.947859   0.005141    2908   &lt;2e-16 ***
lnrank      -0.780259   0.000766   -1019   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03454 on 2067 degrees of freedom
Multiple R-squared:  0.998, Adjusted R-squared:  0.998 
F-statistic: 1.038e+06 on 1 and 2067 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="24" type="1">
<li>Explain the following lines of code.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(zipf, <span class="at">newdata =</span> df)) <span class="sc">|&gt;</span></span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_pop =</span> <span class="fu">exp</span>(prediction))</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, pop2011, pred_pop) <span class="sc">|&gt;</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"Regensburg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  city       pop2011 pred_pop
  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Regensburg  135403  134194.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The script uses the following functions: <code>aes</code>, <code>arrange</code>, <code>as_tibble</code>, <code>c</code>, <code>case_when</code>, <code>cor</code>, <code>desc</code>, <code>dim</code>, <code>exp</code>, <code>filter</code>, <code>geom_point</code>, <code>geom_smooth</code>, <code>ggplot</code>, <code>group_by</code>, <code>head</code>, <code>is.na</code>, <code>labs</code>, <code>lm</code>, <code>log</code>, <code>mean</code>, <code>mutate</code>, <code>n</code>, <code>predict</code>, <code>print</code>, <code>read_dta</code>, <code>rename</code>, <code>row_number</code>, <code>save</code>, <code>select</code>, <code>starts_with</code>, <code>sum</code>, <code>summarise</code>, <code>summary</code>, <code>tail</code>, <code>ungroup</code>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(all))</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/exams/24-01/Rmd")</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, janitor, jtools)</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/city.dta"</span>,</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">"latin1"</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> stadt)</span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-26"><a href="#cb326-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pop1970, <span class="sc">-</span>pop1987)</span>
<span id="cb326-27"><a href="#cb326-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-28"><a href="#cb326-28" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-29"><a href="#cb326-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb326-30"><a href="#cb326-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb326-31"><a href="#cb326-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb326-32"><a href="#cb326-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb326-33"><a href="#cb326-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-34"><a href="#cb326-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-35"><a href="#cb326-35" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-36"><a href="#cb326-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">case_when</span>(</span>
<span id="cb326-37"><a href="#cb326-37" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"Baden-Wrttemberg"</span> <span class="sc">~</span> <span class="st">"Baden-Württemberg"</span>,</span>
<span id="cb326-38"><a href="#cb326-38" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"Th_ringen"</span> <span class="sc">~</span> <span class="st">"Thüringen"</span>,</span>
<span id="cb326-39"><a href="#cb326-39" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> state</span>
<span id="cb326-40"><a href="#cb326-40" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb326-41"><a href="#cb326-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-42"><a href="#cb326-42" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-43"><a href="#cb326-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb326-44"><a href="#cb326-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb326-45"><a href="#cb326-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb326-46"><a href="#cb326-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb326-47"><a href="#cb326-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-48"><a href="#cb326-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-49"><a href="#cb326-49" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-50"><a href="#cb326-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-51"><a href="#cb326-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb326-52"><a href="#cb326-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-53"><a href="#cb326-53" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-54"><a href="#cb326-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(city <span class="sc">==</span> <span class="st">"Perl"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(pop2011)))</span>
<span id="cb326-55"><a href="#cb326-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-56"><a href="#cb326-56" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-57"><a href="#cb326-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-58"><a href="#cb326-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb326-59"><a href="#cb326-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-60"><a href="#cb326-60" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-61"><a href="#cb326-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-62"><a href="#cb326-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb326-63"><a href="#cb326-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb326-64"><a href="#cb326-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb326-65"><a href="#cb326-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-66"><a href="#cb326-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-67"><a href="#cb326-67" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-68"><a href="#cb326-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city) <span class="sc">|&gt;</span></span>
<span id="cb326-69"><a href="#cb326-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb326-70"><a href="#cb326-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-71"><a href="#cb326-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-72"><a href="#cb326-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb326-73"><a href="#cb326-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb326-74"><a href="#cb326-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-75"><a href="#cb326-75" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-76"><a href="#cb326-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-77"><a href="#cb326-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb326-78"><a href="#cb326-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-79"><a href="#cb326-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-80"><a href="#cb326-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb326-81"><a href="#cb326-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb326-82"><a href="#cb326-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-83"><a href="#cb326-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-84"><a href="#cb326-84" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-85"><a href="#cb326-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-86"><a href="#cb326-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_row =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb326-87"><a href="#cb326-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_row <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-88"><a href="#cb326-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_row)</span>
<span id="cb326-89"><a href="#cb326-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-90"><a href="#cb326-90" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-91"><a href="#cb326-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-92"><a href="#cb326-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb326-93"><a href="#cb326-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb326-94"><a href="#cb326-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb326-95"><a href="#cb326-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb326-96"><a href="#cb326-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb326-97"><a href="#cb326-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-98"><a href="#cb326-98" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(df, <span class="at">file =</span> <span class="st">"city_clean.RData"</span>)</span>
<span id="cb326-99"><a href="#cb326-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-100"><a href="#cb326-100" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-101"><a href="#cb326-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb326-102"><a href="#cb326-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pop2011)) <span class="sc">|&gt;</span></span>
<span id="cb326-103"><a href="#cb326-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>())</span>
<span id="cb326-104"><a href="#cb326-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-105"><a href="#cb326-105" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-106"><a href="#cb326-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rankX, <span class="sc">-</span>status, <span class="sc">-</span>state) <span class="sc">|&gt;</span></span>
<span id="cb326-107"><a href="#cb326-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb326-108"><a href="#cb326-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-109"><a href="#cb326-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-110"><a href="#cb326-110" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>pop2011, df<span class="sc">$</span>rank, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span>
<span id="cb326-111"><a href="#cb326-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-112"><a href="#cb326-112" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> pop2011)) <span class="sc">+</span></span>
<span id="cb326-113"><a href="#cb326-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb326-114"><a href="#cb326-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb326-115"><a href="#cb326-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-116"><a href="#cb326-116" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-117"><a href="#cb326-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnrank =</span> <span class="fu">log</span>(rank)) <span class="sc">|&gt;</span></span>
<span id="cb326-118"><a href="#cb326-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnpop2011 =</span> <span class="fu">log</span>(pop2011))</span>
<span id="cb326-119"><a href="#cb326-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-120"><a href="#cb326-120" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-121"><a href="#cb326-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, rank, lnrank, pop2011, lnpop2011) <span class="sc">|&gt;</span></span>
<span id="cb326-122"><a href="#cb326-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb326-123"><a href="#cb326-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-124"><a href="#cb326-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-125"><a href="#cb326-125" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>lnpop2011, df<span class="sc">$</span>lnrank, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span>
<span id="cb326-126"><a href="#cb326-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-127"><a href="#cb326-127" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> lnrank, <span class="at">y =</span> lnpop2011)) <span class="sc">+</span></span>
<span id="cb326-128"><a href="#cb326-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb326-129"><a href="#cb326-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb326-130"><a href="#cb326-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb326-131"><a href="#cb326-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatterplot with Regression Line"</span>,</span>
<span id="cb326-132"><a href="#cb326-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"lnrank (Logarithmized Rank)"</span>,</span>
<span id="cb326-133"><a href="#cb326-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"lnpop2011 (Logarithmized Population 2011)"</span></span>
<span id="cb326-134"><a href="#cb326-134" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-135"><a href="#cb326-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-136"><a href="#cb326-136" aria-hidden="true" tabindex="-1"></a>zipf <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnpop2011 <span class="sc">~</span> lnrank, <span class="at">data =</span> df)</span>
<span id="cb326-137"><a href="#cb326-137" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zipf)</span>
<span id="cb326-138"><a href="#cb326-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-139"><a href="#cb326-139" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb326-140"><a href="#cb326-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(zipf, <span class="at">newdata =</span> df)) <span class="sc">|&gt;</span></span>
<span id="cb326-141"><a href="#cb326-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_pop =</span> <span class="fu">exp</span>(prediction))</span>
<span id="cb326-142"><a href="#cb326-142" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb326-143"><a href="#cb326-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, pop2011, pred_pop) <span class="sc">|&gt;</span></span>
<span id="cb326-144"><a href="#cb326-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"Regensburg"</span>)</span>
<span id="cb326-145"><a href="#cb326-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-146"><a href="#cb326-146" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven, janitor, jtools))</span>
<span id="cb326-147"><a href="#cb326-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-148"><a href="#cb326-148" aria-hidden="true" tabindex="-1"></a><span class="co"># rmarkdown::render("24-01_dsda.Rmd", "all")</span></span>
<span id="cb326-149"><a href="#cb326-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-150"><a href="#cb326-150" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::purl(input = "24-01_dsda.Rmd", output = "24-01_dsda_solution.R",documentation = 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Output of the R script">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Output of the R script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(all))</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Dropbox/hsf/exams/24-01/Rmd")</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, haven, janitor, jtools)</span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://github.com/hubchev/courses/raw/main/dta/city.dta"</span>,</span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">"latin1"</span></span>
<span id="cb327-12"><a href="#cb327-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb327-13"><a href="#cb327-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb327-14"><a href="#cb327-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-15"><a href="#cb327-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  stadt              status  state              pop1970 pop1987 pop2011 rankX
  &lt;chr&gt;              &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Vohenstrauß        City    Bayern                7349    7059    7500  2069
2 Stockstadt a. Main Commune Bayern                6416    6615    7504  2068
3 Jesteburg          Commune Niedersachsen         4141    5818    7510  2067
4 Bordesholm         Commune Schleswig-Holstein    6011    6726    7513  2066
5 Herrieden          City    Bayern                5631    6250    7516  2065
6 Weida              City    Th_ringen               NA      NA    7522  2064</code></pre>
</div>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  stadt             status                  state  pop1970 pop1987 pop2011 rankX
  &lt;chr&gt;             &lt;chr&gt;                   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Frankfurt am Main City with County Rights Hessen  699297  618266  667925     5
2 Köln [Cologne]    City with County Rights Nordr…  994705  928309 1005775     4
3 München [Munich]  City with County Rights Bayern 1293599 1185421 1348335     3
4 Hamburg           City with County Rights Hambu… 1793823 1592770 1706696     2
5 Berlin            City with County Rights Berlin 3210000 3260000 3292365     1
6 Perl              Commune                 Saarl…      NA      NA      NA    NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2072    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    stadt              status             state              pop1970       
 Length:2072        Length:2072        Length:2072        Min.   :   1604  
 Class :character   Class :character   Class :character   1st Qu.:   8149  
 Mode  :character   Mode  :character   Mode  :character   Median :  11912  
                                                          Mean   :  30504  
                                                          3rd Qu.:  21318  
                                                          Max.   :3210000  
                                                          NA's   :355      
    pop1987           pop2011            rankX       
 Min.   :   4003   Min.   :   7500   Min.   :   1.0  
 1st Qu.:   9194   1st Qu.:   9998   1st Qu.: 516.5  
 Median :  13118   Median :  13937   Median :1034.0  
 Mean   :  30854   Mean   :  30772   Mean   :1034.0  
 3rd Qu.:  23074   3rd Qu.:  24096   3rd Qu.:1551.5  
 Max.   :3260000   Max.   :3292365   Max.   :2069.0  
 NA's   :248       NA's   :1         NA's   :1       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> stadt)</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pop1970, <span class="sc">-</span>pop1987)</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 3
   state                  `mean(pop2011)` `sum(pop2011)`
   &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;
 1 Baden-Wrttemberg                 7580            7580
 2 Baden-Württemberg               23680.        7837917
 3 Bayern                          23996.        7558677
 4 Berlin                        3292365         3292365
 5 Brandenburg                     18472.        1865632
 6 Bremen                         325432.         650863
 7 Hamburg                       1706696         1706696
 8 Hessen                          22996.        5036121
 9 Mecklenburg-Vorpommern          27034.         811005
10 Niedersachsen                   24107.        6219515
11 Nordrhein-Westfalen             47465.       18036727
12 Rheinland-Pfalz                 25644.        1871995
13 Saarland                           NA              NA
14 Sachsen                         27788.        2973351
15 Sachsen-Anhalt                  21212.        1993915
16 Schleswig-Holstein              24157.        1739269
17 Th_ringen                       29192.        1167692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">case_when</span>(</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"Baden-Wrttemberg"</span> <span class="sc">~</span> <span class="st">"Baden-Württemberg"</span>,</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>    state <span class="sc">==</span> <span class="st">"Th_ringen"</span> <span class="sc">~</span> <span class="st">"Thüringen"</span>,</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> state</span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   state                  `mean(pop2011)` `sum(pop2011)`
   &lt;chr&gt;                            &lt;dbl&gt;          &lt;dbl&gt;
 1 Baden-Württemberg               23631.        7845497
 2 Bayern                          23996.        7558677
 3 Berlin                        3292365         3292365
 4 Brandenburg                     18472.        1865632
 5 Bremen                         325432.         650863
 6 Hamburg                       1706696         1706696
 7 Hessen                          22996.        5036121
 8 Mecklenburg-Vorpommern          27034.         811005
 9 Niedersachsen                   24107.        6219515
10 Nordrhein-Westfalen             47465.       18036727
11 Rheinland-Pfalz                 25644.        1871995
12 Saarland                           NA              NA
13 Sachsen                         27788.        2973351
14 Sachsen-Anhalt                  21212.        1993915
15 Schleswig-Holstein              24157.        1739269
16 Thüringen                       29192.        1167692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 47 × 5
   city                status  state    pop2011 rankX
   &lt;chr&gt;               &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Perl                Commune Saarland    7775  2003
 2 Freisen             Commune Saarland    8270  1894
 3 Großrosseln         Commune Saarland    8403  1868
 4 Nonnweiler          Commune Saarland    8844  1775
 5 Nalbach             Commune Saarland    9302  1678
 6 Wallerfangen        Commune Saarland    9542  1642
 7 Kirkel              Commune Saarland   10058  1541
 8 Merchweiler         Commune Saarland   10219  1515
 9 Nohfelden           Commune Saarland   10247  1511
10 Friedrichsthal      City    Saarland   10409  1489
11 Marpingen           Commune Saarland   10590  1461
12 Mandelbachtal       Commune Saarland   11107  1390
13 Kleinblittersdorf   Commune Saarland   11396  1354
14 Überherrn           Commune Saarland   11655  1317
15 Mettlach            Commune Saarland   12180  1241
16 Tholey              Commune Saarland   12385  1217
17 Saarwellingen       Commune Saarland   13348  1104
18 Quierschied         Commune Saarland   13506  1088
19 Spiesen-Elversberg  Commune Saarland   13509  1086
20 Rehlingen-Siersburg Commune Saarland   14526   996
21 Riegelsberg         Commune Saarland   14763   982
22 Ottweiler           City    Saarland   14934   969
23 Beckingen           Commune Saarland   15355   931
24 Losheim am See      Commune Saarland   15906   887
25 Schiffweiler        Commune Saarland   15993   882
26 Wadern              City    Saarland   16181   874
27 Schmelz             Commune Saarland   16435   857
28 Sulzbach/Saar       City    Saarland   16591   849
29 Illingen            Commune Saarland   16978   827
30 Schwalbach          Commune Saarland   17320   812
31 Eppelborn           Commune Saarland   17726   793
32 Wadgassen           Commune Saarland   17885   785
33 Bexbach             City    Saarland   18038   777
34 Heusweiler          Commune Saarland   18201   762
35 Püttlingen          City    Saarland   19134   718
36 Lebach              City    Saarland   19484   701
37 Dillingen/Saar      City    Saarland   20253   654
38 Blieskastel         City    Saarland   21255   601
39 St. Wendel          City    Saarland   26220   460
40 Merzig              City    Saarland   29727   392
41 Saarlouis           City    Saarland   34479   323
42 St. Ingbert         City    Saarland   36645   299
43 Völklingen          City    Saarland   38809   279
44 Homburg             City    Saarland   41502   247
45 Neunkirchen         City    Saarland   46172   206
46 Saarbrücken         City    Saarland  175853    43
47 Perl                Commune Saarland      NA    NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(city <span class="sc">==</span> <span class="st">"Perl"</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(pop2011)))</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 46 × 5
   city                status  state    pop2011 rankX
   &lt;chr&gt;               &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Perl                Commune Saarland    7775  2003
 2 Freisen             Commune Saarland    8270  1894
 3 Großrosseln         Commune Saarland    8403  1868
 4 Nonnweiler          Commune Saarland    8844  1775
 5 Nalbach             Commune Saarland    9302  1678
 6 Wallerfangen        Commune Saarland    9542  1642
 7 Kirkel              Commune Saarland   10058  1541
 8 Merchweiler         Commune Saarland   10219  1515
 9 Nohfelden           Commune Saarland   10247  1511
10 Friedrichsthal      City    Saarland   10409  1489
11 Marpingen           Commune Saarland   10590  1461
12 Mandelbachtal       Commune Saarland   11107  1390
13 Kleinblittersdorf   Commune Saarland   11396  1354
14 Überherrn           Commune Saarland   11655  1317
15 Mettlach            Commune Saarland   12180  1241
16 Tholey              Commune Saarland   12385  1217
17 Saarwellingen       Commune Saarland   13348  1104
18 Quierschied         Commune Saarland   13506  1088
19 Spiesen-Elversberg  Commune Saarland   13509  1086
20 Rehlingen-Siersburg Commune Saarland   14526   996
21 Riegelsberg         Commune Saarland   14763   982
22 Ottweiler           City    Saarland   14934   969
23 Beckingen           Commune Saarland   15355   931
24 Losheim am See      Commune Saarland   15906   887
25 Schiffweiler        Commune Saarland   15993   882
26 Wadern              City    Saarland   16181   874
27 Schmelz             Commune Saarland   16435   857
28 Sulzbach/Saar       City    Saarland   16591   849
29 Illingen            Commune Saarland   16978   827
30 Schwalbach          Commune Saarland   17320   812
31 Eppelborn           Commune Saarland   17726   793
32 Wadgassen           Commune Saarland   17885   785
33 Bexbach             City    Saarland   18038   777
34 Heusweiler          Commune Saarland   18201   762
35 Püttlingen          City    Saarland   19134   718
36 Lebach              City    Saarland   19484   701
37 Dillingen/Saar      City    Saarland   20253   654
38 Blieskastel         City    Saarland   21255   601
39 St. Wendel          City    Saarland   26220   460
40 Merzig              City    Saarland   29727   392
41 Saarlouis           City    Saarland   34479   323
42 St. Ingbert         City    Saarland   36645   299
43 Völklingen          City    Saarland   38809   279
44 Homburg             City    Saarland   41502   247
45 Neunkirchen         City    Saarland   46172   206
46 Saarbrücken         City    Saarland  175853    43</code></pre>
</div>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Saarland"</span>) <span class="sc">|&gt;</span></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(pop2011),</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(pop2011)</span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `mean(pop2011)` `sum(pop2011)`
            &lt;dbl&gt;          &lt;dbl&gt;
1          20850.         959110</code></pre>
</div>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city) <span class="sc">|&gt;</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 5
# Groups:   city [11]
   city        status                  state               pop2011 unique_count
   &lt;chr&gt;       &lt;chr&gt;                   &lt;chr&gt;                 &lt;dbl&gt;        &lt;int&gt;
 1 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 2 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 3 Bonn        City with County Rights Nordrhein-Westfalen  305765            3
 4 Brühl       Commune                 Baden-Württemberg     13805            2
 5 Brühl       City                    Nordrhein-Westfalen   43568            2
 6 Erbach      City                    Baden-Württemberg     13024            2
 7 Erbach      City                    Hessen                13245            2
 8 Fürth       City with County Rights Bayern               115613            2
 9 Fürth       Commune                 Hessen                10481            2
10 Lichtenau   City                    Nordrhein-Westfalen   10473            2
11 Lichtenau   Commune                 Sachsen                7544            2
12 Münster     Commune                 Hessen                14071            2
13 Münster     City with County Rights Nordrhein-Westfalen  289576            2
14 Neunkirchen Commune                 Nordrhein-Westfalen   13930            2
15 Neunkirchen City                    Saarland              46172            2
16 Neuried     Commune                 Baden-Württemberg      9383            2
17 Neuried     Commune                 Bayern                 8277            2
18 Petersberg  Commune                 Hessen                14766            2
19 Petersberg  Commune                 Sachsen-Anhalt        10097            2
20 Senden      City                    Bayern                21560            2
21 Senden      Commune                 Nordrhein-Westfalen   19976            2
22 Staufenberg City                    Hessen                 8114            2
23 Staufenberg Commune                 Niedersachsen          7983            2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   city, state [1]
  city  status                  state               pop2011 unique_count
  &lt;chr&gt; &lt;chr&gt;                   &lt;chr&gt;                 &lt;dbl&gt;        &lt;int&gt;
1 Bonn  City with County Rights Nordrhein-Westfalen  305765            3
2 Bonn  City with County Rights Nordrhein-Westfalen  305765            3
3 Bonn  City with County Rights Nordrhein-Westfalen  305765            3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_row =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_row <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_row)</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, state) <span class="sc">|&gt;</span></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_count <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, status, state, <span class="fu">starts_with</span>(<span class="st">"pop"</span>), unique_count) <span class="sc">|&gt;</span></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 5
# Groups:   city, state [0]
# ℹ 5 variables: city &lt;chr&gt;, status &lt;chr&gt;, state &lt;chr&gt;, pop2011 &lt;dbl&gt;,
#   unique_count &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(df, <span class="at">file =</span> <span class="st">"city_clean.RData"</span>)</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pop2011)) <span class="sc">|&gt;</span></span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>())</span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rankX, <span class="sc">-</span>status, <span class="sc">-</span>state) <span class="sc">|&gt;</span></span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  city                    pop2011  rank
  &lt;chr&gt;                     &lt;dbl&gt; &lt;int&gt;
1 Berlin                  3292365     1
2 Hamburg                 1706696     2
3 München [Munich]        1348335     3
4 Köln [Cologne]          1005775     4
5 Frankfurt am Main        667925     5
6 Düsseldorf [Dusseldorf]  586291     6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>pop2011, df<span class="sc">$</span>rank, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2948903</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> pop2011)) <span class="sc">+</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-118-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="80_exercises_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnrank =</span> <span class="fu">log</span>(rank)) <span class="sc">|&gt;</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lnpop2011 =</span> <span class="fu">log</span>(pop2011))</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, rank, lnrank, pop2011, lnpop2011) <span class="sc">|&gt;</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  city                     rank lnrank pop2011 lnpop2011
  &lt;chr&gt;                   &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Berlin                      1  0     3292365      15.0
2 Hamburg                     2  0.693 1706696      14.4
3 München [Munich]            3  1.10  1348335      14.1
4 Köln [Cologne]              4  1.39  1005775      13.8
5 Frankfurt am Main           5  1.61   667925      13.4
6 Düsseldorf [Dusseldorf]     6  1.79   586291      13.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>lnpop2011, df<span class="sc">$</span>lnrank, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"pearson"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9990053</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> lnrank, <span class="at">y =</span> lnpop2011)) <span class="sc">+</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Scatterplot with Regression Line"</span>,</span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"lnrank (Logarithmized Rank)"</span>,</span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"lnpop2011 (Logarithmized Population 2011)"</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="80_exercises_files/figure-html/unnamed-chunk-118-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="80_exercises_files/figure-html/unnamed-chunk-118-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>zipf <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnpop2011 <span class="sc">~</span> lnrank, <span class="at">data =</span> df)</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(zipf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lnpop2011 ~ lnrank, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28015 -0.01879  0.01083  0.02005  0.25973 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 14.947859   0.005141    2908   &lt;2e-16 ***
lnrank      -0.780259   0.000766   -1019   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03454 on 2067 degrees of freedom
Multiple R-squared:  0.998, Adjusted R-squared:  0.998 
F-statistic: 1.038e+06 on 1 and 2067 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prediction =</span> <span class="fu">predict</span>(zipf, <span class="at">newdata =</span> df)) <span class="sc">|&gt;</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_pop =</span> <span class="fu">exp</span>(prediction))</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(city, pop2011, pred_pop) <span class="sc">|&gt;</span></span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"Regensburg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  city       pop2011 pred_pop
  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Regensburg  135403  134194.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(pacman<span class="sc">::</span><span class="fu">p_unload</span>(tidyverse, haven, janitor, jtools))</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rmarkdown::render("24-01_dsda.Rmd", "all")</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::purl(input = "24-01_dsda.Rmd", output = "24-01_dsda_solution.R",documentation = 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;9.1: The logo of the DatasauRus package</span>
<span class="glightbox-desc lightbox-desc-23">Weight vs.&nbsp;Calories</span>
<span class="glightbox-desc lightbox-desc-26">Figure&nbsp;9.2: Ranking history: 1. FC Kaiserslautern</span>
<span class="glightbox-desc lightbox-desc-27">Figure&nbsp;9.3: Ranking history: 1. FC Köln</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Hortacsu2015Ongoing" class="csl-entry" role="listitem">
Hortaçsu, A., &amp; Syverson, C. (2015). The ongoing evolution of <span>US</span> retail: A format tug-of-war. <em>Journal of Economic Perspectives</em>, <em>29</em>(4), 89–112.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./50_graph.html" class="pagination-link" aria-label="Visualize data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Visualize data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":false,"descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>